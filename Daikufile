sub _run_build_pl {
    sh qw{rm -rf docs};
    sh qw{tools/build.pl};
}

desc 'build';
task build => sub {
    _run_build_pl;
    sh qw{hugo --minify --logLevel=info};
};

desc 'test build';
task test => sub {
    _run_build_pl;
    sh qw{hugo -F --minify --logLevel=debug};
};

desc 'deploy';
task deploy => sub {
    my $time = localtime;
    sh qw{cd docs};
    sh qw{git init};
    sh qw{git add -A};
    sh qw{git commit -m}, qq{"Deploy at $time"};
    sh qw{git remote add origin ssh://git@github.com/nqou-net/www.nqou.net.git};
    # sh qw{git push --force origin HEAD:gh-pages};
};

desc 'new post';
task new => sub {
    my $time = time;
    sh qw{hugo new}, "post/$time.md";
};

desc 'show drafts';
task drafts => sub {
    sh qw{hugo list drafts};
};

desc 'develop server';
task server => sub {
    sh qw{hugo server -D -F};
};

task default => sub { sh q{daiku -T} };
