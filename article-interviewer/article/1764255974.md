---
comments: true
description: Copilot Coding Agentを使って「ウイスキーへの再入門」の記事を作成した経験と、エージェントガイドラインの重要性について振り返ります
draft: true
hidden: false
tags:
  - ai
  - copilot
  - life
title: Copilot Coding Agentでウイスキー記事を書いた話
---

[@nqounet](https://x.com/nqounet)です。

先日、GitHub Copilot Coding Agentを使って「ウイスキーへの再入門」というブログ記事を作成しました。この経験を通じて、AIエージェントに記事を書いてもらう際のポイントや、エージェントガイドラインの重要性について気づいたことをまとめます。

## 最初の試み（PR #11）

最初に試したのは、自分のウイスキー再入門の体験をそのまま指示として渡すことでした。

指示には以下のような内容を含めました：

- 2017年10月頃にウイスキーに再入門したこと
- アメリカでビールばかり飲んでいたが、蒸留酒が体に良いと聞いたこと
- 「JACK DANIEL'S SINGLE BARREL SELECT」を$69.99で購入したこと
- ストレートで飲んでみたところ、香りの良さに驚いたこと
- Amazonへのリンクをショートコードで貼ってほしいこと

しかし、この最初の試みは失敗に終わりました。

### 差分が大きくなり過ぎた問題

PR #11で最も問題だったのは、**差分が異常に大きくなってしまった**ことです。具体的には：

- 追加行数: 59,586行
- 削除行数: 830,765行
- 変更ファイル数: 1,228ファイル

たった1つのブログ記事を追加するだけの作業で、これほど大きな差分が発生してしまいました。

### なぜこうなったのか

当時のリポジトリにはビルド出力先である`docs/`ディレクトリもコミット対象に含まれていました。エージェントがHugoビルドを実行した結果、`docs/`ディレクトリ内の全ファイルが再生成され、大量の差分が発生したと考えられます。

また、エージェントに対して「ビルドコマンドを実行しないでください」という明確な指示がなかったため、エージェントは通常の開発フローとしてビルドを実行してしまったのでしょう。

### 考察：エージェントに対する制約の明確化

この経験から、エージェントガイドラインには「やってほしいこと」だけでなく「やってはいけないこと」も明記する必要があることを学びました。特に：

- `docs/`ディレクトリは編集禁止であること
- ビルドコマンド（`hugo`、`daiku`など）は実行禁止であること
- ビルドはCI/CDが自動で行うこと

これらの制約を明確にすることで、意図しない大きな変更を防ぐことができます。

結局、このPRは中止することになりました。

## エージェントガイドラインの更新

この経験から、エージェントに対する指示やガイドラインを見直す必要があると感じました。リポジトリの`AGENTS.md`を更新し、以下のような点を明確にしました：

- 記事のfront matter形式
- 文体と表記ルール
- タグ付与の方針
- 品質チェックの項目

これらのガイドラインを整備することで、エージェントがより適切に記事を作成できるようになると考えました。

## 再挑戦（PR #13）

ガイドラインを更新した後、改めて同じ内容で記事の作成を依頼しました。今回は、ガイドラインに沿った形で記事が生成され、よりスムーズに作業が進みました。

さらに、追加の指示として画像の追加やASINの変更なども依頼しましたが、エージェントは適切に対応してくれました。

## セッションログの課題

一つ気になったのは、セッションログでの表示です。複数行にわたる指示を渡した際、改行がスペースに変換されてしまうようです。そのため、後から確認すると文節の区切りが分かりにくくなっていました。

これは、長い指示を渡す際には箇条書きや明確な区切り記号を使うなど、工夫が必要かもしれません。

## Amazonショートコードの活用

今回の記事では、Amazonの商品リンクをショートコードで挿入するように指示しました。このリポジトリでは、以下のような形式でAmazonリンクを埋め込むことができます：

```markdown
{{< amazon asin="B003UMOHT0" title="AnCnoc(アンノック) シングルモルト アンノック12年" >}}
```

エージェントはこの指示を理解し、適切なASINとタイトルでショートコードを生成してくれました。ただし、ASINについては後から確認して修正する必要がありました。

## 学んだこと

今回の経験から、AIエージェントを使った記事作成において以下のポイントが重要だと感じました：

- **明確なガイドラインの整備**: エージェントが参照できる詳細なガイドラインがあると、出力の品質が向上する
- **事実確認の重要性**: ASINなど、具体的な情報はエージェントが正確に把握できない場合があるため、人間による確認が必要
- **反復的な改善**: 最初の試みがうまくいかなくても、ガイドラインを改善して再挑戦することで良い結果が得られる

## 関連リンク

- [PR #11: 最初の試み（中止）](https://github.com/nqou-net/www.nqou.net/pull/11)
- [PR #13: ガイドライン更新後の再挑戦（マージ済み）](https://github.com/nqou-net/www.nqou.net/pull/13)

---

## 脚注

本記事はバイブ・ブロギングで作成しています。
