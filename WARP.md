# WARP.md

This file provides guidance to WARP (warp.dev) when working with code in this repository.

## 概要

- Hugo ベースの個人技術ブログ用リポジトリです。
- テーマには Hugo Modules 経由で `hugo-theme-stack` を利用しています（詳細は `README.md` 参照）。
- ソースコンテンツは `content/` 以下、ビルド成果物は `docs/`（`config/_default/config.toml` の `publishDir = "docs"`）に出力されます。
- 既定言語は日本語（`DefaultContentLanguage = "ja"`, `hasCJKLanguage = true`）。

## コミュニケーション方針

- 応答は原則として日本語で行います（コマンド名や API 名などの技術用語は英語のままで構いません）。

## よく使うコマンドと開発フロー

> **重要:** ここに記載するコマンドは「人間が実行する」想定です。Warp のエージェントは環境セットアップやビルドコマンドを勝手に実行せず、「提案」にとどめてください。

### ローカルプレビュー（ドラフト含む）

- ドラフトを含めてプレビューする:
  - `hugo server -D`
  - （必要に応じて未来日付も含めたい場合は `-F` を追加）
- 用途: レイアウト、ショートコード、画像、ナビゲーションなどの見た目を確認します。

### 本番ビルド

- 本番相当の静的サイトを `docs/` に出力する:
  - `hugo --minify`
- 用途: 公開前確認、および CI / GitHub Pages でのデプロイと同等の成果物を生成します。

### テーマ / モジュールのメンテナンス

- Stack テーマモジュールを手動アップデートする（人間実行）:
  - `hugo mod get -u github.com/CaiJimmy/hugo-theme-stack/v3`
  - `hugo mod tidy`

### テスト / 検証

- このリポジトリには自動化されたユニットテストはありません。
- 検証フロー:
  - `hugo --minify` を実行してビルドが成功することを確認。
  - 生成された HTML（`docs/`）を目視でチェック。
  - 必要に応じて外部ツールでリンク切れチェック（例: linkinator など）を人間が実行。

## Warp エージェント向けの制約

- 環境セットアップやシステムレベルのインストール（例: `brew install ...`）を自動実行しないこと。必要な場合はコマンド例を提示し、人間に実行してもらいます。
- ビルド系コマンド（`hugo server -D`, `hugo --minify` など）も、基本的には「実行を提案する」にとどめます。ユーザーから明示的に依頼された場合のみ実行を検討してください。
- `docs/` は Hugo による生成物ディレクトリです。**直接編集せず**、必ず `content/`, `layouts/`, `static/` などのソースを変更し、ビルドによって反映させます。
- リモートリポジトリへの push、PR のマージ、CI のトリガーは行わず、あくまで変更案やコマンド例を提示する役割に徹します。

## 高レベルなアーキテクチャ

### Hugo 設定

- メイン設定ファイル: `config/_default/config.toml`
  - `baseurl`, `title`, `publishDir`, 言語設定、CJK 設定、Disqus などを定義。
  - `publishDir = "docs"` により、ビルド成果物はリポジトリ直下の `docs/` に出力されます。
- 追加のテーマ設定やパラメータは `config/` 以下に整理されます（Hugo の一般的な構成）。

### コンテンツ構成

- 投稿記事: `content/post/`
  - 新規記事はこのディレクトリ直下に Markdown ファイルとして追加します。
  - ファイル名はスラッグのみ（例: `how-to-hugo.md`）とし、公開時の URL スラッグと一致させる運用です。
  - `content/post/_template.md` が推奨のテンプレートになっており、フロントマターと基本構造のサンプルを含みます。
- 固定ページ: `content/page/`
  - `about/`, `archives/`, `links/`, `search/`, `advent-calendar-2025/` など、サイト全体で使う固定ページのコンテンツが含まれます。
- トップページ: `content/_index.md`
  - サイトのトップレベルのコンテンツやメタ情報を定義します。

### フロントマターとライティング規約

投稿・ページ共通のルール（特に `content/post/`）:

- フロントマターは **YAML**（`---`）で記述します。TOML（`+++`）は使用しません。
- よく使う / 必須のキー:
  - `title`: 記事タイトル。
  - `draft`: 下書き中は必ず `true`。公開時にのみ `false` に変更します。
  - `tags`: 文字列の配列。
    - タグは **英語小文字**、複合語はハイフン区切り（例: `object-oriented`）。
  - `description`: 日本語での短い説明（2 行程度）で、SEO や一覧表示用の要約として使います。
- フロントマターに `date` や `iso8601` は含めません。
- 見出しレベル:
  - H1 はフロントマターの `title` から自動的に決まる前提です。
  - 本文中のトップレベルセクションは `##` から始める ATX スタイルに統一します。
- 外部リンク:
  - 独立した外部参照リンクには `linkcard` ショートコードを優先して使います。
    - 例: `{{< linkcard "https://example.com" >}}`

### レイアウト / テーマカスタマイズ

- ベーステーマは外部モジュール (`hugo-theme-stack`) から読み込まれます。
- テーマのカスタマイズやオーバーライドは、一般的に以下のディレクトリで行います:
  - `layouts/`
  - `partials/`
  - `shortcodes/`
- 可能な限り既存のショートコードやパーシャルを再利用し、生の HTML 埋め込みは最小限に抑えます。

## 記事作成ワークフロー（マルチエージェント連携の概要）

- `.github/agents/` と `AGENTS.md` に、記事作成のための複数エージェントと詳細なフローが定義されています。
- Warp のエージェントが記事作成を支援する場合は、概ね次の流れに沿うとリポジトリの運用方針と整合します:
  1. アイデア出し（テーマ候補・ターゲット読者・見出し案の生成）
  2. 調査・情報収集（引用元や重要ポイントの整理）
  3. 下書き生成（`content/post/` に YAML フロントマター付き Markdown を作成）
  4. レイアウト / スタイル整形（見出し階層、タグ形式、ショートコード利用の統一）
  5. 校正（日本語表現・用語統一・参照整合性）
  6. SEO 調整（`description` や公開タグの見直し）
  7. 公開前レビュー（人間が `hugo server -D` で最終確認）
- エージェントは常に「完全な Markdown ファイル」または「差分（パッチ）」という形で提案を行い、最終決定とコマンド実行は人間に委ねてください。

この WARP.md は、このリポジトリ特有の構造と運用ルールだけに焦点を当てています。一般的な開発ベストプラクティスやツールの使い方はここでは繰り返さないようにしてください。