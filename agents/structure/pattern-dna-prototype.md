# パターンDNA解析: Prototype パターン

> 作成日: 2026-02-03
> シリーズ: コードドクター
> 形式: 統合版

---

## 問診票（症状リスト）

| # | 症状 | 説明 | 重症度 |
|---|------|------|--------|
| 1 | オブジェクト複製困難症 | 複雑なオブジェクトを新規作成するたびにコンストラクタを呼び出し、初期化処理が重複 | 中症 |
| 2 | 生成コスト過多症 | DBクエリや設定ファイル読み込みを毎回行う初期化処理が重く、パフォーマンスが低下 | 重症 |
| 3 | 深いコピー欠如症 | 浅いコピーで参照が共有され、変更が意図しない箇所に波及する | 中症 |

---

## 処方候補

| 順序 | パターン名 | 適応症状 |
|------|-----------|---------| 
| 1 | Prototype | オブジェクト複製困難症、生成コスト過多症、深いコピー欠如症 |

---

## DNA解析マップ

### パターン: Prototype

- **適応症状**: オブジェクト複製困難症、生成コスト過多症、深いコピー欠如症
- **禁忌**: 単純なオブジェクト（フィールドが2-3個程度）の生成（過剰設計になる）
- **副作用**: 循環参照がある場合の深いコピー実装の複雑化

---

## 治療設定

- 出力形式: 統合版
- 全体回数: 1回（統合版）
- 公開予定日: 2026-02-14

---

## 患者プロファイル

- スキルレベル: 初級〜中級
- 性別: 女性
- 背景: ゲーム開発者（敵キャラクター生成システム担当）
- 悩み: ゲーム開始時に敵キャラクターを大量生成すると読み込みが長い。毎回設定ファイルを読み込んで敵を生成している。

---

## 提案（3案）

### 案A: ゲームエネミー量産システム ⭐推奨

**テーマ**: RPG敵キャラクター生成システム

**ストーリー設定**:
- 患者: 女性ゲーム開発者（ペルソナB: どうしようもなく疲れ切っている）
- 症状: 敵キャラクター（スライム、ゴブリン、ドラゴンなど）を生成するたびにDBから設定を読み込み、ゲーム開始時のロード時間が30秒を超える
- 生成対象: 敵の名前、HP、攻撃力、防御力、スキルリスト、ドロップアイテム、外見設定

**治療計画**:

| 章 | 内容 | 処方 |
|----|------|------|
| 1. 緊急搬送 | 「ゲームのロード遅い」の苦情。敵生成コードを見て「重症」 | - |
| 2. 問診 | なぜ毎回DBを読むのか。プロトタイプという概念を説明 | - |
| 3. 第一手術 | clone メソッドの導入（浅いコピー） | Prototype 基本 |
| 4. 第二手術 | deep_clone の実装（ネストした配列・ハッシュ対応） | 深いコピー |
| 5. 経過観察 | Before/After 比較、ロード時間の改善 | - |
| 6. 退院 | 注意事項（循環参照、プロトタイプ管理）と次回予告 | - |

**USP**: 「一度作った敵を複製して、大軍を瞬時に生成」

**想定される質問**:
- Q: 浅いコピーと深いコピー、どちらを使うべき？
- A: オブジェクトが配列やハッシュのネストを含む場合は深いコピー

**推奨タグ**: `code-doctor`, `design-patterns`, `prototype-pattern`, `perl`, `game-development`

**meta description**: 
ゲーム開始が遅い！敵生成のたびにDB読み込み？コードドクターがPrototypeパターンで手術。一度作った敵を複製して大軍を瞬時に。

---

### 案B: ドキュメントテンプレートシステム

**テーマ**: 社内文書生成

**ストーリー設定**:
- 患者: 社内ツール開発者（女性）
- 症状: 定型文書（見積書、請求書、報告書）を生成するたびに基本設定を繰り返し設定
- 生成対象: 書類タイトル、会社情報、レイアウト設定、フォント設定

**治療計画**:

| 章 | 内容 | 処方 |
|----|------|------|
| 1. 緊急搬送 | 「同じ設定を何度も書いている」 | - |
| 2. 手術 | テンプレートオブジェクトを複製して個別情報のみ上書き | Prototype |
| 3. 退院 | Before/After | - |

**USP**: 「テンプレートを複製して必要な部分だけ変更」

---

### 案C: テスト用モックデータ生成

**テーマ**: テスト自動化

**ストーリー設定**:
- 患者: QAエンジニア（女性）
- 症状: テスト用のモックオブジェクトを毎回一から作成、設定が煩雑
- 生成対象: ユーザーオブジェクト（名前、年齢、住所、購入履歴など）

**治療計画**:

| 章 | 内容 | 処方 |
|----|------|------|
| 1. 緊急搬送 | 「テストデータ作成が面倒」 | - |
| 2. 手術 | 基本モックを複製して必要なプロパティのみ変更 | Prototype |
| 3. 退院 | Before/After | - |

**USP**: 「テスト用テンプレートを複製して効率化」

---

## 推奨案

**案A（ゲームエネミー量産システム）** を推奨。

理由:
1. ゲーム開発は読者に馴染みやすいテーマ
2. 敵キャラクター（スライム、ゴブリン、ドラゴン）は直感的にイメージしやすい
3. 浅いコピー→深いコピーへの段階的解説が自然
4. 「クローン軍団」というビジュアルがPrototypeパターンの本質を表現
5. コードドクターの「手術」メタファーと相性が良い

---

## Before/After メトリクス（案A）

| 指標 | Before | After | 改善率 |
|------|--------|-------|--------|
| DB読み込み回数/100体 | 100回 | 3回（プロトタイプのみ） | 97% |
| 生成時間/100体 | 30秒 | 0.5秒 | 98% |
| コード行数（生成部分） | 50行 | 15行 | 70% |
| 変更箇所（新敵追加時） | 生成箇所全て | プロトタイプ定義のみ | ↑ |

---

## 選定結果

- **採用案**: 案A（ゲームエネミー量産システム）
- **選定日**: 2026-02-03
- **選定理由**: ユーザー承認（推奨テーマで実施）
- **患者設定**: 女性（ユーザー指定）
- **成果物**: [記事](/2026/02/14/005714/)
