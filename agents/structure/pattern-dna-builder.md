# パターンDNA解析: Builder パターン

> 作成日: 2026-02-03
> シリーズ: コードドクター
> 形式: 統合版

---

## 問診票（症状リスト）

| # | 症状 | 説明 | 重症度 |
|---|------|------|--------|
| 1 | コンストラクタ引数爆発症 | 引数が10個以上あり、どれが必須でどれがオプションか分からない | 重症 |
| 2 | テレスコーピング症候群 | 引数の順序を覚えられない、省略パターンのバリエーションが増殖 | 中症 |
| 3 | 不完全オブジェクト生成症 | 必須フィールドの設定忘れにより、中途半端な状態のオブジェクトが生成される | 中症 |

---

## 処方候補

| 順序 | パターン名 | 適応症状 |
|------|-----------|---------|
| 1 | Builder | コンストラクタ引数爆発症、テレスコーピング症候群、不完全オブジェクト生成症 |

---

## DNA解析マップ

### パターン: Builder

- **適応症状**: コンストラクタ引数爆発症、テレスコーピング症候群、不完全オブジェクト生成症
- **禁忌**: 引数が2-3個程度の単純なケース（過剰設計になる）
- **副作用**: クラス数の増加、コード量の増加

---

## 治療設定

- 出力形式: 統合版
- 全体回数: 1回（統合版）
- 公開予定日: 2026-02-13

---

## 患者プロファイル

- スキルレベル: 初級〜中級
- 背景: ゲーム開発者（キャラクター生成システム担当）
- 悩み: 装備・ステータス・スキルを持つキャラクターの生成コードが複雑化

---

## 提案（3案）

### 案A: ゲームキャラクター生成ビルダー ⭐推奨

**テーマ**: RPGキャラクター生成システム

**ストーリー設定**:
- 患者: ゲーム開発者（ペルソナB: 疲れ切っている）
- 症状: キャラクター生成のコンストラクタが15引数に膨れ上がった
- 生成対象: 名前、クラス、レベル、HP、MP、攻撃力、防御力、装備（武器・防具・アクセサリ）、スキル、称号

**治療計画**:

| 章 | 内容 | 処方 |
|----|------|------|
| 1. 緊急搬送 | 15引数のキャラクター生成コードを見て「重症」 | - |
| 2. 問診 | どの引数が必須か、オプションかを整理 | - |
| 3. 第一手術 | Builder クラスの導入、メソッドチェーン | Builder 基本 |
| 4. 第二手術 | Director パターンの導入（定番キャラ生成） | Director |
| 5. 経過観察 | Before/After 比較、メトリクス提示 | - |
| 6. 退院 | 注意事項（過剰設計の回避）と次回予告 | - |

**USP**: 「キャラクター生成を流れるようなAPIで」

**想定される質問**:
- Q: 引数が少ない場合も使うべき？
- A: 3個以下なら経過観察（コンストラクタのまま）で十分

**推奨タグ**: `code-doctor`, `design-patterns`, `builder-pattern`, `perl`, `game-development`

**meta description**: 
引数が爆発したキャラ生成コード。コードドクターがBuilder パターンで手術します。流れるようなAPIでキャラクター生成を。

---

### 案B: HTTPリクエストビルダー

**テーマ**: Webクライアント開発

**ストーリー設定**:
- 患者: Web開発者
- 症状: HTTPリクエスト生成のためのハッシュが巨大化
- 生成対象: URL、メソッド、ヘッダー（複数）、クエリパラメータ、ボディ、タイムアウト、リトライ設定

**治療計画**:

| 章 | 内容 | 処方 |
|----|------|------|
| 1. 緊急搬送 | 巨大なハッシュリテラルを見て「重症」 | - |
| 2. 問診 | 必須（URL、メソッド）とオプションの整理 | - |
| 3. 手術 | RequestBuilder の導入 | Builder |
| 4. 退院 | Before/After 比較 | - |

**USP**: 「HTTPリクエストを読みやすく組み立てる」

---

### 案C: レポート生成ビルダー

**テーマ**: ドキュメント生成システム

**ストーリー設定**:
- 患者: 社内ツール開発者
- 症状: PDFレポート生成の設定が複雑
- 生成対象: タイトル、著者、日付、ヘッダー、フッター、セクション、表、グラフ

**治療計画**:
| 章 | 内容 | 処方 |
|----|------|------|
| 1. 緊急搬送 | 設定ハッシュが30行を超えている | - |
| 2. 手術 | ReportBuilder の導入 | Builder |
| 3. 退院 | Before/After | - |

**USP**: 「レポート設定を段階的に構築」

---

## 推奨案

**案A（ゲームキャラクター生成ビルダー）** を推奨。

理由:
1. ゲーム開発は読者に馴染みやすいテーマ
2. キャラクターの属性（装備・ステータス・スキル）は Builder の典型例
3. Director パターンまで含めて解説できる深さがある
4. コードドクターの「手術」メタファーと相性が良い

---

## Before/After メトリクス（案A）

| 指標 | Before | After | 改善率 |
|------|--------|-------|--------|
| コンストラクタ引数 | 15個 | 0個（Builderメソッド経由） | 100% |
| コード行数（生成部分） | 20行 | 8行 | 60% |
| 可読性（引数の意味） | 不明 | 明示的 | ↑ |
| 拡張性（新属性追加） | 全箇所修正 | メソッド追加のみ | ↑ |
