# Patient Profile: Chain of Responsibility

## 患者情報

- **Name**: 黒崎 鉄男（くろさき てつお）
- **Age**: 42歳
- **Role**: インフラエンジニア / SRE（エンジニア歴18年）
- **Personality**: 豪快で自信家。「動くコードが正義」が信条。技術的な議論では声が大きくなる。面倒見は良いが、後輩に対してもタメ口。ただし、わかりやすく教えてくれる人には素直に感心する。照れ隠しに乱暴な言葉遣いをする不器用さも。
- **First Person**: 「俺」
- **Background**: 新卒からLinuxサーバー管理一筋。自社の監視基盤をPerlで構築し「黒崎のスクリプト」として社内では伝説化。しかし、チームが拡大しアラート種別が増え続けた結果、自慢のスクリプトが制御不能に。本人は「Perlの問題じゃなくて、条件が複雑なんだ」と主張。GoFパターンは名前すら知らない。
- **Chief Complaint**: 「最近、俺のスクリプトが俺の言うことを聞かなくなった。新しいアラート種別を足すと、なぜか別のアラートが暴発する。18年書いてきて、こんなのは初めてだ」
- **Comedy Potential**:
  - `bless`は使うが「これがOOPだ」と思っている。「クラス？ ハッシュに名前つけたやつだろ？」
  - ドクターの短い発言に「お前、俺の後輩か？」と対抗
  - ナナコの丁寧な解説に「嬢ちゃん、わかりやすいな。うちのチームに欲しいよ」と素直に感心
  - コードを直されると最初はムッとするが、テスト結果を見て黙り込む

---

## Medical Chart（診断カルテ）

### 主訴

> 「俺のスクリプトが俺の言うことを聞かなくなった」

### 症状（Symptoms）

| Technical | Medical Metaphor |
|-----------|-----------------|
| アラート判定ロジックが1つのサブルーチンに`if-elsif`で35分岐以上集約 | 主動脈（メイン処理フロー）に35箇所の血栓（条件分岐）が密集 |
| 新しいアラート種別を追加すると、既存の分岐の副作用で別のアラートが誤発火 | 1つの血栓を除去すると、隣接する血栓が連鎖的に破裂（多段塞栓反応） |
| 処理の順序がハードコードされ、優先度変更に全体改修が必要 | 血管の硬化により、バイパス手術（ルート変更）が不可能な状態 |
| テストが存在せず、変更の安全性を確認する手段がない | 画像診断装置（テスト）がなく、内部の状態が把握できない |

### 病名（Diagnosis）

**多段塞栓症候群**（Multi-Stage Thromboembolism Syndrome）

処理フローの主要血管に条件分岐の血栓が多段的に詰まり、新しい血栓が形成されるたびに既存の血栓が連鎖的に不安定化する症候群。放置すると致死的（本番障害）。

### 処方（Prescription）

**Chain of Responsibility パターンによる血管分離手術**

1. **血栓分離**: 各条件分岐をそれぞれ独立したハンドラ（血管セグメント）に切り出す
2. **連鎖形成**: ハンドラ同士を次のハンドラへの参照で連結（バイパスルートの構築）
3. **フロー制御**: 各ハンドラが「自分が処理するか、次に回すか」を自律判断
4. **拡張点確保**: 新しいアラート種別は新しいハンドラの追加のみで対応可能に

### 来院 / 往診

**往診**（患者のオフィスにて）— 同僚からの紹介で渋々依頼。本人は「コードに問題はない、複雑さの問題だ」と主張しつつも、夜間のアラート誤発火で睡眠不足が限界に。

---

## タイトル案

```
コードドクター【Chain of Responsibility】多段塞栓症候群〜暴走アラートの連鎖分離術〜
```
