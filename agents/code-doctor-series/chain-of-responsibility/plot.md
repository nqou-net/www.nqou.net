# Plot Outline: Chain of Responsibility

> **設定**: 往診（患者のオフィス＝サーバールーム隣の運用チームデスク）
> **時間帯**: 平日深夜。夜間アラートの誤発火で呼ばれた同僚がドクターを紹介

---

## I. 往診（Admission）

### ありきたりな展開の排除
- ❌ 患者が素直に助けを求める → 黒崎は自信家なので非現実的
- ❌ ドクターが厳しく指摘して始まる → 序盤からの対立は単調

### 採用展開: 「勝手に来やがった」

黒崎のオフィスでアラートが鳴り響く深夜。黒崎はいつものように端末に向かってif-elsifを追加している。背後のドアが開き、ドクターとナナコが現れる。

黒崎は振り向きもせずに「今忙しいんだ、明日にしてくれ」。ナナコが丁寧に「往診に参りました」と自己紹介するが、黒崎は「医者？ サーバーは元気だぞ。俺のスクリプトがちょっと反抗期なだけだ」。

ドクターは黒崎のモニターを一瞥し、黒崎の端末に映る巨大なif-elsif連鎖を見て——**何も言わずに、黒崎の椅子の隣にもう1つの椅子を無言で引き寄せて座る**。黒崎は「おい、勝手に……」と抗議するが、ドクターはすでにコードを読んでいる。

ナナコが黒崎ににっこり微笑み、「すみません、先生はこういう方なんです。お邪魔しますね」。

**黒崎の心情（一人称ナレーション）**: 同僚の紹介だから追い出すわけにもいかない。だが、自分のコードを他人に見られることへの居心地の悪さが勝る。「言っとくが、俺のスクリプトは18年動いてるんだ」。

---

## II. 触診（Examination）

### ありきたりな展開の排除
- ❌ ドクターがすぐに問題点を指摘する → 黒崎の反応がただの防御になる
- ❌ 技術的な説明から入る → 退屈

### 採用展開: 「褒めてから斬る」

ドクターがコードをスクロールしながら、予想外の一言。「18年……よく保った。」

黒崎が一瞬驚く。褒められると思っていなかった。「だろ？ 俺のスクリプトは——」

ドクターが遮る。「**だが、もう限界だ。**」

ドクターが画面の特定の箇所を指差す。「ここ。」黒崎が見ると、if-elsifの35分岐目。

ナナコが横から補足。「黒崎さん、先生は……このコードの血管が詰まっていますと言いたいんです。血栓が35箇所もあって、新しい血栓が1つ増えるたびに、隣の血栓が破裂するリスクがあるんですよ。」

黒崎: 「血栓？ これは条件分岐だ。ロジックだ。」

ナナコ: 「ええ、ロジックです。でも、黒崎さん自身がおっしゃっていましたよね。『新しい種別を足すと別のアラートが暴発する』って。それが連鎖的な塞栓反応なんです。」

黒崎が黙る。図星だから。

ドクター: 「**多段塞栓症候群。**」

黒崎: 「……随分と大げさな名前だな。」

---

## III. 外科手術（Surgery）

### ありきたりな展開の排除
- ❌ すぐにChain of Responsibilityの説明に入る → 教科書的すぎる
- ❌ 黒崎が素直に学ぶ姿勢を見せる → キャラブレ

### 採用展開: 「知ってるつもりの壁」

ドクターが黒崎のキーボードに手を伸ばす。黒崎は「おい、俺の端末だぞ」と牽制するが、ドクターは気にしない。

ドクターが新しいファイルを開き、最初の数行を書く。`package AlertHandler;` そして `use v5.36;`。

黒崎: 「パッケージなんか切らなくても——」

ドクター: 「**責任の連鎖。**」

ナナコ: 「先生が作ろうとしているのは、Chain of Responsibility というパターンです。黒崎さん、工場の組み立てラインって見たことありますか？」

黒崎: 「……ベルトコンベアのやつか。」

ナナコ: 「そうです。各ステーションには担当者がいて、自分の作業が必要なら処理する。必要なければ、そのまま次のステーションに流す。今の黒崎さんのコードは、一人の担当者が全工程を見ている状態なんです。」

黒崎: 「……それが35分岐になった理由か。」

ドクターが黙々とコードを書いていく。**Before（巨大if-elsif）からAfter（ハンドラチェーン）への変換をリアルタイムで見せる。**

まず基底クラスの`AlertHandler`を作り、`handle`メソッドと`set_next`メソッドを定義。次に`CriticalAlertHandler`、`WarningAlertHandler`、`InfoAlertHandler`を具体クラスとして実装。

黒崎が画面を食い入るように見つめる。各ハンドラが短く、自分の責務だけに集中しているのが視覚的にわかる。

黒崎: 「……短いな。1つのハンドラが。」

ドクター: 「**各自の責務。**」

ナナコ: 「そうなんです。新しいアラート種別を追加したい時は、新しいハンドラを1つ書いて、チェーンに繋ぐだけです。他のハンドラには一切触りません。」

黒崎（ナレーション）: 俺は18年間、一人で全部見ようとしていたのか。工場で例えるなら、品質管理も検品も梱包も発送も、全部一人でやっていた状態だ。そりゃ、ラインが詰まるわけだ。

### 勘違いシーン配置

ドクターがコードを書き終えた後、黒崎のデスクに置いてあった缶コーヒー（黒崎が飲んでいたもの）を無意識に手に取り、一口飲む。他人の飲み物だと気づいていない。

黒崎が固まる。「……お前、俺のコーヒー飲んだだろ。」

ドクターが見下ろす。缶を見て、少し間があって——そのまま黒崎に返す。

ナナコ: 「あっ……すみません、先生は集中すると周りが見えなくなるんです。」

黒崎（ナレーション）: ……いや、謝るのはこいつだろ。だが、なんというか——缶コーヒーを分け合う間柄になった気がして、妙な連帯感が芽生えていた。絶対に違うんだろうが。

---

## IV. 術後経過（Prognosis）

### ありきたりな展開の排除
- ❌ テストが通って「やった！」で終わる → あっさりしすぎる
- ❌ 黒崎が急にデザインパターンに目覚める → キャラブレ

### 採用展開: 「認めたくないが……」

ドクターが書いたテストを実行する。全パス。

黒崎はモニターを凝視する。新しいアラート種別を1つ追加してみる——ハンドラを1つ書き、チェーンに繋ぐだけ。他のテストは一切壊れない。

黒崎: 「……。」（長い沈黙）

黒崎: 「……言っておくがな。俺のやり方が間違っていたんじゃない。18年前は、これで十分だったんだ。」

ナナコ: 「ええ、その通りです。18年間ちゃんと動いていたんですから。ただ、患者さん……じゃなくて、スクリプトが成長して、血管が追いつかなくなっただけなんですよ。」

黒崎がふっと鼻で笑う。「嬢ちゃんは患者扱いするんだな、俺を。」

ナナコ: 「あら、もう退院ですよ？」

ドクターが立ち上がり、鞄を整える。帰り支度。

黒崎: 「おい。」

ドクターが振り返る。

黒崎: 「……ありがとよ、は言わねえぞ。だが、お前のコード……悔しいが、俺のより読みやすい。」

ドクター: 「**感謝は、このコードに。**」

黒崎（ナレーション）: あいつが帰った後、俺は一人で端末に向き合った。チェーンの構造を眺める。18年間、俺が育てたスクリプトは確かに生きていた。だが、成長痛を抱えていた。俺はそれを「反抗期」だと思っていたが——あいつは「血管が詰まっている」と見抜いた。悔しいが、的確だ。

俺はキーボードに手を置く。次のアラート種別、何から書こうか。今度は——一人の担当者じゃなく、チームで。

---

## 舞台設定の整合性チェック

### 往診（患者のオフィス）

- [x] ドクターと助手が「来て」「帰る」側 → ✅ ドクターが帰り支度をするシーンあり
- [x] 患者は自分の場所に居る側 → ✅ 黒崎はデスクに座ったまま
- [x] クリニック固有の小物は使用していない → ✅ 缶コーヒーは黒崎のデスクの物
- [x] 退場シーンの主語 → ✅ ドクターが立ち上がり鞄を整える
- [x] 退場後の描写 → ✅ 「あいつが帰った後」と患者視点で記述
