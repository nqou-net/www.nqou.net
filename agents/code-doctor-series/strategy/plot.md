# Plot Outline

## Scene 1: The Emergency (Admission)
- **Situation**: 木曜日の深夜26時。継足タロウは、Slackで飛んできた「明日朝開始のキャンペーン：『雨の日かつシルバー会員なら5%OFF、ただし食品は除く』を追加して」という無慈悲な仕様変更に絶望している。
- **Action**: `calculate_total`メソッドは既に2000行を超え、ネストは危険水域（深度8）に達している。「もう無理だ…」とディスプレイに突っ伏した瞬間、冷たい風を感じて顔を上げる。
- **Encounter**: いつの間にか背後に白衣の男（ドクター）と助手のエディタが立っている。ドクターはタロウのキーボードをピンセットで摘み上げ、アルコール綿で拭いている。「汚染区域（バイオハザード）だな。キーボードが脂ぎっている」

## Scene 2: The Diagnosis (Examination)
- **Examination**: ドクターは画面上のコード（スパゲッティ状態の`switch`文）をメス（ポインタ）でなぞる。「血管（ロジック）が完全に詰まっている。分岐の石灰化が進み、いつ破裂してもおかしくない」
- **Translation**: 助手「『条件分岐が複雑すぎて、どこを触ってもバグが出る状態です』とおっしゃっています」
- **Patient's Defense**: タロウ「で、でも、既存のロジックを壊さないために、一番安全な『末尾にif文追加』で対応してきたんです！ 安全第一で！」
- **Rebuttal**: ドクターは哀れむような目でタロウを見る。「安全？ 君は手足が壊死していくのを『絆創膏』で止めているだけだ。今すぐ切除（オペ）が必要だ」

## Scene 3: The Surgery (Treatment)
- **Preparation**: ドクターは手袋をはめ直し、`Strategy` パターンという名のメスを取り出す。「コンテキスト（文脈）とアルゴリズム（計算）を分離する。癒着を剥がすぞ」
- **Procedure**:
    1.  **切開**: 巨大な `calculate_total` メソッド内の分岐ロジックを全て取り出す。
    2.  **移植**: `DiscountStrategy` インターフェースを定義し、個々の割引ルール（`MemberDiscount`, `SeasonalDiscount`）を独立したクラス（臓器）として再構築。
    3.  **縫合**: 呼び出し元（Context）には `set_strategy` メソッドひとつだけを残す。
- **Catharsis**: 2000行あったコードが、わずか数行の委譲コードに変化する。
    ```perl
    # Before
    if ($type eq 'A') { ... } elsif ...
    
    # After
    $self->strategy->calculate($price);
    ```
- **Reaction**: タロウ「消えた…？ 僕の苦労の結晶（スパゲッティ）が、こんなにあっけなく…！」

## Scene 4: The Prognosis (Misunderstanding)
- **Post-Op**: ドクターは満足げにうなずき、タロウの肩を叩く（実際は肩についた抜け毛を払っただけ）。
- **Doctor's Words**: 「いいか、流れを止めるな。淀むと腐る。常に循環させろ」
- **Misunderstanding**: タロウはドクターの手の温もり（錯覚）と深い言葉に感動する。「（僕の人生も仕事に忙殺されて淀んでいた…ドクターはそれを案じて…！）はいっ！ 僕、もっと身軽に生きてみます！ 転職も考えます！」
- **Assistant**: （単純にオブジェクト間のデータフローの話をしているだけなんですが…）と心の中でツッコミつつ、無言で荷物をまとめる。
- **Conclusion**: タロウは晴れやかな顔でディスプレイに向かう。新しいクラスファイルを作成する指取りは軽い。
