# Input Design: Proxy

## 選定結果

| 要素 | 採用案 | スコア |
|------|--------|--------|
| テーマ | データベースクエリの遅延実行とキャッシュ（王道） | 21/25 |
| 患者 | 「速さは正義」の突撃エンジニア（革新） | 20/25 |
| 症状 | API直叩き依存症候群（複合症状）（革新） | 21/25 |
| **総合スコア** | | **62/75** |

## テーマ詳細

### 案A（王道）: データベースクエリの遅延実行とキャッシュ ✅ 採用

- **テーマ名**: 社内ダッシュボードのDB負荷爆発
- **一行説明**: 毎回DBに直接問い合わせるダッシュボードが、利用者増加でDBサーバを瀕死にさせる
- **パターンとの接点**: Caching Proxy でDBアクセスを制御し、同一クエリの結果をキャッシュ。Virtual Proxy で画面表示時まで重いクエリを遅延実行
- **読者像**: Webアプリ開発者、バックエンド担当。DBの負荷問題に日常的に悩む層

### 案B（革新）: IoTセンサーデータの代理収集

- **テーマ名**: 農業IoTのセンサーゲートウェイ
- **一行説明**: 100台の温湿度センサーの生データを毎秒ポーリングしてメモリが枯渇する
- **パターンとの接点**: Remote Proxy で物理センサーへのアクセスを抽象化し、データの集約・間引きを代理層で行う
- **読者像**: IoTや組み込み系に興味がある開発者

### 案C（逆転）: 社長のExcelマクロの代理防衛

- **テーマ名**: 社長が毎朝手動実行するExcelマクロの自動化防衛システム
- **一行説明**: 社長が「このマクロは俺にしか実行できない」と言い張るExcelの処理を、実は裏でProxyが自動実行していた
- **パターンとの接点**: Protection Proxy でアクセス権を制御しつつ、Virtual Proxy で社長不在時に自動実行
- **読者像**: レガシーシステムと政治的問題に苦しむ開発者

## 患者詳細

### 案A（王道）: 真面目すぎる新卒2年目

- **属性**: 24歳、Webアプリ開発者、エンジニア歴1.5年
- **性格キーワード**: 真面目、完璧主義、報連相が過剰
- **背景**: 「公式ドキュメントに書いてある通りに」DBに毎回アクセスするコードを書いた
- **主訴**: 「テストでは問題なかったんですが、本番でなぜか遅いんです…」
- **コメディポテンシャル**: ドクターの寡黙さに対して報連相を過剰にしようとする

### 案B（革新）: 「速さは正義」の突撃エンジニア ✅ 採用

- **属性**: 29歳、バックエンド開発者、エンジニア歴6年
- **性格キーワード**: 即断即決、せっかち、YAGNI原理主義
- **背景**: 「ORMなんてオーバーヘッド！SQL直書きが最速！」と豪語し、あらゆるDB呼び出しを直接実行するコードを量産。パフォーマンスにこだわるくせに、同じクエリの重複実行には無頓着
- **主訴**: 「俺のコード、1クエリ単位では最速なはずなのに、全体が遅い。意味わかんねえ」
- **コメディポテンシャル**: 「マイクロ秒単位で最適化」にこだわるがマクロな問題に気づかない矛盾。ドクターの「遅い。」の一言にブチ切れそうになる

### 案C（逆転）: 元料理人のIT転職組

- **属性**: 35歳、自社サービス開発者、エンジニア歴2年
- **性格キーワード**: 度胸がある、手順無視、感覚派
- **背景**: 元料理人。「レシピ（設計書）なんて飾り」精神でコードを書く
- **主訴**: 「動いてるんですけどね、なんか時々固まるんですよ」
- **コメディポテンシャル**: 料理用語でコードを説明する（「ここをこう炒めて…」）

## 症状詳細

### 案A（王道）: 直接アクセス肥大症

- **技術的症状**: `$dbh->do("SELECT ...")` がコード全体に散乱。同一データを10箇所以上から別々にフェッチ。関数をまたぐたびに同じクエリが発行される
- **医療メタファー**: 「多臓器直結症候群」— すべての臓器が心臓に直接パイプで繋がった状態
- **重症度**: 中症
- **Before/Afterの見込み**: Before: DB直叩き → After: Proxy経由でキャッシュ＆遅延
- **読者の「あっ」ポイント**: 「俺もDBの結果、同じの何回も取ってるかも…」

### 案B（革新）: API直叩き依存症候群 ✅ 採用

- **技術的症状**: 外部API・DBの呼び出しが関数内にハードコードされ、テスト不能。同じレスポンスを複数箇所で取得。エラーハンドリングが呼び出し元ごとに重複。レートリミットを考慮せず全部直叩き
- **医療メタファー**: 「代謝バイパス欠損症」— 栄養を直接血管に注入しているため、消化器官（中間層）が退化した状態。何かを摂取するたびに体中が過剰反応する
- **重症度**: 重症
- **Before/Afterの見込み**: Before: API/DB直叩きがコード全体に散乱、テスト不能 → After: Proxy層で呼び出しを一元管理、キャッシュ・リトライ・ログを代理層に集約、テスト時はモックProxyに差し替え可能
- **読者の「あっ」ポイント**: 「テストでAPIをモックするのに毎回苦労してるのは、Proxyがないからか…」

### 案C（逆転）: 潜伏型メモリリーク

- **技術的症状**: 大きなオブジェクトを初期化時に全部ロード。使われないデータもメモリに常駐。表面上は問題なく、長時間稼働でのみクラッシュ
- **医療メタファー**: 「慢性蓄積性肥満」— 見た目は健康だが、内臓脂肪が限界
- **重症度**: 重症（時限爆弾型）
- **Before/Afterの見込み**: Before: 全データ即時ロード → After: Virtual Proxy で必要時のみロード
- **読者の「あっ」ポイント**: 「本番で突然落ちるの、これが原因かも」

## 評価サマリー

### Step-Back: この記事で読者に何を持ち帰ってもらいたいか

「直接呼び出しは一見シンプルだが、代理層を挟むことで キャッシュ・遅延・アクセス制御・テスト容易性を同時に獲得できる」という Proxy パターンの多面的な価値。

### テーマ評価

| 評価軸 | 案A（王道） | 案B（革新） | 案C（逆転） |
|--------|:-----------:|:-----------:|:-----------:|
| ① 読者共感度 | 5 | 3 | 4 |
| ② メタファー適合度 | 4 | 3 | 4 |
| ③ コメディ発展性 | 3 | 2 | 5 |
| ④ 教育価値 | 5 | 4 | 3 |
| ⑤ 差別化 | 4 | 5 | 4 |
| **合計** | **21** | **17** | **20** |

### 患者評価

| 評価軸 | 案A（王道） | 案B（革新） | 案C（逆転） |
|--------|:-----------:|:-----------:|:-----------:|
| ① 読者共感度 | 4 | 4 | 3 |
| ② メタファー適合度 | 3 | 4 | 4 |
| ③ コメディ発展性 | 3 | 5 | 4 |
| ④ 教育価値 | 4 | 4 | 3 |
| ⑤ 差別化 | 3 | 3 | 5 |
| **合計** | **17** | **20** | **19** |

### 症状評価

| 評価軸 | 案A（王道） | 案B（革新） | 案C（逆転） |
|--------|:-----------:|:-----------:|:-----------:|
| ① 読者共感度 | 4 | 5 | 3 |
| ② メタファー適合度 | 4 | 5 | 3 |
| ③ コメディ発展性 | 3 | 4 | 3 |
| ④ 教育価値 | 4 | 4 | 4 |
| ⑤ 差別化 | 3 | 3 | 5 |
| **合計** | **18** | **21** | **18** |

### 相乗効果の検討

**採用組合せ**: テーマA × 患者B × 症状B

- **テーマ × 患者**: ✅ 「速さは正義」のせっかちエンジニアがDB負荷爆発ダッシュボードを作る — 「1クエリは最速だが全体が遅い」という矛盾が自然に発生
- **テーマ × 症状**: ✅ ダッシュボードの機能追加に伴い、API/DBの直叩きが増殖するのは典型的なシナリオ
- **患者 × 症状**: ✅ マイクロ最適化にこだわる患者が、マクロな問題（重複呼び出し）に無自覚 — パターンの価値を気づかされる展開に説得力あり

## 選定理由

テーマは**王道**のDB負荷問題を選択し、読者が即座に共感できる入口を確保。患者は**革新**の「速さは正義」突撃エンジニアで、「マイクロ最適化 vs マクロな問題」という皮肉な対比がコメディと教育の両立を実現。症状は**革新**の複合症状で、Proxyの多面的な価値（キャッシュ・テスト容易性・一元管理）を一度に示せる。

3要素の整合性が高く、「速いコードを書いているつもりが、全体では無駄だらけ」という矛盾が物語の推進力になる。

## 不採用案（参考）

### テーマ
- 案B（IoTセンサーデータ）: 技術的に面白いが読者層が限定的。スコア 17/25
- 案C（社長のExcelマクロ）: コメディ発展性は高いが技術的教育価値が弱い。スコア 20/25

### 患者
- 案A（真面目な新卒2年目）: 安定感はあるが差別化とコメディ発展性が弱い。スコア 17/25
- 案C（元料理人）: ユニークだがProxy との接点が弱い。スコア 19/25

### 症状
- 案A（直接アクセス肥大症）: わかりやすいが単調。スコア 18/25
- 案C（潜伏型メモリリーク）: 面白いが Virtual Proxy のみに偏る。スコア 18/25
