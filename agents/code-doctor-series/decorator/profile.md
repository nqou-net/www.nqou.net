# Patient Profile: Decorator Pattern

## Patient Profile

- **Name**: 判子の女王・ヨリコ (45)
- **Role**: 元総務部で紙の稟議書を20年処理 → DX推進でプログラマに転身1年目。社内稟議承認フローシステムの開発担当。
- **Personality**: おおらかで面倒見がいい。紙の稟議書の回覧ルートは全社で一番詳しい「生き字引」。「動けばヨシ！」の精神で力技のif-elseを量産する。プログラミング用語より「判子」「回覧」「付箋」で話す方がしっくりくる。部下に慕われるタイプだが、コードレビューでは「え、これ動きますよ？」が口癖。
- **Background**: 総務部で20年、紙の稟議書の回覧ルートを完璧に管理してきた達人。「係長→課長→部長→役員」の判子リレーが体に染み付いている。DX推進の号令で「紙の業務を一番知ってるのは君だ」とプログラマ研修に送り出され、半年の研修でPerlの基礎を習得。その後、社内稟議承認フローのデジタル化を一人で担当。紙の世界の常識（金額に応じて判子の数が変わる、部門ごとに回覧ルートが違う）をそのままif-elseで忠実にコードに翻訳した。
- **First Person**: 「私」
- **Chief Complaint（主訴）**: 「紙ならルート変更は付箋1枚貼るだけで済んだんですけど、プログラムだと大改修になっちゃって……。来月から監査ログ機能も追加してって言われてるんですが、また全部のif文に書き足すのかと思うと……」

## Medical Chart

- **Symptom**: 稟議書の承認フロー処理を1つの巨大関数 `process_ringi()` にすべて集約。金額帯（10万未満/10万以上/50万以上/100万以上）×部門（総務/営業/開発）×追加処理（ログ記録/メール通知/監査証跡）の全組み合わせをif-elsif-elseのネストで実現。200行超。フラグ変数 `$needs_buchou_hanko`, `$needs_yakuin_hanko`, `$needs_log`, `$needs_mail` の組み合わせ爆発。新しい承認ステップの追加で既存の全分岐に手を入れる必要があり、修正のたびにデグレが発生。
- **Metaphor**: 「包帯過剰巻着症候群（Excessive Bandage Wrapping Syndrome）——傷口（コアの承認処理）の上に包帯（条件分岐）を何重にも巻きすぎて、もはやどこが傷口かわからない。新しい傷（機能追加）のたびに包帯の上から包帯を巻く悪循環。包帯を1枚剥がそうとすると、別の傷口から出血（バグ）する」
- **Diagnosis**: 包帯過剰巻着症候群（Excessive Bandage Wrapping Syndrome）——コア処理と付加的責務が未分離の状態で、条件分岐による場当たり的な機能追加が重層化した慢性構造障害
- **Cure**: Decoratorパターンによる包帯解体・再巻着術。コア処理（基本承認フロー）を裸の状態に戻し、各付加機能（ログ記録・メール通知・監査証跡・役員承認）を独立したDecoratorクラスとして再構成。条件に応じて必要なDecoratorだけを動的に巻き付ける。
