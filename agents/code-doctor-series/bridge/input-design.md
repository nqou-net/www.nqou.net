# Input Design: Bridge

## Step-Back思考

> **この記事で読者に持ち帰ってもらいたいこと**:
> 「抽象」と「実装」が密結合していると、変化の方向が2つ以上あるとき**継承階層が指数的に爆発**する。Bridgeパターンは「has-a」関係で2つの軸を分離し、それぞれを独立に拡張可能にする。
> 既存のbridge-adapter-proxy統合版記事（ウイスキーテイスティング・ノート）とは異なり、**Bridge単体の本質**に焦点を当て、医療メタファーで「癒着した臓器の分離手術」として描く。

---

## テーマ3案

### 案A（王道）: 通知メッセンジャー

- **テーマ名**: マルチチャネル通知システム
- **一行説明**: メール・Slack・SMS等の通知手段と、緊急度別メッセージ（警告・情報・エラー）の組合せ
- **パターンとの接点**: 通知手段（実装）と通知内容の分類（抽象）が十字に交差し、手段×分類の全組合せサブクラスが爆発する
- **読者像**: Webアプリ開発者、インフラ系エンジニア。通知処理を自前で書いた経験がある人

### 案B（革新）: 楽器シンセサイザー

- **テーマ名**: 仮想楽器音源エンジン
- **一行説明**: 音色（ピアノ・ギター・シンセ）と演奏スタイル（クラシック・ジャズ・ロック）の組合せで音を生成する
- **パターンとの接点**: 楽器の種類（実装）と演奏方法（抽象）が独立に変化し、素朴な設計では InstrumentStyle 継承爆発が起きる
- **読者像**: 趣味でDTM/音楽をやるエンジニア、創作系プログラマ

### 案C（逆転）: レポート生成器（帳票印刷）

- **テーマ名**: 部門別・形式別レポート出力
- **一行説明**: 出力形式（PDF・CSV・HTML）と部門別ロジック（営業・経理・人事）を組み合わせるレポートシステム
- **パターンとの接点**: 形式と部門という2軸が掛け合わさり、「営業PDF」「経理CSV」…と個別クラスを量産してしまう泥沼。一見「Factory Methodで解決できそう」に見えるが本質はBridge
- **読者像**: 業務システム開発者。帳票地獄の現場を経験した中堅エンジニア

---

## テーマ評価

| 評価軸 | 案A（王道） | 案B（革新） | 案C（逆転） |
|--------|:-----------:|:-----------:|:-----------:|
| ① 読者共感度 | 4 | 2 | 5 |
| ② メタファー適合度 | 3 | 3 | 4 |
| ③ コメディ発展性 | 3 | 4 | 5 |
| ④ 教育価値 | 4 | 3 | 5 |
| ⑤ 差別化 | 2 | 5 | 4 |
| **合計** | **16** | **17** | **23** |
| **推奨理由** | 安定だが既視感あり | 新鮮だが共感が薄い | 業務の痛みとBridgeの本質が直結 |

---

## 患者3案

### 案A（王道）: 生真面目な若手SIer

- **属性**: 26歳男性、SIer3年目、内製チーム配属
- **性格キーワード**: 勤勉、言われた通りにやる、疑問を持たない
- **背景**: 仕様書通りに「部門×形式」の全組み合わせクラスを真面目に量産。「仕様書にそう書いてあったんです」
- **主訴**: 「新しい部門が追加されるたびに、3つクラスを作らなきゃいけなくて……もう追いつけません」
- **コメディポテンシャル**: 仕様書を聖典のように扱い、ドクターに仕様書を見せようとするが、ドクターは見もしない

### 案B（革新）: 自称アーキテクトの中堅

- **属性**: 34歳男性、Web系エンジニア8年目、最近「設計」に目覚めた
- **性格キーワード**: 自信過剰、知識は広いが浅い、カタカナ語多用
- **背景**: 「オブジェクト指向完全に理解した」と豪語して継承を多用。継承ツリーが5階層に
- **主訴**: 「設計は完璧なんですけど、なぜか変更コストが高いんです。チームメンバーの理解力の問題だと……」
- **コメディポテンシャル**: 自分の設計を「芸術品」と呼び、ドクターに褒められると思って来院。ドクターが一瞥して「……過剰（Excessive）」と呟き、絶句する

### 案C（逆転）: Excel職人からの転身組

- **属性**: 38歳女性、元経理部エクセル職人→社内SEに異動1年目
- **性格キーワード**: 几帳面、表が大好き、力技で解決する
- **背景**: 経理時代にExcelマクロで何でも解決していた経験を活かし、Perlでも「全パターンをif-elseで列挙」するスタイル
- **主訴**: 「ちゃんと動いてるんですが、部長が『新しい形式追加して』って言うたびに胃が痛くなるんです」
- **コメディポテンシャル**: Excelの癖で変数名が `$cell_A1`, `$sheet_name` 。ドクターが眉をひそめ、ナナコが「Excel……ですか？」と確認する

---

## 患者評価

| 評価軸 | 案A（王道） | 案B（革新） | 案C（逆転） |
|--------|:-----------:|:-----------:|:-----------:|
| ① 読者共感度 | 4 | 3 | 5 |
| ② メタファー適合度 | 3 | 4 | 4 |
| ③ コメディ発展性 | 3 | 5 | 5 |
| ④ 教育価値 | 4 | 4 | 4 |
| ⑤ 差別化 | 2 | 3 | 5 |
| **合計** | **16** | **19** | **23** |
| **推奨理由** | 安心感はあるが没個性 | 自信家キャラは面白いが既出パターン | 非エンジニア出身の視点が新鮮で共感を呼ぶ |

---

## 症状3案

### 案A（王道）: 継承爆発症候群

- **技術的症状**: 部門×形式の全組み合わせをサブクラスで表現。9クラス（3部門×3形式）が既に存在し、新部門追加で+3、新形式追加で+4と増殖
- **医療メタファー**: 「多臓器増殖症——新しい臓器（クラス）が次々と生まれ、本体（設計）がその重みで潰れようとしている」
- **重症度**: 重症
- **Before/Afterの見込み**: 9+のサブクラス → 抽象3 + 実装3 = 6要素。追加は各軸に1つずつでOK
- **読者の「あっ」ポイント**: 「うちの〇〇Factoryクラス群、まさにこれだ……」

### 案B（革新）: 複合汚染——if文の瘴気

- **技術的症状**: 継承ではなくif-elsif地獄で実現。`generate_report($department, $format)` 関数内に部門×形式の全分岐が巨大なネストで存在
- **医療メタファー**: 「慢性的な条件分岐瘴毒——空気（ロジック）が分岐の瘴気で汚染され、どこを切っても毒素（バグ）が漏れ出す」
- **重症度**: 重症
- **Before/Afterの見込み**: 200行超のif-elsif → Bridge適用で各20行程度のクラスに分離
- **読者の「あっ」ポイント**: 「if-elseで書いてたけど、あれも実質同じ問題だったのか……」

### 案C（逆転）: 潜伏型——今は動いているが

- **技術的症状**: 現状2部門×2形式=4パターンでギリギリ成立。ただし来月から3部門追加の予定があり、爆発が確定
- **医療メタファー**: 「潜伏型腫瘍——レントゲンには写らないが、成長速度から計算すると3ヶ月後に致命的サイズに達する」
- **重症度**: 中症（現時点）→ 重症（3ヶ月後）
- **Before/Afterの見込み**: 4パターン→予防的Bridge適用で5部門×4形式でも耐えられる構造に
- **読者の「あっ」ポイント**: 「今動いてるからOKと思ってたけど、将来のこと考えてなかった……」

---

## 症状評価

| 評価軸 | 案A（王道） | 案B（革新） | 案C（逆転） |
|--------|:-----------:|:-----------:|:-----------:|
| ① 読者共感度 | 4 | 5 | 3 |
| ② メタファー適合度 | 4 | 4 | 3 |
| ③ コメディ発展性 | 3 | 5 | 3 |
| ④ 教育価値 | 4 | 5 | 4 |
| ⑤ 差別化 | 3 | 5 | 4 |
| **合計** | **18** | **24** | **17** |
| **推奨理由** | 正統派だが意外性に欠ける | if-else地獄はBridge文脈で新鮮、患者Cとの相性抜群 | 教育的だが物語性が弱い |

---

## 相乗効果の検討

### 最高スコアの組合せ: テーマC × 患者C × 症状B

- **テーマC（レポート生成器） × 患者C（Excel職人転身）**: ✅ 経理部出身のExcel職人が社内SEとしてレポート出力システムを作るのは極めて自然。帳票が身近な題材
- **テーマC × 症状B（if-else地獄）**: ✅ Excel的発想（セルにIF関数を入れる感覚）でif-elseを量産するのはリアルそのもの
- **患者C × 症状B**: ✅ Excel職人がプログラミングに転向し、Excelマクロ時代の癖で条件分岐を量産するのは強い説得力。「Excelなら表で管理するところを、コードでは全部if文で書いちゃった」

### 整合性: ★★★★★（完璧）

3要素が互いに自然に噛み合い、物語として一貫したストーリーが見える。

---

## 選定結果

### 採用案
- **テーマ**: 案C「部門別・形式別レポート出力」（23点）
- **患者**: 案C「Excel職人からの転身組」（23点）
- **症状**: 案B「if文の瘴気（if-elsif地獄）」（24点）
- **総合スコア**: 70/75

### 選定理由

Excel職人が社内SE転身し、帳票レポートシステムを「Excelの感覚」でif-elseの力技で実装した——というストーリーラインは、**業務システム開発者の強烈な共感**を呼ぶ。Bridgeパターンの本質（2つの軸の分離）をif-else地獄から始めることで、「継承だけがBridgeの適用場面ではない」という教育的メッセージも伝えられる。

また、女性エンジニア（非CS出身）という患者像はコードドクターシリーズで初であり、差別化が強い。Excel変数名（`$cell_A1`）のネタはコメディとしても秀逸。

### 3要素の整合性
- テーマ × 患者: ✅ 経理部出身SE → レポート出力システム開発は極めて自然
- テーマ × 症状: ✅ 部門×形式の全分岐をif-elseで列挙するのはリアルな泥沼
- 患者 × 症状: ✅ Excel的発想（IFネスト）がPerlコードにそのまま反映された説得力

---

## テーマ詳細

- **テーマ名**: 部門別・形式別レポート出力
- **一行説明**: 出力形式（PDF・CSV・HTML）と部門別ロジック（営業・経理・人事）を組み合わせるレポートシステム
- **パターンとの接点**: 形式と部門という2軸が掛け合わさり、if-elseで全組合せを列挙してしまう泥沼。Bridgeで「レポート抽象」と「形式実装」を分離
- **読者像**: 業務システム開発者。帳票地獄の現場を経験した中堅エンジニア

## 患者詳細

- **属性**: 38歳女性、元経理部エクセル職人→社内SEに異動1年目
- **性格キーワード**: 几帳面、表が大好き、力技で解決する
- **背景**: 経理時代にExcelマクロで何でも解決していた。異動後も「動けば正義」の精神でif-elseを量産
- **主訴**: 「ちゃんと動いてるんですが、部長が『新しい形式追加して』って言うたびに胃が痛くなるんです」
- **コメディポテンシャル**: Excel由来の変数名、セルで考える思考回路
- **一人称**: 「私」

## 症状詳細

- **技術的症状**: `generate_report($department, $format)` 関数内に部門×形式の全分岐が巨大なif-elsifネストで存在（200行超）
- **医療メタファー**: 「慢性条件分岐瘴毒——空気（ロジック）が分岐の瘴気で汚染され、どこを切っても毒素（バグ）が漏れ出す」
- **重症度**: 重症
- **Before/Afterの見込み**: 200行超のif-elsif → Bridge適用で部門クラス3つ + 形式クラス3つ = 各20行程度に分離
- **読者の「あっ」ポイント**: 「if-elseで書いてたけど、あれも実質同じ問題だったのか……」

## 不採用案（参考）

### テーマ
- 案A「マルチチャネル通知」（16点）: 題材が定番すぎて差別化困難
- 案B「楽器シンセサイザー」（17点）: 新鮮だが読者の共感が薄い

### 患者
- 案A「生真面目な若手SIer」（16点）: 没個性的
- 案B「自称アーキテクト」（19点）: 面白いが、継承爆発症状との相性が良すぎてif-else症状との組合せが不自然

### 症状
- 案A「継承爆発症候群」（18点）: 正統派だがウイスキー記事と被り差別化困難
- 案C「潜伏型腫瘍」（17点）: 教育的だが物語として盛り上がりに欠ける
