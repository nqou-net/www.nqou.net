# アウトライン案: Mojo::UserAgentでスクレイピング入門

## 調査ドキュメント参照
- **調査ファイル**: `agents/research/mojo-useragent-scraping.md`
- **作成日**: 2025-12-29
- **レビュー回数**: 3回（以下の案A/B/C共通）

---

## 案A: チュートリアル形式（ステップバイステップ）

### 要約
初心者がゼロから学べるMojo::UserAgentスクレイピングの完全ガイド。環境構築から実践まで段階的に解説

### タイトル案
**「Perlスクレイピング入門！Mojo::UserAgentで始めるWebデータ収集の基礎【初心者向けチュートリアル】」**

### meta description
Perl初心者でも安心！Mojo::UserAgentを使ったスクレイピングを基礎から実践まで段階的に解説。環境構築からデータ抽出、エラー処理、倫理的配慮まで網羅した完全ガイド。CSSセレクタで簡単データ取得！

### H2/H3 見出し構造

#### H2: Mojo::UserAgentとは？なぜスクレイピングに最適なのか
- H3: ウェブスクレイピングの基礎知識
- H3: Mojo::UserAgentの3つの強み
- H3: LWP::UserAgentとの違いを比較

#### H2: 【ステップ1】環境構築とインストール
- H3: Perlのバージョン確認方法
- H3: cpanmを使ったMojoliciousのインストール
- H3: 動作確認：最初の一歩

#### H2: 【ステップ2】初めてのGETリクエストでページを取得
- H3: 基本的なコード構成を理解する
- H3: HTTPレスポンスの確認方法
- H3: エラーハンドリングの基礎

#### H2: 【ステップ3】Mojo::DOMでHTMLをパースする
- H3: CSSセレクタの基本文法
- H3: 単一要素の抽出（atメソッド）
- H3: 複数要素の抽出（findメソッド）
- H3: 属性値とテキストの取得

#### H2: 【ステップ4】実践！サンプルサイトからデータを抽出
- H3: タイトルとリンクを抽出する
- H3: テーブルデータをパースする
- H3: 画像URLを収集する

#### H2: 【ステップ5】POSTリクエストとフォーム送信
- H3: フォームデータの送信方法
- H3: JSON形式でのデータ送信
- H3: 認証が必要なサイトへのアクセス

#### H2: 【ステップ6】データを保存する（CSV/JSON出力）
- H3: JSON形式で保存する
- H3: CSV形式で保存する
- H3: ファイル操作のベストプラクティス

#### H2: 【ステップ7】ページネーションの処理方法
- H3: 次のページURLを自動で取得する
- H3: 複数ページを連続で処理する
- H3: 処理の進捗を確認する

#### H2: スクレイピングのマナーとベストプラクティス
- H3: User-Agentを適切に設定する
- H3: リクエスト間隔（レート制限）の実装
- H3: robots.txtを確認する習慣
- H3: タイムアウト設定でハングを防ぐ

#### H2: 法的・倫理的配慮を忘れずに
- H3: 日本におけるスクレイピングの法的状況
- H3: 利用規約（ToS）の確認ポイント
- H3: 個人情報保護法への配慮
- H3: 安全にスクレイピングするための5つのルール

#### H2: トラブルシューティング：よくあるエラーと解決法
- H3: 接続エラーが発生する場合
- H3: 要素が見つからない場合
- H3: 文字化けが発生する場合

#### H2: まとめと次のステップ
- H3: この記事で学んだこと
- H3: 非同期スクレイピングへの発展
- H3: 参考リソースとコミュニティ

### 推奨タグ
- `perl`
- `web-scraping`
- `mojolicious`
- `mojo-useragent`
- `tutorial`

---

## 案B: 実践例中心（具体的なユースケースから学ぶ）

### 要約
実際の利用シーンから逆算して学ぶMojo::UserAgentスクレイピング。ニュースサイト、ECサイト、API連携など実践パターン満載

### タイトル案
**「【実例で学ぶ】Mojo::UserAgentスクレイピング完全ガイド｜ニュース収集からAPI連携まで実践パターン集」**

### meta description
実践的なユースケースでMojo::UserAgentをマスター！ニュースサイトのヘッドライン収集、ECサイトの価格監視、API連携など、すぐ使える実例コード満載。CSSセレクタとエラー処理も完全解説。

### H2/H3 見出し構造

#### H2: Mojo::UserAgentで実現できること
- H3: 本記事で扱う5つの実践例
- H3: Mojo::UserAgentの特徴と選ぶ理由
- H3: 必要な環境とインストール方法

#### H2: 【実践例1】ニュースサイトのヘッドライン自動収集
- H3: ユースケース：毎朝のニュースチェックを自動化
- H3: 実装：タイトルとURLを抽出する
- H3: 応用：カテゴリ別に分類して保存
- H3: コード全文とポイント解説

#### H2: 【実践例2】ECサイトの商品価格モニタリング
- H3: ユースケース：価格変動を追跡して通知
- H3: 実装：商品情報と価格を定期取得
- H3: 応用：複数サイトの価格を比較
- H3: コード全文とポイント解説

#### H2: 【実践例3】ログイン認証が必要なサイトへのアクセス
- H3: ユースケース：会員限定コンテンツの取得
- H3: 実装：セッション管理とクッキー処理
- H3: 応用：クッキーの永続化と再利用
- H3: コード全文とポイント解説

#### H2: 【実践例4】ページネーション処理で大量データ収集
- H3: ユースケース：検索結果の全ページを取得
- H3: 実装：次ページへの自動遷移ロジック
- H3: 応用：非同期処理で高速化
- H3: コード全文とポイント解説

#### H2: 【実践例5】REST APIとの連携でデータを統合
- H3: ユースケース：スクレイピングとAPI取得の組み合わせ
- H3: 実装：JSON形式でのデータ送受信
- H3: 応用：認証トークンの管理
- H3: コード全文とポイント解説

#### H2: CSSセレクタ実践テクニック集
- H3: よく使うセレクタパターン10選
- H3: 複雑な階層構造の攻略法
- H3: 属性セレクタの活用例
- H3: 疑似クラスでピンポイント抽出

#### H2: エラー処理とリトライ戦略
- H3: タイムアウトの適切な設定
- H3: ステータスコード別の処理分岐
- H3: リトライポリシーの実装
- H3: ログ出力で問題を追跡

#### H2: データ出力と保存の実践パターン
- H3: JSON形式での構造化データ保存
- H3: CSV形式でExcel連携
- H3: データベースへの直接保存
- H3: ファイル命名とディレクトリ管理

#### H2: スクレイピングのマナーと法的配慮
- H3: robots.txtの確認と遵守
- H3: User-Agent設定とレート制限
- H3: 日本における法的リスクと対策
- H3: 利用規約（ToS）チェックポイント

#### H2: パフォーマンス最適化テクニック
- H3: 非同期リクエストで処理を高速化
- H3: 並行処理の制限数を調整
- H3: メモリ使用量の最適化
- H3: デバッグとプロファイリング

#### H2: まとめ：実践から学ぶ次のステップ
- H3: 5つの実践例の振り返り
- H3: 応用アイデア集
- H3: コミュニティとリソース

### 推奨タグ
- `perl`
- `web-scraping`
- `mojolicious`
- `mojo-useragent`
- `css-selector`

---

## 案C: リファレンス＋実践のハイブリッド

### 要約
Mojo::UserAgentの機能リファレンスと実践コードを統合。体系的に学びながら即座に実装できるハイブリッド型ガイド

### タイトル案
**「Mojo::UserAgent完全マスター｜機能リファレンス＋実践コード集でPerlスクレイピングを極める」**

### meta description
Mojo::UserAgentの全機能を体系的に解説！各メソッドの詳細リファレンス＋すぐ使える実践コード付き。初心者から中級者まで、辞書的にも使えるPerlスクレイピングの決定版ガイド。

### H2/H3 見出し構造

#### H2: Mojo::UserAgent完全ガイドの使い方
- H3: 本記事の構成と読み方
- H3: リファレンス部分と実践部分の使い分け
- H3: 環境構築とバージョン確認

#### H2: 【基礎編】Mojo::UserAgentの基本構造
- H3: オブジェクトの生成と初期化
- H3: リクエストメソッドの種類（GET/POST/PUT/DELETE）
- H3: レスポンスオブジェクトの構造
- H3: 実践コード：最小限のスクレイピング

#### H2: 【リファレンス】HTTPリクエストメソッド詳解
- H3: get() / get_p() - GETリクエスト
- H3: post() / post_p() - POSTリクエスト
- H3: put() / put_p() - PUTリクエスト
- H3: delete() / delete_p() - DELETEリクエスト
- H3: 実践コード：各メソッドの使用例

#### H2: 【リファレンス】レスポンス処理メソッド詳解
- H3: result() - レスポンス結果の取得
- H3: is_success() / is_error() - ステータス確認
- H3: code() / message() - ステータスコードとメッセージ
- H3: headers() - ヘッダー情報へのアクセス
- H3: 実践コード：包括的なエラーハンドリング

#### H2: 【リファレンス】Mojo::DOMパース機能詳解
- H3: dom() - DOMオブジェクトの取得
- H3: at() - 単一要素の選択
- H3: find() - 複数要素の選択
- H3: text() / all_text() - テキスト抽出
- H3: attr() / val() - 属性値の取得
- H3: 実践コード：複雑なHTML構造のパース

#### H2: 【リファレンス】CSSセレクタ完全リファレンス
- H3: 基本セレクタ（タグ、クラス、ID）
- H3: 属性セレクタとパターンマッチ
- H3: 疑似クラスと疑似要素
- H3: 結合子（子孫、子、隣接）
- H3: 実践コード：セレクタパターン実例集

#### H2: 【リファレンス】設定・カスタマイズメソッド詳解
- H3: transactor->name() - User-Agent設定
- H3: connect_timeout() - 接続タイムアウト
- H3: inactivity_timeout() - 非アクティブタイムアウト
- H3: max_redirects() - リダイレクト設定
- H3: proxy() - プロキシ設定
- H3: 実践コード：本番環境向け設定例

#### H2: 【リファレンス】Cookie・セッション管理詳解
- H3: cookie_jar() - クッキージャーの取得
- H3: cookie_jar->add() / find() - クッキー操作
- H3: cookie_jar->file() - クッキーの永続化
- H3: 実践コード：ログイン状態の維持

#### H2: 【実践編】フォーム送信とデータ投稿
- H3: application/x-www-form-urlencoded形式
- H3: multipart/form-data形式（ファイルアップロード）
- H3: JSON形式でのAPI連携
- H3: 実践コード：各形式の送信例

#### H2: 【実践編】認証方式別アクセス方法
- H3: Basic認証の実装
- H3: Bearer Token認証の実装
- H3: セッションベース認証の実装
- H3: 実践コード：認証パターン別サンプル

#### H2: 【実践編】非同期・並行処理
- H3: Promiseベースの非同期リクエスト
- H3: 並行処理数の制御
- H3: エラーハンドリングとリトライ
- H3: 実践コード：大量URL処理の最適化

#### H2: 【実践編】データ加工と出力
- H3: 抽出データの構造化
- H3: JSON出力の実装
- H3: CSV出力の実装
- H3: データベース連携
- H3: 実践コード：出力パターン別サンプル

#### H2: 【ベストプラクティス】スクレイピングマナー
- H3: robots.txtの確認方法
- H3: User-Agent設定の推奨形式
- H3: レート制限の実装パターン
- H3: 実践コード：倫理的スクレイパーのテンプレート

#### H2: 【ベストプラクティス】法的・倫理的配慮
- H3: 日本の著作権法との関係
- H3: 不正競争防止法への配慮
- H3: 個人情報保護法の遵守
- H3: 利用規約（ToS）確認チェックリスト

#### H2: 【トラブルシューティング】よくある問題と解決法
- H3: 接続エラー・タイムアウト
- H3: パースエラー・要素が見つからない
- H3: 文字エンコーディング問題
- H3: メモリリーク・パフォーマンス低下

#### H2: まとめ：Mojo::UserAgentマスターへの道
- H3: 主要メソッド一覧チートシート
- H3: 学習ロードマップ
- H3: 公式ドキュメントとコミュニティ

### 推奨タグ
- `perl`
- `web-scraping`
- `mojolicious`
- `mojo-useragent`
- `reference`

---

## レビューと改善の記録

### 第1回レビュー（初稿作成直後）

#### 全体的な評価
- 3案とも異なるアプローチで構成されており、方向性は適切
- 調査内容を十分に反映している
- SEO観点での最適化が必要

#### 改善点
1. **タイトルの最適化**
   - 主要キーワードをより前方に配置
   - クリック率を高める表現を追加
   - 文字数を最適範囲（30-35文字）に調整

2. **meta descriptionの改善**
   - 行動喚起（CTA）要素を追加
   - より具体的なベネフィットを明示
   - 検索意図に合わせた表現の調整

3. **見出し構造の最適化**
   - H2見出しにキーワードを自然に含める
   - ユーザーの検索意図に沿った見出し順序
   - 各見出しの具体性を向上

### 第2回レビュー（改善後）

#### 改善実施内容
1. **案A（チュートリアル形式）**
   - タイトルに「初心者向けチュートリアル」を追加
   - ステップ番号を見出しに明記して段階性を強調
   - トラブルシューティングセクションを追加

2. **案B（実践例中心）**
   - 「実例で学ぶ」をタイトルに追加
   - 具体的なユースケースを見出しに反映
   - パフォーマンス最適化セクションを追加

3. **案C（ハイブリッド）**
   - 「完全マスター」「決定版」などの強調表現を追加
   - リファレンス部分と実践部分を明確に区分
   - チートシートの提供を明記

#### 追加改善点
- 各案の推奨タグを5個に統一
- meta descriptionの文字数を160文字以内に調整
- 見出しに数字や具体例を追加

### 第3回レビュー（最終調整）

#### 最終調整内容
1. **SEO最適化**
   - 主要キーワード「Mojo::UserAgent」「Perl」「スクレイピング」を全案のタイトルに含める
   - meta descriptionに具体的な数値やベネフィットを追加
   - 見出し構造を検索意図に合わせて微調整

2. **ユーザビリティ向上**
   - 各案の「要約」をより明確に差別化
   - 実践コードの分量を見出しから予測できるように
   - 法的配慮セクションの重要性を強調

3. **内部リンク戦略**
   - Mojolicious関連記事へのリンクポイントを設計
   - Perl基礎記事へのリンクポイントを設計
   - スクレイピング関連記事へのリンクポイントを設計

#### 最終評価
- **案A**: 初心者が最も取り組みやすい構成。段階的学習に最適
- **案B**: 実務経験者や目的が明確な読者に最適。即戦力コード重視
- **案C**: 辞書的に使える包括的ガイド。中級者以上や長期的参照に最適

### 推奨案
**対象読者が「基本的なプログラミング知識がある初心者」のため、案Aを最推奨**
ただし、読者の具体的なニーズに応じて案B（実践重視）や案C（網羅性重視）も有効

---

## 各案の想定読者と使用シーン

### 案A: チュートリアル形式
- **想定読者**: Perlを多少触ったことがある初心者、スクレイピング未経験者
- **使用シーン**: 初めてスクレイピングに挑戦する、基礎から順番に学びたい
- **強み**: 段階的に理解でき、挫折しにくい構成
- **SEO優位性**: 「初心者」「入門」「チュートリアル」での検索に強い

### 案B: 実践例中心
- **想定読者**: 基礎知識はある程度あり、具体的な目的がある開発者
- **使用シーン**: 特定のタスク（ニュース収集、価格監視など）を実装したい
- **強み**: すぐに使える実用コードが豊富
- **SEO優位性**: 「ニュース収集」「価格監視」などの具体的タスク検索に強い

### 案C: リファレンス＋実践
- **想定読者**: 体系的に学びたい中級者、辞書的に参照したい開発者
- **使用シーン**: 全機能を理解したい、後から特定機能を調べたい
- **強み**: 包括的で長期的な価値が高い
- **SEO優位性**: 「リファレンス」「完全ガイド」「マスター」での検索に強い

---

## SEO戦略メモ

### 主要キーワードの配置戦略
1. **タイトルタグ**: 主要キーワードを前半30文字以内に配置
2. **meta description**: キーワードを自然に含めつつベネフィットを強調
3. **H2見出し**: 主要キーワードを50%以上の見出しに含める
4. **H3見出し**: 関連キーワードとロングテールキーワードを配置

### キーワード密度目標
- **主要キーワード**: 2-3%（自然な範囲内）
- **関連キーワード**: 1-2%
- **ロングテールキーワード**: 見出しと小見出しに配置

### 内部リンク戦略
- Perl基礎記事へのリンク: 導入部と環境構築セクション
- Mojolicious関連記事へのリンク: フレームワーク説明部分
- 関連スクレイピング記事へのリンク: まとめセクション

### 外部リンク戦略
- 公式ドキュメント: 信頼性向上のため適切に配置
- 法的情報源: 日本の法律関連情報へのリンク
- コミュニティリソース: MetaCPAN、GitHub等

---

## 記事作成時の注意事項

### コードサンプルの品質
- 全てのコードは動作確認済みであること
- エラーハンドリングを含めること
- コメントで説明を補足すること
- バージョン情報を明記すること

### 法的配慮の記述
- 日本の法律状況を正確に記載
- 免責事項を適切に配置
- 倫理的スクレイピングの重要性を強調

### 図表の活用
- Mermaid記法でのフローチャート推奨箇所
  - スクレイピングの処理フロー
  - エラーハンドリングの分岐
  - ページネーション処理の流れ

### アイキャッチ画像
- Perlとウェブスクレイピングを連想させるビジュアル
- 技術記事に適したデザイン
- OGP最適サイズ（1200x630px）

---

**アウトライン作成完了日**: 2025-12-29
**次のアクション**: 専門家エージェントによる記事執筆（推奨：案A）
