---
description: Perlã®æ¨™æº–ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«Getopt::Longã‚’ä½¿ã£ãŸã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³å¼•æ•°å‡¦ç†ã‚’ã€wcã‚³ãƒãƒ³ãƒ‰ã®ã‚¯ãƒ­ãƒ¼ãƒ³ã‚’ä½œã‚ŠãªãŒã‚‰å­¦ã¶å…¥é–€ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã€‚
draft: true
tags:
  - perl
  - getopt-long
  - tutorial
title: ä½œã£ã¦å­¦ã¶Getopt::Longå…¥é–€
---

## ã¯ã˜ã‚ã« - ä½œã‚ŠãªãŒã‚‰è¦šãˆã‚‹

ã“ã®è¨˜äº‹ã§ã¯ã€Perlã®æ¨™æº–ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«**Getopt::Long**ã‚’ä½¿ã£ã¦ã€å®Ÿéš›ã«å‹•ãã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ãƒ„ãƒ¼ãƒ«ã‚’ä½œã‚ŠãªãŒã‚‰å­¦ã³ã¾ã™ã€‚ã€Œèª­ã‚“ã§ç†è§£ã™ã‚‹ã€ã®ã§ã¯ãªãã€Œä½œã£ã¦å‹•ã‹ã™ã€ã“ã¨ã§ã€å®Ÿè·µçš„ãªã‚¹ã‚­ãƒ«ãŒèº«ã«ã¤ãã¾ã™ã€‚

### å®Œæˆã‚¤ãƒ¡ãƒ¼ã‚¸: wc-lite ã‚³ãƒãƒ³ãƒ‰

ä»Šå›ä½œæˆã™ã‚‹ã®ã¯ã€Unixã®`wc`ï¼ˆword countï¼‰ã‚³ãƒãƒ³ãƒ‰ã‚’ç°¡ç•¥åŒ–ã—ãŸ**wc-lite**ã§ã™ã€‚å®Œæˆã™ã‚‹ã¨ã€æ¬¡ã®ã‚ˆã†ã«ä½¿ãˆã¾ã™ã€‚

```bash
# è¡Œæ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆ
$ echo -e "Hello\nWorld" | perl wc-lite.pl -l
2

# å˜èªæ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆ
$ echo "Hello World Perl" | perl wc-lite.pl -w
3

# è¤‡æ•°ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’çµ„ã¿åˆã‚ã›
$ echo -e "Hello World\nPerl is great" | perl wc-lite.pl -l -w -c
2	5	26

# çµæœã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã«å‡ºåŠ›
$ cat sample.txt | perl wc-lite.pl --lines --output=result.txt

# ãƒ˜ãƒ«ãƒ—ã‚’è¡¨ç¤º
$ perl wc-lite.pl --help
```

### ã“ã®è¨˜äº‹ã§ç¿’å¾—ã§ãã‚‹ã“ã¨

ã“ã®è¨˜äº‹ã‚’èª­ã¿çµ‚ãˆã‚‹ã¨ã€ä»¥ä¸‹ã®ã“ã¨ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

- Getopt::Longã®åŸºæœ¬çš„ãªä½¿ã„æ–¹ã‚’ç†è§£ã™ã‚‹
- ãƒ•ãƒ©ã‚°ã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼ˆ`--verbose`ãªã©ï¼‰ã‚’å®Ÿè£…ã™ã‚‹
- å€¤ã‚’å—ã‘å–ã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼ˆ`--output=FILE`ãªã©ï¼‰ã‚’å®Ÿè£…ã™ã‚‹
- ã‚·ãƒ§ãƒ¼ãƒˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼ˆ`-l`, `-w`ãªã©ï¼‰ã‚’è¿½åŠ ã™ã‚‹
- ãƒ˜ãƒ«ãƒ—ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¨ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’å®Ÿè£…ã™ã‚‹

### å­¦ç¿’ã®æµã‚Œ

ä»¥ä¸‹ã®7ã¤ã®ã‚¹ãƒ†ãƒƒãƒ—ã§ã€æ®µéšçš„ã«æ©Ÿèƒ½ã‚’è¿½åŠ ã—ã¦ã„ãã¾ã™ã€‚

```mermaid
flowchart LR
    subgraph åŸºç¤["ğŸ”° åŸºç¤"]
        S1["Step 1<br/>æœ€å°ç‰ˆ"]
        S2["Step 2<br/>ãƒ•ãƒ©ã‚°"]
        S3["Step 3<br/>è¤‡æ•°ã‚ªãƒ—ã‚·ãƒ§ãƒ³"]
    end
    subgraph å¿œç”¨["ğŸ“ˆ å¿œç”¨"]
        S4["Step 4<br/>å€¤ã®å—ã‘å–ã‚Š"]
        S5["Step 5<br/>ã‚·ãƒ§ãƒ¼ãƒˆ"]
    end
    subgraph ä»•ä¸Š["âœ… ä»•ä¸Šã’"]
        S6["Step 6<br/>ãƒ˜ãƒ«ãƒ—"]
        S7["Step 7<br/>ã‚¨ãƒ©ãƒ¼å‡¦ç†"]
    end
    S1 --> S2 --> S3 --> S4 --> S5 --> S6 --> S7
```

## æº–å‚™

### Perlã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ã²ãªå½¢

ã™ã¹ã¦ã®Perlã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ã€ä»¥ä¸‹ã®ã²ãªå½¢ã‹ã‚‰å§‹ã‚ã¾ã™ã€‚

```perl
#!/usr/bin/env perl
use strict;
use warnings;
use feature 'say';
```

Perlã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ã²ãªå½¢ã«ã¤ã„ã¦ã®è©³ç´°ã¯ã€ä»¥ä¸‹ã®è¨˜äº‹ã‚‚å‚è€ƒã«ã—ã¦ãã ã•ã„ã€‚

{{< linkcard "/2015/02/07/142727/" >}}

ãªãŠã€**Getopt::Long**ã¯Perlã®ã‚³ã‚¢ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãªã®ã§ã€è¿½åŠ ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¯ä¸è¦ã§ã™ã€‚

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚©ãƒ«ãƒ€ã®ä½œæˆ

ä½œæ¥­ç”¨ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã¾ã™ã€‚

```bash
mkdir wc-lite
cd wc-lite
touch wc-lite.pl
chmod +x wc-lite.pl
```

## Step 1: å¼•æ•°ãªã—ã§å‹•ãæœ€å°ç‰ˆ

ã¾ãšã€ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ã‚ãªã„æœ€å°é™ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚

### æ¨™æº–å…¥åŠ›ã‹ã‚‰è¡Œæ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆ

`wc-lite.pl`ã‚’ä»¥ä¸‹ã®å†…å®¹ã§ä½œæˆã—ã¦ãã ã•ã„ã€‚

```perl
#!/usr/bin/env perl
use strict;
use warnings;
use feature 'say';

my $lines = 0;

while (my $line = <STDIN>) {
    $lines++;
}

say "Lines: $lines";
```

### å‹•ä½œç¢ºèª

```bash
$ echo -e "Hello World\nPerl is great" | perl wc-lite.pl
Lines: 2
```

ã“ã‚Œã§åŸºæœ¬çš„ãªã‚«ã‚¦ãƒ³ãƒˆæ©Ÿèƒ½ãŒã§ãã¾ã—ãŸã€‚æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã§ã¯ã€Getopt::Longã‚’ä½¿ã£ã¦ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ ã—ã¦ã„ãã¾ã™ã€‚

## Step 2: æœ€åˆã®ãƒ•ãƒ©ã‚°ã‚ªãƒ—ã‚·ãƒ§ãƒ³

### --lines ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®è¿½åŠ 

`--lines`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®šã—ãŸã¨ãã ã‘è¡Œæ•°ã‚’è¡¨ç¤ºã™ã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

```perl
#!/usr/bin/env perl
use strict;
use warnings;
use feature 'say';
use Getopt::Long;

my $show_lines = 0;

GetOptions(
    'lines' => \$show_lines,
) or die "Error in command line arguments\n";

my $lines = 0;
my $words = 0;
my $chars = 0;

while (my $line = <STDIN>) {
    $lines++;
    $words += scalar(split ' ', $line);
    $chars += length($line);
}

if ($show_lines) {
    say $lines;
}
```

å‹•ä½œç¢ºèªã‚’ã—ã¾ã™ã€‚

```bash
$ echo -e "Hello\nWorld\nPerl" | perl wc-lite.pl --lines
3

$ echo -e "Hello\nWorld\nPerl" | perl wc-lite.pl
ï¼ˆä½•ã‚‚è¡¨ç¤ºã•ã‚Œãªã„ï¼‰
```

### GetOptionsã®åŸºæœ¬æ§‹æ–‡

`GetOptions`ã¯ã€ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³å¼•æ•°ã‚’è§£æã—ã¦Perlã®å¤‰æ•°ã«æ ¼ç´ã™ã‚‹é–¢æ•°ã§ã™ã€‚

```perl
GetOptions(
    'ã‚ªãƒ—ã‚·ãƒ§ãƒ³å' => \$å¤‰æ•°,
) or die "Error in command line arguments\n";
```

- **'ã‚ªãƒ—ã‚·ãƒ§ãƒ³å'** : ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæŒ‡å®šã™ã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼ˆ`--lines`ã®`lines`éƒ¨åˆ†ï¼‰
- **\$å¤‰æ•°** : ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®å€¤ã‚’æ ¼ç´ã™ã‚‹å¤‰æ•°ã¸ã®ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹

ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®è¨˜äº‹ã§è©³ã—ãè§£èª¬ã—ã¦ã„ã¾ã™ã€‚

{{< linkcard "/2025/12/06/000000/" >}}

`GetOptions`ãŒå¤±æ•—ã™ã‚‹ã¨å½ã‚’è¿”ã™ãŸã‚ã€`or die`ã§ã‚¨ãƒ©ãƒ¼å‡¦ç†ã‚’ã—ã¦ã„ã¾ã™ã€‚

### GetOptionsã®å‹•ä½œãƒ•ãƒ­ãƒ¼

`GetOptions`ãŒã©ã®ã‚ˆã†ã«å‹•ä½œã™ã‚‹ã‹ã‚’å›³ã§ç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚

```mermaid
flowchart LR
    subgraph Input["ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³"]
        ARGV["@ARGV<br/>--lines --output=result.txt"]
    end
    subgraph Process["GetOptions"]
        Parse["ã‚ªãƒ—ã‚·ãƒ§ãƒ³è§£æ"]
    end
    subgraph Output["Perlå¤‰æ•°"]
        Var1["$show_lines = 1"]
        Var2["$output_file = 'result.txt'"]
    end
    ARGV --> Parse
    Parse --> Var1
    Parse --> Var2
```

`GetOptions`ã¯`@ARGV`ã‹ã‚‰ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’èª­ã¿å–ã‚Šã€å¯¾å¿œã™ã‚‹å¤‰æ•°ã«å€¤ã‚’æ ¼ç´ã—ã¾ã™ã€‚å‡¦ç†æ¸ˆã¿ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯`@ARGV`ã‹ã‚‰å–ã‚Šé™¤ã‹ã‚Œã¾ã™ã€‚

## Step 3: è¤‡æ•°ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³

### --words, --chars ã®è¿½åŠ 

è¡Œæ•°ã ã‘ã§ãªãã€å˜èªæ•°ã¨æ–‡å­—æ•°ã‚‚è¡¨ç¤ºã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

```perl
#!/usr/bin/env perl
use strict;
use warnings;
use feature 'say';
use Getopt::Long;

my $show_lines = 0;
my $show_words = 0;
my $show_chars = 0;

GetOptions(
    'lines' => \$show_lines,
    'words' => \$show_words,
    'chars' => \$show_chars,
) or die "Error in command line arguments\n";

my $lines = 0;
my $words = 0;
my $chars = 0;

while (my $line = <STDIN>) {
    $lines++;
    $words += scalar(split ' ', $line);
    $chars += length($line);
}

# å‡ºåŠ›
my @output;
push @output, $lines if $show_lines;
push @output, $words if $show_words;
push @output, $chars if $show_chars;

if (@output) {
    say join("\t", @output);
}
```

### çµ„ã¿åˆã‚ã›å‡¦ç†

è¤‡æ•°ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’çµ„ã¿åˆã‚ã›ã¦ä½¿ãˆã¾ã™ã€‚

```bash
$ echo "Hello World Perl" | perl wc-lite.pl --lines --words
1	3

$ echo "Hello World Perl" | perl wc-lite.pl --words --chars
3	17

$ echo "Hello World Perl" | perl wc-lite.pl --lines --words --chars
1	3	17
```

## Step 4: å€¤ã‚’å—ã‘å–ã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³

### --output=FILE ã®å®Ÿè£…

çµæœã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã«å‡ºåŠ›ã™ã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ ã—ã¾ã™ã€‚

```perl
#!/usr/bin/env perl
use strict;
use warnings;
use feature 'say';
use Getopt::Long;

my $show_lines = 0;
my $show_words = 0;
my $show_chars = 0;
my $output_file;

GetOptions(
    'lines'    => \$show_lines,
    'words'    => \$show_words,
    'chars'    => \$show_chars,
    'output=s' => \$output_file,
) or die "Error in command line arguments\n";

my $lines = 0;
my $words = 0;
my $chars = 0;

while (my $line = <STDIN>) {
    $lines++;
    $words += scalar(split ' ', $line);
    $chars += length($line);
}

# å‡ºåŠ›æº–å‚™
my @output;
push @output, $lines if $show_lines;
push @output, $words if $show_words;
push @output, $chars if $show_chars;

my $result = join("\t", @output);

# ãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›ã¾ãŸã¯æ¨™æº–å‡ºåŠ›
if (defined $output_file) {
    open my $fh, '>', $output_file or die "Cannot open $output_file: $!\n";
    say $fh $result;
    close $fh;
    say "Result written to $output_file";
} else {
    say $result if @output;
}
```

å‹•ä½œç¢ºèªã‚’ã—ã¾ã™ã€‚

```bash
$ echo "Hello World" | perl wc-lite.pl --lines --output=result.txt
Result written to result.txt

$ cat result.txt
1
```

### =s ã¨ =i ã®ä½¿ã„åˆ†ã‘

ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«å€¤ã‚’å—ã‘å–ã‚‹å ´åˆã€å‹ã‚’æŒ‡å®šã§ãã¾ã™ã€‚

```perl
GetOptions(
    'output=s' => \$output_file,  # =s : æ–‡å­—åˆ—ï¼ˆstringï¼‰
    'count=i'  => \$count,        # =i : æ•´æ•°ï¼ˆintegerï¼‰
    'ratio=f'  => \$ratio,        # =f : æµ®å‹•å°æ•°ç‚¹æ•°ï¼ˆfloatï¼‰
);
```

| æŒ‡å®šå­ | æ„å‘³ | ä¾‹ |
|--------|------|-----|
| `=s` | æ–‡å­—åˆ— | `--output=file.txt` |
| `=i` | æ•´æ•° | `--count=10` |
| `=f` | æµ®å‹•å°æ•°ç‚¹æ•° | `--ratio=0.5` |

### ã‚ªãƒ—ã‚·ãƒ§ãƒ³å‹ã®åˆ†é¡

ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯å¤§ãã2ç¨®é¡ã«åˆ†ã‘ã‚‰ã‚Œã¾ã™ã€‚

```mermaid
flowchart TB
    subgraph Types["ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®ç¨®é¡"]
        direction TB
        Flag["ğŸš© ãƒ•ãƒ©ã‚°å‹<br/>å€¤ãªã—ï¼ˆON/OFFï¼‰"]
        Value["ğŸ“ å€¤ã‚’å—ã‘å–ã‚‹å‹"]
    end
    subgraph FlagEx["ä¾‹: ãƒ•ãƒ©ã‚°å‹"]
        F1["--verbose"]
        F2["--help"]
    end
    subgraph ValueTypes["å€¤ã®å‹"]
        Str["=s æ–‡å­—åˆ—<br/>--output=file.txt"]
        Int["=i æ•´æ•°<br/>--count=10"]
        Flt["=f æµ®å‹•å°æ•°ç‚¹<br/>--ratio=0.5"]
    end
    Flag --> FlagEx
    Value --> ValueTypes
```

## Step 5: ã‚·ãƒ§ãƒ¼ãƒˆã‚ªãƒ—ã‚·ãƒ§ãƒ³

### -l, -w, -c ã‚¨ã‚¤ãƒªã‚¢ã‚¹

é•·ã„ã‚ªãƒ—ã‚·ãƒ§ãƒ³åã ã‘ã§ãªãã€çŸ­ã„ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚‚ä½¿ãˆã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

```perl
#!/usr/bin/env perl
use strict;
use warnings;
use feature 'say';
use Getopt::Long;

my $show_lines = 0;
my $show_words = 0;
my $show_chars = 0;
my $output_file;

GetOptions(
    'lines|l'    => \$show_lines,
    'words|w'    => \$show_words,
    'chars|c'    => \$show_chars,
    'output|o=s' => \$output_file,
) or die "Error in command line arguments\n";

my $lines = 0;
my $words = 0;
my $chars = 0;

while (my $line = <STDIN>) {
    $lines++;
    $words += scalar(split ' ', $line);
    $chars += length($line);
}

# å‡ºåŠ›æº–å‚™
my @output;
push @output, $lines if $show_lines;
push @output, $words if $show_words;
push @output, $chars if $show_chars;

my $result = join("\t", @output);

# ãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›ã¾ãŸã¯æ¨™æº–å‡ºåŠ›
if (defined $output_file) {
    open my $fh, '>', $output_file or die "Cannot open $output_file: $!\n";
    say $fh $result;
    close $fh;
    say "Result written to $output_file";
} else {
    say $result if @output;
}
```

### 'option|alias' è¨˜æ³•

`|`ï¼ˆãƒ‘ã‚¤ãƒ—ï¼‰ã§åŒºåˆ‡ã‚‹ã“ã¨ã§ã€è¤‡æ•°ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³åã‚’åŒã˜å¤‰æ•°ã«ç´ã¥ã‘ã‚‰ã‚Œã¾ã™ã€‚

```perl
'lines|l'     # --lines ã¾ãŸã¯ -l
'output|o=s'  # --output=FILE ã¾ãŸã¯ -o FILE
```

å‹•ä½œç¢ºèªã‚’ã—ã¾ã™ã€‚

```bash
$ echo "Hello World Perl" | perl wc-lite.pl -l -w -c
1	3	17

$ echo "test" | perl wc-lite.pl -lwc
1	1	5
```

ã‚·ãƒ§ãƒ¼ãƒˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯é€£çµã—ã¦`-lwc`ã®ã‚ˆã†ã«æŒ‡å®šã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

## Step 6: ãƒ˜ãƒ«ãƒ—ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸

### --help ã®å®Ÿè£…

ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚³ãƒãƒ³ãƒ‰ã®ä½¿ã„æ–¹ã‚’ç¢ºèªã§ãã‚‹ã‚ˆã†ã€ãƒ˜ãƒ«ãƒ—ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ ã—ã¾ã™ã€‚

```perl
#!/usr/bin/env perl
use strict;
use warnings;
use feature 'say';
use Getopt::Long;

sub show_help {
    print <<'HELP';
Usage: wc-lite.pl [OPTIONS]

Count lines, words, and characters from standard input.

Options:
  -l, --lines        Print the line count
  -w, --words        Print the word count
  -c, --chars        Print the character count
  -o, --output=FILE  Write result to FILE instead of stdout
  -h, --help         Show this help message

Examples:
  echo "Hello World" | perl wc-lite.pl -l
  cat file.txt | perl wc-lite.pl -lwc
  cat file.txt | perl wc-lite.pl --lines --output=result.txt
HELP
    exit 0;
}

my $show_lines = 0;
my $show_words = 0;
my $show_chars = 0;
my $output_file;
my $help = 0;

GetOptions(
    'lines|l'    => \$show_lines,
    'words|w'    => \$show_words,
    'chars|c'    => \$show_chars,
    'output|o=s' => \$output_file,
    'help|h'     => \$help,
) or show_help();

show_help() if $help;

my $lines = 0;
my $words = 0;
my $chars = 0;

while (my $line = <STDIN>) {
    $lines++;
    $words += scalar(split ' ', $line);
    $chars += length($line);
}

# å‡ºåŠ›æº–å‚™
my @output;
push @output, $lines if $show_lines;
push @output, $words if $show_words;
push @output, $chars if $show_chars;

my $result = join("\t", @output);

# ãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›ã¾ãŸã¯æ¨™æº–å‡ºåŠ›
if (defined $output_file) {
    open my $fh, '>', $output_file or die "Cannot open $output_file: $!\n";
    say $fh $result;
    close $fh;
    say "Result written to $output_file";
} else {
    say $result if @output;
}
```

### ä½¿ã„ã‚„ã™ã„ãƒ˜ãƒ«ãƒ—ã®æ›¸ãæ–¹

ãƒ˜ãƒ«ãƒ—ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«ã¯ä»¥ä¸‹ã®è¦ç´ ã‚’å«ã‚ã‚‹ã¨ä½¿ã„ã‚„ã™ããªã‚Šã¾ã™ã€‚

- **Usage**: ã‚³ãƒãƒ³ãƒ‰ã®åŸºæœ¬çš„ãªå‘¼ã³å‡ºã—æ–¹
- **èª¬æ˜**: ã‚³ãƒãƒ³ãƒ‰ã®æ¦‚è¦ï¼ˆ1ã€œ2è¡Œï¼‰
- **Options**: å„ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®èª¬æ˜
- **Examples**: å…·ä½“çš„ãªä½¿ç”¨ä¾‹

ãƒ’ã‚¢ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼ˆ`<<'HELP'`ï¼‰ã‚’ä½¿ã†ã¨ã€è¤‡æ•°è¡Œã®ãƒ†ã‚­ã‚¹ãƒˆã‚’è¦‹ã‚„ã™ãè¨˜è¿°ã§ãã¾ã™ã€‚

## Step 7: ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

### å¿…é ˆå¼•æ•°ã®ãƒã‚§ãƒƒã‚¯

ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒä½•ã‚‚æŒ‡å®šã•ã‚Œã¦ã„ãªã„å ´åˆã«ã‚¨ãƒ©ãƒ¼ã‚’å‡ºã™ã‚ˆã†ã«ã—ã¾ã™ã€‚

```perl
#!/usr/bin/env perl
use strict;
use warnings;
use feature 'say';
use Getopt::Long;

sub show_help {
    print <<'HELP';
Usage: wc-lite.pl [OPTIONS]

Count lines, words, and characters from standard input.

Options:
  -l, --lines        Print the line count
  -w, --words        Print the word count
  -c, --chars        Print the character count
  -o, --output=FILE  Write result to FILE instead of stdout
  -h, --help         Show this help message

Examples:
  echo "Hello World" | perl wc-lite.pl -l
  cat file.txt | perl wc-lite.pl -lwc
  cat file.txt | perl wc-lite.pl --lines --output=result.txt
HELP
    exit 0;
}

sub show_error {
    my ($message) = @_;
    warn "Error: $message\n";
    warn "Use --help for usage information.\n";
    exit 1;
}

my $show_lines = 0;
my $show_words = 0;
my $show_chars = 0;
my $output_file;
my $help = 0;

GetOptions(
    'lines|l'    => \$show_lines,
    'words|w'    => \$show_words,
    'chars|c'    => \$show_chars,
    'output|o=s' => \$output_file,
    'help|h'     => \$help,
) or show_error("Invalid option");

show_help() if $help;

# å¿…é ˆãƒã‚§ãƒƒã‚¯: å°‘ãªãã¨ã‚‚1ã¤ã®ã‚«ã‚¦ãƒ³ãƒˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒå¿…è¦
unless ($show_lines || $show_words || $show_chars) {
    show_error("At least one of -l, -w, -c is required");
}

my $lines = 0;
my $words = 0;
my $chars = 0;

while (my $line = <STDIN>) {
    $lines++;
    $words += scalar(split ' ', $line);
    $chars += length($line);
}

# å‡ºåŠ›æº–å‚™
my @output;
push @output, $lines if $show_lines;
push @output, $words if $show_words;
push @output, $chars if $show_chars;

my $result = join("\t", @output);

# ãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›ã¾ãŸã¯æ¨™æº–å‡ºåŠ›
if (defined $output_file) {
    open my $fh, '>', $output_file or die "Cannot open $output_file: $!\n";
    say $fh $result;
    close $fh;
    say "Result written to $output_file";
} else {
    say $result if @output;
}
```

### ä¸æ­£ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¸ã®å¯¾å¿œ

`GetOptions`ã¯ä¸æ­£ãªã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒæŒ‡å®šã•ã‚Œã‚‹ã¨å½ã‚’è¿”ã—ã¾ã™ã€‚

```bash
$ echo "test" | perl wc-lite.pl --invalid
Error: Invalid option
Use --help for usage information.

$ echo "test" | perl wc-lite.pl
Error: At least one of -l, -w, -c is required
Use --help for usage information.
```

ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯æ¨™æº–ã‚¨ãƒ©ãƒ¼å‡ºåŠ›ï¼ˆ`warn`ï¼‰ã«å‡ºåŠ›ã—ã€æ¨™æº–å‡ºåŠ›ã‚’æ±šã•ãªã„ã‚ˆã†ã«ã—ã¾ã™ã€‚

## å®Œæˆã‚³ãƒ¼ãƒ‰

### å…¨ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰

```perl
#!/usr/bin/env perl
use strict;
use warnings;
use feature 'say';
use Getopt::Long;

sub show_help {
    print <<'HELP';
Usage: wc-lite.pl [OPTIONS]

Count lines, words, and characters from standard input.

Options:
  -l, --lines        Print the line count
  -w, --words        Print the word count
  -c, --chars        Print the character count
  -o, --output=FILE  Write result to FILE instead of stdout
  -h, --help         Show this help message

Examples:
  echo "Hello World" | perl wc-lite.pl -l
  cat file.txt | perl wc-lite.pl -lwc
  cat file.txt | perl wc-lite.pl --lines --output=result.txt
HELP
    exit 0;
}

sub show_error {
    my ($message) = @_;
    warn "Error: $message\n";
    warn "Use --help for usage information.\n";
    exit 1;
}

my $show_lines = 0;
my $show_words = 0;
my $show_chars = 0;
my $output_file;
my $help = 0;

GetOptions(
    'lines|l'    => \$show_lines,
    'words|w'    => \$show_words,
    'chars|c'    => \$show_chars,
    'output|o=s' => \$output_file,
    'help|h'     => \$help,
) or show_error("Invalid option");

show_help() if $help;

unless ($show_lines || $show_words || $show_chars) {
    show_error("At least one of -l, -w, -c is required");
}

my $lines = 0;
my $words = 0;
my $chars = 0;

while (my $line = <STDIN>) {
    $lines++;
    $words += scalar(split ' ', $line);
    $chars += length($line);
}

my @output;
push @output, $lines if $show_lines;
push @output, $words if $show_words;
push @output, $chars if $show_chars;

my $result = join("\t", @output);

if (defined $output_file) {
    open my $fh, '>', $output_file or die "Cannot open $output_file: $!\n";
    say $fh $result;
    close $fh;
    say "Result written to $output_file";
} else {
    say $result;
}
```

### å‹•ä½œç¢ºèªä¾‹

```bash
# è¡Œæ•°ã®ã‚«ã‚¦ãƒ³ãƒˆ
$ echo -e "Line 1\nLine 2\nLine 3" | perl wc-lite.pl -l
3

# å˜èªæ•°ã®ã‚«ã‚¦ãƒ³ãƒˆ
$ echo "Perl is a powerful language" | perl wc-lite.pl -w
5

# å…¨ã¦ã®ã‚«ã‚¦ãƒ³ãƒˆ
$ echo "Hello World" | perl wc-lite.pl -lwc
1	2	12

# ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®å‡ºåŠ›
$ cat /etc/passwd | perl wc-lite.pl -l --output=count.txt
Result written to count.txt

# ãƒ˜ãƒ«ãƒ—ã®è¡¨ç¤º
$ perl wc-lite.pl --help
Usage: wc-lite.pl [OPTIONS]
...
```

## ã¾ã¨ã‚

### ç¿’å¾—ã—ãŸã‚¹ã‚­ãƒ«

ã“ã®è¨˜äº‹ã‚’é€šã˜ã¦ã€ä»¥ä¸‹ã®ã‚¹ã‚­ãƒ«ã‚’ç¿’å¾—ã—ã¾ã—ãŸã€‚

- **Getopt::Longã®åŸºæœ¬**: `use Getopt::Long`ã¨`GetOptions`é–¢æ•°
- **ãƒ•ãƒ©ã‚°ã‚ªãƒ—ã‚·ãƒ§ãƒ³**: `'verbose' => \$flag`ã®å½¢å¼
- **å€¤ã‚’å—ã‘å–ã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³**: `'output=s'`ï¼ˆæ–‡å­—åˆ—ï¼‰ã€`'count=i'`ï¼ˆæ•´æ•°ï¼‰
- **ã‚·ãƒ§ãƒ¼ãƒˆã‚ªãƒ—ã‚·ãƒ§ãƒ³**: `'lines|l'`ã®ã‚¨ã‚¤ãƒªã‚¢ã‚¹è¨˜æ³•
- **ãƒ˜ãƒ«ãƒ—ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸**: ãƒ’ã‚¢ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ä½¿ã£ãŸä½¿ã„ã‚„ã™ã„ãƒ˜ãƒ«ãƒ—
- **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: ä¸æ­£ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¨å¿…é ˆå¼•æ•°ã®ãƒã‚§ãƒƒã‚¯

### æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

Getopt::Longã«ã¯ã€ã“ã®è¨˜äº‹ã§ç´¹ä»‹ã—ãŸä»¥å¤–ã«ã‚‚å¤šãã®æ©Ÿèƒ½ãŒã‚ã‚Šã¾ã™ã€‚

- **é…åˆ—ã‚ªãƒ—ã‚·ãƒ§ãƒ³**: è¤‡æ•°å›æŒ‡å®šã§ãã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼ˆ`--include=dir1 --include=dir2`ï¼‰
- **ãƒãƒƒã‚·ãƒ¥ã‚ªãƒ—ã‚·ãƒ§ãƒ³**: ã‚­ãƒ¼ã¨å€¤ã®ãƒšã‚¢ï¼ˆ`--define=DEBUG=1`ï¼‰
- **å¦å®šã‚ªãƒ—ã‚·ãƒ§ãƒ³**: `--no-verbose`ã®ã‚ˆã†ãªå¦å®šå½¢
- **ã‚µãƒ–ã‚³ãƒãƒ³ãƒ‰**: `git add`ã®ã‚ˆã†ãªã‚µãƒ–ã‚³ãƒãƒ³ãƒ‰ãƒ‘ã‚¿ãƒ¼ãƒ³

ã“ã‚Œã‚‰ã®å¿œç”¨çš„ãªå†…å®¹ã¯ã€ä»¥ä¸‹ã®è¨˜äº‹ã§è©³ã—ãè§£èª¬ã—ã¦ã„ã¾ã™ã€‚

{{< linkcard "/2025/12/21/000000/" >}}

Getopt::Longã‚’ä½¿ã„ã“ãªã›ã°ã€ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãªã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ãƒ„ãƒ¼ãƒ«ã‚’ç°¡å˜ã«ä½œæˆã§ãã¾ã™ã€‚ãœã²è‡ªåˆ†ã ã‘ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½œã£ã¦ã¿ã¦ãã ã•ã„ã€‚
