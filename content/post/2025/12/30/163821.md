---
title: 'PerlでTODOリスト（CLI）を作成する - 第1回: TODOリストアプリを作ろう - 完成イメージと設計'
draft: true
tags:
  - perl
  - cli
  - todo-app
description: PerlでCLIベースのTODOリストアプリを作る連載の第1回。完成形のデモと、メニュー形式のCLI UIを設計します。while無限ループを使ったアプリの基本構造も紹介します。
---

[@nqounet](https://x.com/nqounet)です。

「PerlでTODOリスト（CLI）を作成する」シリーズの第1回です。

この連載では、Perl入学式を卒業した方を対象に、実践的なCLIアプリケーションを一から作り上げていきます。変数、配列、ハッシュ、サブルーチン、正規表現といった基本は既に習得している前提で進めます。

## 連載の全体像

この連載は全10回を予定しています。

| 回 | タイトル | 主要テーマ |
|:--:|:---------|:-----------|
| 1 | TODOリストアプリを作ろう - 完成イメージと設計 | アプリ設計 |
| 2 | タスクの追加と一覧表示 | 配列操作 |
| 3 | タスクの削除と完了マーク | 配列の削除・更新 |
| 4 | データの永続化 - ファイル保存 | ファイル入出力 |
| 5 | cpanfileで依存モジュール管理 | Carton / cpanfile |
| 6 | コマンドライン引数の処理 | Getopt::Long |
| 7 | エラーハンドリング | Try::Tiny |
| 8 | データベースへの移行 | DBI / SQLite |
| 9 | テストコードの追加 | Test::More |
| 10 | 完成版のリファクタリング | コード整理 |

各回で1つの新しい概念を学びながら、最終的には実用的なTODOリストアプリを完成させます。

## 今回のゴール

今回は、以下の2点を達成します。

- 完成形のTODOリストアプリがどのように動作するかを理解する
- メニュー形式のCLI UIの基本構造を設計する

## 完成形の使用イメージ

まずは、最終的に完成するTODOリストアプリの動作イメージを見てみましょう。

```text
$ perl todo.pl

=== TODO リスト ===

1. [ ] 牛乳を買う
2. [x] メールを送る
3. [ ] レポートを書く

----------------------
メニュー:
  a: タスク追加
  d: タスク削除
  c: 完了/未完了の切り替え
  q: 終了
----------------------
選択してください > a

タスク名を入力してください > Perlの勉強

タスク「Perlの勉強」を追加しました

=== TODO リスト ===

1. [ ] 牛乳を買う
2. [x] メールを送る
3. [ ] レポートを書く
4. [ ] Perlの勉強

----------------------
メニュー:
  a: タスク追加
  d: タスク削除
  c: 完了/未完了の切り替え
  q: 終了
----------------------
選択してください > q

終了します。お疲れ様でした！
```

このように、ユーザーはメニューから操作を選び、タスクを追加・削除・完了できます。シンプルですが、実用的なアプリケーションです。

## アプリの基本構造

CLI（Command Line Interface）アプリの基本は「無限ループ」です。ユーザーが終了を選択するまで、以下のサイクルを繰り返します。

1. 現在の状態を表示する
2. メニューを表示する
3. ユーザーの入力を待つ
4. 入力に応じた処理を実行する
5. 1に戻る

この構造を`while`ループで実装すると、以下のようになります。

```perl
#!/usr/bin/env perl
use strict;
use warnings;
use utf8;
use open ':std', ':encoding(UTF-8)';

# メインループ
while (1) {
    # 1. タスク一覧を表示
    show_tasks();

    # 2. メニューを表示
    show_menu();

    # 3. ユーザー入力を取得
    print "選択してください > ";
    my $input = <STDIN>;
    chomp $input;

    # 4. 入力に応じた処理
    if ($input eq 'a') {
        add_task();
    }
    elsif ($input eq 'd') {
        delete_task();
    }
    elsif ($input eq 'c') {
        toggle_task();
    }
    elsif ($input eq 'q') {
        print "終了します。お疲れ様でした！\n";
        last;  # ループを抜ける
    }
    else {
        print "不明なコマンドです: $input\n";
    }
}

# サブルーチンは次回以降で実装
sub show_tasks  { print "=== TODO リスト ===\n\n"; }
sub show_menu   { print "メニュー: a:追加 d:削除 c:切替 q:終了\n"; }
sub add_task    { print "（追加処理は次回実装）\n"; }
sub delete_task { print "（削除処理は次回実装）\n"; }
sub toggle_task { print "（切替処理は次回実装）\n"; }
```

このコードのポイントは以下の通りです。

- `while (1)`で無限ループを作成する
- `last`でループを抜ける（終了処理）
- 各機能はサブルーチンに分離する（今回はスタブ実装）
- `chomp`で改行を除去する

## CLI UI設計のポイント

メニュー形式のCLI UIを設計する際のポイントをまとめます。

- **一文字コマンド**: `a`, `d`, `c`, `q` のように、よく使う操作は一文字で入力できるようにする
- **明確なプロンプト**: ユーザーが何を入力すべきか分かるように `>` などのプロンプトを表示する
- **フィードバック**: 操作の結果をユーザーに伝える（例: 「タスクを追加しました」）
- **状態の表示**: 操作の前後で現在の状態（タスク一覧）を表示する
- **エラーメッセージ**: 不正な入力に対しては分かりやすいエラーメッセージを表示する

## 関連リンク

この連載で使用するモジュールや技術について、詳しくは以下の記事も参考にしてください。

- [Perlでのコマンドライン引数処理 - Getopt::Long](/2025/12/21/000000/)
- [Perlのエラー処理 - Try::Tiny](/2025/12/14/000000/)
- [Perlでのデータベース操作 — DBI / DBIx::Class 入門](/2025/12/13/000000/)
- [Carton/cpanfileによる依存管理](/2025/12/10/000000/)
- [PerlのCPANモジュール20選](/2025/12/03/041603/)

## まとめ

- TODOリストアプリは、タスクの追加・削除・完了マークができるシンプルなCLIアプリである
- CLIアプリの基本構造は`while`無限ループである
- メニュー形式のUIは、一文字コマンドと明確なフィードバックがポイントである
- 各機能はサブルーチンに分離して、段階的に実装していく

## 次回予告

次回は、タスクの追加と一覧表示を実装します。配列を使ってタスクを管理し、実際に動作するTODOリストの第一歩を踏み出しましょう。お楽しみに！
