---
title: "高度なログ検索とフィルタリング：git log の全潜在能力を引き出す"
draft: true
tags:
- "git"
- "git-log"
- "productivity"
- "code-archaeology"
- "best-practices"
description: "gitログを自在に操り必要な情報を瞬時に取り出す技術。日付範囲、作者、ファイルパス、コミットメッセージでのフィルタリングから、グラフ表示、カスタムフォーマット、統計情報の抽出まで、git logの真の力を解放する完全ガイドです。"
---

## git log の基本を超えて

`git log`は単なる履歴表示ツールではありません。適切なオプションを使えば、プロジェクトの状況把握、バグ追跡、コントリビューター分析など、様々な情報を引き出せる強力なツールです。

### よく使う基本オプションのおさらい

```bash
# シンプルなログ表示
git log

# 1行表示
git log --oneline

# 詳細情報（diff付き）
git log -p

# 最新5件
git log -5
```

ここから先は、さらに高度な使い方を見ていきます。

## フィルタリングで目的のコミットを探す

### --author, --committer で人を絞る

```bash
# 特定の作者のコミットのみ
git log --author="John Doe"

# 部分一致でも可
git log --author="John"

# 複数の作者（正規表現）
git log --author="John\|Jane"

# コミッター（通常は作者と同じだが、cherry-pickやrebaseで異なる場合も）
git log --committer="Jane"
```

### --since, --until で期間指定

```bash
# 特定の日付以降
git log --since="2023-12-01"

# 相対的な期間
git log --since="2 weeks ago"
git log --since="1 month ago"
git log --since="yesterday"

# 期間を範囲で指定
git log --since="2023-11-01" --until="2023-11-30"

# より詳細な時刻指定
git log --since="2023-12-01 09:00:00" --until="2023-12-01 17:00:00"
```

### --grep でメッセージ検索

```bash
# コミットメッセージに"fix"を含む
git log --grep="fix"

# 大文字小文字を区別しない
git log --grep="FIX" -i

# 複数条件（OR検索）
git log --grep="fix" --grep="bug"

# AND検索
git log --grep="fix" --grep="auth" --all-match

# 正規表現
git log --grep="^feat:" --grep="^fix:"
```

### -- <path> でファイル・ディレクトリ指定

```bash
# 特定ファイルの変更履歴
git log -- src/app.js

# ディレクトリ全体
git log -- src/components/

# 複数ファイル
git log -- src/app.js src/utils.js

# パターンマッチ
git log -- "*.js"
git log -- "src/**/*.test.js"
```

`--`は、ファイル名とブランチ名の区別のために使います。

## グラフとビジュアライゼーション

### --graph --oneline --decorate

最も人気のある組み合わせ：

```bash
git log --graph --oneline --decorate

# 出力例
* abc1234 (HEAD -> main, origin/main) feat: 新機能追加
* def5678 fix: バグ修正
|\
| * ghi9012 (feature/auth) feat: 認証機能
|/
* jkl3456 docs: ドキュメント更新
```

グラフでブランチの分岐・マージが視覚化されます。

### --all で全ブランチを表示

```bash
# 全ブランチ・全タグを表示
git log --graph --oneline --all

# リモートブランチも含む
git log --graph --oneline --all --remotes
```

プロジェクト全体の構造を把握できます。

### カラー出力

```bash
# カラー表示（デフォルト有効）
git log --graph --oneline --decorate --color

# 色を無効化（パイプやファイル出力時）
git log --no-color
```

## カスタムフォーマットで見やすく

### --pretty=format の活用

自分好みのフォーマットを定義できます。

```bash
# 基本的なカスタムフォーマット
git log --pretty=format:"%h - %an, %ar : %s"

# 出力例
abc1234 - John Doe, 2 days ago : feat: 新機能追加
def5678 - Jane Smith, 1 week ago : fix: バグ修正
```

主なプレースホルダー：

| プレースホルダー | 内容 |
|---------------|------|
| `%H` | コミットハッシュ（完全） |
| `%h` | コミットハッシュ（短縮） |
| `%an` | 作者名 |
| `%ae` | 作者メール |
| `%ad` | 作者日時 |
| `%ar` | 作者日時（相対） |
| `%cn` | コミッター名 |
| `%s` | コミットメッセージ（件名） |
| `%b` | コミットメッセージ（本文） |

### --date オプションでの日付形式変更

```bash
# ISO 8601形式
git log --date=iso

# RFC 2822形式
git log --date=rfc

# 相対時間
git log --date=relative

# Unix timestamp
git log --date=unix

# 短縮形式
git log --date=short  # YYYY-MM-DD

# カスタムフォーマット
git log --date=format:"%Y-%m-%d %H:%M"
```

### 実用的なフォーマット例

```bash
# チェンジログ風
git log --pretty=format:"* %s (%h) - %an" --since="1 month ago"

# 詳細な開発ログ
git log --pretty=format:"%C(yellow)%h%Creset %C(blue)%ad%Creset %C(green)%an%Creset: %s" --date=short

# JSON形式（スクリプトでの処理用）
git log --pretty=format:'{"commit": "%H", "author": "%an", "date": "%ad", "message": "%s"},' --date=iso
```

## 統計とサマリー

### --shortstat, --numstat

コミットごとの変更量を表示します。

```bash
# 簡潔な統計
git log --shortstat

# 出力例
commit abc1234
Author: John Doe
Date: Mon Dec 4 10:30:00 2023

    feat: 新機能追加

 3 files changed, 45 insertions(+), 10 deletions(-)

# 詳細な統計（ファイルごと）
git log --numstat

# 出力例
10      5       src/app.js
20      3       src/utils.js
15      2       tests/app.test.js
```

### git shortlog でコントリビューター一覧

```bash
# 作者ごとのコミット数
git shortlog -s -n

# 出力例
   150  John Doe
    85  Jane Smith
    42  Bob Johnson

# コミットメッセージ付き
git shortlog

# メールアドレスも表示
git shortlog -s -n -e
```

プロジェクトの貢献者を把握できます。

## 高度な検索テクニック

### --all-match で複数条件のAND検索

```bash
# "fix"かつ"auth"を含むコミット
git log --grep="fix" --grep="auth" --all-match

# 特定の作者かつ特定のファイル
git log --author="John" --all-match -- src/app.js
```

### --invert-grep で除外検索

```bash
# "WIP"を含まないコミット
git log --grep="WIP" --invert-grep

# "Merge"を除外
git log --grep="^Merge" --invert-grep --oneline
```

### --no-merges でマージコミットを除外

```bash
# マージコミットを除外
git log --no-merges --oneline

# 逆にマージコミットのみ
git log --merges --oneline
```

### --first-parent でメインラインのみ

```bash
# mainブランチの直系のみ（マージされたブランチのコミットを除外）
git log --first-parent main --oneline
```

リリースノート作成時に便利です。

## 実践的な活用例

### 例1: 先週の自分の作業を振り返る

```bash
git log --author="$(git config user.name)" \
  --since="1 week ago" \
  --pretty=format:"%ad %s" \
  --date=short
```

### 例2: 特定機能のリリースノート作成

```bash
git log v1.0.0..v1.1.0 \
  --pretty=format:"- %s (%h)" \
  --no-merges \
  --grep="^feat:" \
  --grep="^fix:"
```

### 例3: コードレビュー対象の変更確認

```bash
git log origin/main..HEAD \
  --pretty=format:"%h %s" \
  --reverse
```

### 例4: 大規模な変更があったコミットを検出

```bash
# 100行以上変更されたコミット
git log --shortstat | \
  grep -E "^ \d+ files? changed, \d{3,} insertion" -B 5
```

### 例5: 特定のバグが混入した期間を絞る

```bash
# bisectと組み合わせる前の調査
git log --since="2023-11-01" --until="2023-11-30" \
  --grep="auth" \
  --oneline
```

## エイリアスで効率化

よく使うコマンドは`.gitconfig`にエイリアスとして登録しましょう。

```bash
# エイリアス設定
git config --global alias.lg "log --graph --oneline --decorate --all"
git config --global alias.last "log -1 HEAD --stat"
git config --global alias.today "log --since='yesterday' --author='$(git config user.name)' --oneline"
git config --global alias.changelog "log --pretty=format:'* %s (%h)' --no-merges"

# 使用例
git lg
git today
git changelog v1.0.0..v1.1.0
```

### 高度なエイリアス例

```bash
# 美しいグラフ表示
git config --global alias.tree "log --graph --pretty=format:'%C(yellow)%h%Creset%C(auto)%d%Creset %s %C(green)(%cr) %C(bold blue)<%an>%Creset' --abbrev-commit --all"

# コントリビューター統計
git config --global alias.contributors "shortlog -s -n"

# ファイルごとの変更頻度
git config --global alias.hotspots "log --pretty=format: --name-only | sort | uniq -c | sort -rg | head -10"
```

## トラブルシューティング

### ログが長すぎる場合

```bash
# ページャーを無効化
git --no-pager log --oneline

# 件数制限
git log -20 --oneline

# ファイルに出力
git log --oneline > commits.txt
```

### 文字化けする場合

```bash
# エンコーディング指定
git -c core.quotepath=false log --oneline

# 日本語の文字化け対策
git config --global core.quotepath false
```

## まとめ

`git log`の活用テクニック：

- **フィルタリング**: `--author`, `--since`, `--grep`, `-- <path>`
- **ビジュアル**: `--graph --oneline --all`
- **カスタムフォーマット**: `--pretty=format`
- **統計**: `--shortstat`, `shortlog`
- **高度な検索**: `--all-match`, `--invert-grep`, `--no-merges`

これらを使いこなせば、数千のコミットから瞬時に必要な情報を取り出せます。エイリアスを設定して、日々の開発に組み込んでいきましょう！
