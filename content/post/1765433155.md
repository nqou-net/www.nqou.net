---
title: "GitHub Copilot エージェントパネル入門 - 第10回: 実践パターン集（ドキュメント生成）"
description: "コードと常に同期した高品質なドキュメントを自動生成。README、APIドキュメント、コメント、変更履歴の自動作成を実践"
date: 2025-12-11T15:00:00+09:00
draft: true
tags:
  - GitHub
  - Copilot
  - Agent Panel
  - ドキュメント
  - 自動生成
image: /favicon.png
---

## はじめに

[@nqounet](https://x.com/nqounet)です。

第10回では、ドキュメント生成の実践パターンを学びます。コードと常に同期した、高品質なドキュメントを自動生成する方法を解説します。

## READMEの自動生成

### README生成エージェント

```yaml
---
name: readme-generator
version: 2.0.0

parameters:
  - name: projectType
    type: string
    options: ["library", "application", "cli-tool"]
  
  - name: includeExamples
    type: boolean
    default: true
  
  - name: badgeStyle
    type: string
    default: "flat-square"
    options: ["flat", "flat-square", "plastic"]

workflow:
  steps:
    # 1. プロジェクト情報を収集
    - agent: project-analyzer
      output: project_info
    
    # 2. コード例を抽出
    - agent: example-extractor
      input: "${project_info}"
      output: code_examples
    
    # 3. README生成
    - agent: readme-writer
      input:
        project: "${project_info}"
        examples: "${code_examples}"
      output: readme_content
    
    # 4. バッジとメタデータ追加
    - agent: metadata-enricher
      input: "${readme_content}"
      output: final_readme
---

# README Generator

## プロジェクト情報の分析

### 収集する情報
1. **基本情報**
   - プロジェクト名
   - 説明
   - バージョン
   - ライセンス

2. **技術スタック**
   - 言語とバージョン
   - フレームワーク
   - 主要な依存関係

3. **機能**
   - エクスポートされた関数/クラス
   - CLIコマンド
   - API エンドポイント

4. **設定**
   - 環境変数
   - 設定ファイル

## README テンプレート

### ライブラリプロジェクト
\`\`\`markdown
# ${project.name}

${badges}

${project.description}

## Features

${features}

## Installation

\`\`\`bash
npm install ${project.name}
\`\`\`

## Quick Start

\`\`\`${project.language}
${quickstart_example}
\`\`\`

## API Reference

${api_documentation}

## Examples

${detailed_examples}

## Configuration

${configuration_guide}

## Contributing

${contributing_guide}

## License

${license}
\`\`\`

### アプリケーションプロジェクト
\`\`\`markdown
# ${project.name}

${badges}

${project.description}

## Prerequisites

${prerequisites}

## Installation

${installation_steps}

## Usage

${usage_guide}

## Configuration

${configuration}

## Deployment

${deployment_guide}

## Development

${development_guide}

## License

${license}
\`\`\`
```

### 実装例

```typescript
// readme-writer.agent.ts
interface ProjectInfo {
  name: string;
  description: string;
  version: string;
  language: string;
  dependencies: Dependency[];
  exports: Export[];
}

async function generateReadme(
  projectInfo: ProjectInfo,
  examples: CodeExample[]
): Promise<string> {
  // バッジ生成
  const badges = generateBadges(projectInfo);
  
  // 機能リスト生成
  const features = extractFeatures(projectInfo.exports);
  
  // クイックスタート例
  const quickStart = generateQuickStart(projectInfo);
  
  // API ドキュメント
  const apiDocs = generateAPIDocs(projectInfo.exports);
  
  // 詳細な例
  const detailedExamples = formatExamples(examples);
  
  return `
# ${projectInfo.name}

${badges}

${projectInfo.description}

## Features

${features}

## Installation

\`\`\`bash
npm install ${projectInfo.name}
\`\`\`

## Quick Start

\`\`\`typescript
${quickStart}
\`\`\`

## API Reference

${apiDocs}

## Examples

${detailedExamples}
`;
}
```

## APIドキュメントの生成

### API ドキュメント生成エージェント

```yaml
---
name: api-doc-generator
version: 2.0.0

parameters:
  - name: format
    type: string
    default: "markdown"
    options: ["markdown", "openapi", "swagger"]
  
  - name: includeExamples
    type: boolean
    default: true

workflow:
  steps:
    # 1. コードから API を抽出
    - agent: api-extractor
      input: "${source_files}"
      output: api_definitions
    
    # 2. 型情報を解析
    - agent: type-analyzer
      input: "${api_definitions}"
      output: type_info
    
    # 3. 使用例を生成
    - condition:
        if: "${parameters.includeExamples} == true"
        then:
          - agent: example-generator
            input: "${api_definitions}"
            output: examples
    
    # 4. ドキュメント生成
    - agent: api-doc-formatter
      input:
        apis: "${api_definitions}"
        types: "${type_info}"
        examples: "${examples}"
      parameters:
        format: "${parameters.format}"
      output: api_documentation
---

# API Documentation Generator

## API 定義の抽出

### TypeScript の場合
\`\`\`typescript
// Input: src/api.ts
/**
 * ユーザー情報を取得
 * @param userId - ユーザーID
 * @returns ユーザー情報
 */
export async function getUser(userId: string): Promise<User> {
  // implementation
}

interface User {
  id: string;
  name: string;
  email: string;
}
\`\`\`

### 抽出される情報
\`\`\`json
{
  "function": "getUser",
  "description": "ユーザー情報を取得",
  "parameters": [
    {
      "name": "userId",
      "type": "string",
      "description": "ユーザーID"
    }
  ],
  "returnType": {
    "type": "Promise<User>",
    "description": "ユーザー情報"
  }
}
\`\`\`

## 生成されるドキュメント

### Markdown 形式
\`\`\`markdown
## getUser(userId)

ユーザー情報を取得します。

### Parameters

| Name | Type | Description |
|------|------|-------------|
| userId | string | ユーザーID |

### Returns

\`Promise<User>\` - ユーザー情報

### Example

\`\`\`typescript
const user = await getUser('user123');
console.log(user.name);
\`\`\`

### Related Types

#### User
\`\`\`typescript
interface User {
  id: string;
  name: string;
  email: string;
}
\`\`\`
\`\`\`

### OpenAPI 形式
\`\`\`yaml
paths:
  /users/{userId}:
    get:
      summary: ユーザー情報を取得
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: 成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
components:
  schemas:
    User:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        email:
          type: string
\`\`\`
```

## コードコメントの自動追加

### コメント生成エージェント

```yaml
---
name: code-commenter
version: 1.0.0

parameters:
  - name: style
    type: string
    default: "jsdoc"
    options: ["jsdoc", "tsdoc", "docstring", "javadoc"]
  
  - name: verbosity
    type: string
    default: "normal"
    options: ["minimal", "normal", "detailed"]

workflow:
  steps:
    # 1. コメントが欠落している箇所を検出
    - agent: missing-comment-detector
      output: missing_comments
    
    # 2. 各関数/クラスのコメントを生成
    - agent: comment-generator
      input: "${missing_comments}"
      parameters:
        style: "${parameters.style}"
        verbosity: "${parameters.verbosity}"
      output: generated_comments
    
    # 3. コードに挿入
    - agent: comment-inserter
      input: "${generated_comments}"
---

# Code Comment Generator

## JSDoc スタイル

### 関数コメント
\`\`\`typescript
// Before
function calculateDiscount(price, discountRate) {
  return price * (1 - discountRate);
}

// After
/**
 * 割引後の価格を計算します
 * 
 * @param {number} price - 元の価格
 * @param {number} discountRate - 割引率 (0-1の範囲)
 * @returns {number} 割引後の価格
 * @throws {Error} 割引率が範囲外の場合
 * @example
 * calculateDiscount(1000, 0.2); // 800
 */
function calculateDiscount(price: number, discountRate: number): number {
  if (discountRate < 0 || discountRate > 1) {
    throw new Error('Discount rate must be between 0 and 1');
  }
  return price * (1 - discountRate);
}
\`\`\`

### クラスコメント
\`\`\`typescript
// Before
class UserRepository {
  async findById(id) { }
  async save(user) { }
}

// After
/**
 * ユーザー情報を管理するリポジトリクラス
 * 
 * @class UserRepository
 * @description データベースとのやり取りを抽象化し、
 * ユーザー情報のCRUD操作を提供します
 */
class UserRepository {
  /**
   * IDでユーザーを検索
   * 
   * @param {string} id - ユーザーID
   * @returns {Promise<User|null>} ユーザー情報、存在しない場合はnull
   * @async
   */
  async findById(id: string): Promise<User | null> {
    // implementation
  }
  
  /**
   * ユーザー情報を保存
   * 
   * @param {User} user - 保存するユーザー情報
   * @returns {Promise<User>} 保存されたユーザー情報
   * @throws {ValidationError} ユーザー情報が不正な場合
   * @async
   */
  async save(user: User): Promise<User> {
    // implementation
  }
}
\`\`\`

## Python Docstring スタイル

\`\`\`python
# Before
def calculate_discount(price, discount_rate):
    return price * (1 - discount_rate)

# After
def calculate_discount(price: float, discount_rate: float) -> float:
    \"\"\"割引後の価格を計算します。
    
    Args:
        price (float): 元の価格
        discount_rate (float): 割引率 (0-1の範囲)
    
    Returns:
        float: 割引後の価格
    
    Raises:
        ValueError: 割引率が範囲外の場合
    
    Examples:
        >>> calculate_discount(1000, 0.2)
        800.0
    \"\"\"
    if not 0 <= discount_rate <= 1:
        raise ValueError('Discount rate must be between 0 and 1')
    return price * (1 - discount_rate)
\`\`\`
```

## 変更履歴（CHANGELOG）の自動生成

### CHANGELOG 生成エージェント

```yaml
---
name: changelog-generator
version: 2.0.0

parameters:
  - name: format
    type: string
    default: "keepachangelog"
    options: ["keepachangelog", "conventional"]
  
  - name: since
    type: string
    description: "この時点以降の変更を含める"

workflow:
  steps:
    # 1. コミット履歴を取得
    - git:
        command: log
        args:
          - "--pretty=format:%H|%s|%an|%ae|%ad"
          - "${parameters.since}..HEAD"
      output: commit_history
    
    # 2. コミットを分類
    - agent: commit-classifier
      input: "${commit_history}"
      output: classified_commits
    
    # 3. CHANGELOG 生成
    - agent: changelog-formatter
      input: "${classified_commits}"
      parameters:
        format: "${parameters.format}"
      output: changelog
---

# CHANGELOG Generator

## Conventional Commits の分類

### コミットメッセージの解析
\`\`\`
feat(auth): add OAuth2 support
fix(api): handle null response correctly
docs: update API documentation
refactor(core): simplify error handling
perf(db): optimize query performance
test: add integration tests
\`\`\`

### 分類結果
\`\`\`json
{
  "features": [
    "add OAuth2 support"
  ],
  "fixes": [
    "handle null response correctly"
  ],
  "documentation": [
    "update API documentation"
  ],
  "refactoring": [
    "simplify error handling"
  ],
  "performance": [
    "optimize query performance"
  ],
  "tests": [
    "add integration tests"
  ]
}
\`\`\`

## 生成される CHANGELOG

### Keep a Changelog 形式
\`\`\`markdown
# Changelog

All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/),
and this project adheres to [Semantic Versioning](https://semver.org/).

## [Unreleased]

### Added
- OAuth2 support for authentication
- Integration tests for API endpoints

### Changed
- Simplified error handling in core module

### Fixed
- Handle null response correctly in API layer

### Performance
- Optimized database query performance

### Documentation
- Updated API documentation

## [2.1.0] - 2025-12-10

### Added
- User profile management
- Email notification system

### Fixed
- Memory leak in background worker
- Race condition in cache invalidation
\`\`\`
```

## ドキュメントの継続的な更新

### 自動更新ワークフロー

```yaml
---
name: doc-auto-updater
version: 1.0.0

trigger:
  events:
    - push
    - pull_request
  paths:
    - "src/**"
    - "lib/**"

workflow:
  steps:
    # 1. 変更されたファイルを検出
    - git:
        command: diff
        args: ["--name-only", "HEAD~1"]
      output: changed_files
    
    # 2. 影響を受けるドキュメントを特定
    - agent: doc-dependency-analyzer
      input: "${changed_files}"
      output: affected_docs
    
    # 3. ドキュメントを再生成
    - type: parallel
      steps:
        - condition:
            if: "'README.md' in ${affected_docs}"
            then:
              - agent: readme-generator
        
        - condition:
            if: "'API.md' in ${affected_docs}"
            then:
              - agent: api-doc-generator
        
        - condition:
            if: "'CHANGELOG.md' in ${affected_docs}"
            then:
              - agent: changelog-generator
    
    # 4. 変更をコミット
    - git:
        command: add
        args: ["README.md", "API.md", "CHANGELOG.md"]
    
    - git:
        command: commit
        args:
          - "-m"
          - "docs: auto-update documentation"
    
    - git:
        command: push
---
```

## 動作確認チェックリスト

- [ ] README を自動生成した
- [ ] API ドキュメントを生成した
- [ ] コードコメントを自動追加した
- [ ] CHANGELOG を自動生成した
- [ ] ドキュメント自動更新を設定した
- [ ] 複数のフォーマットに対応した

## 次回予告

第11回では、テスト生成と品質管理の実践パターンを学びます：

- ユニットテストの自動生成
- テストカバレッジの向上
- E2Eテストの生成
- 品質メトリクスの追跡

## まとめ

この記事では、ドキュメント生成の実践パターンを学びました：

1. **README 自動生成**
   - プロジェクト情報の収集
   - テンプレートベースの生成

2. **API ドキュメント**
   - コードから API を抽出
   - 複数フォーマット対応

3. **コードコメント**
   - JSDoc/Docstring の自動生成
   - 欠落箇所の検出と補完

4. **変更履歴**
   - コミット履歴からCHANGELOG生成
   - Conventional Commits 対応

次回は、テスト生成を自動化し、高品質なコードベースを維持する方法を学びます！
