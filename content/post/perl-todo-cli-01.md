---
title: "第1回-TODOリストアプリを作ろう - シンプルなTodo CLIアプリ"
draft: true
tags:
  - perl
  - cli
  - moo
  - todo-app
description: "PerlでシンプルなTODOリストCLIアプリを作る連載開始。完成形の実行例を見ながら、Mooを使ったTodoAppクラスの設計方針を解説します。"
---

[@nqounet](https://x.com/nqounet)です。

「シンプルなTodo CLIアプリ」シリーズを開始します。この連載では、PerlでTODOリストを管理するCLIアプリケーションを一から作成していきます。

## このシリーズについて

このシリーズは「Mooで覚えるオブジェクト指向プログラミング」シリーズを読了した方を対象としています。Mooで学んだクラス設計のスキルを活かして、実用的なCLIアプリケーションを作成します。

{{< linkcard "/2025/12/30/163820/" >}}

前シリーズで作成した掲示板アプリでは、User/Message/Boardクラスを設計しました。本連載では同様のアプローチで、TodoApp/Taskクラスを設計し、データベース操作やコマンドライン処理を実装していきます。

## 完成イメージ

まずは、連載を通じて作成するアプリケーションの完成形を見てみましょう。

```text
# 実行例（最終的な完成形）
# Perl 5.40+, Moo, DBI, DBD::SQLite, Getopt::Long

$ perl todo.pl add "牛乳を買う"
Added: [1] 牛乳を買う

$ perl todo.pl add "レポートを書く"
Added: [2] レポートを書く

$ perl todo.pl list
[ ] 1. 牛乳を買う
[ ] 2. レポートを書く

$ perl todo.pl done 1
Done: [1] 牛乳を買う

$ perl todo.pl list
[x] 1. 牛乳を買う
[ ] 2. レポートを書く

$ perl todo.pl list --pending
[ ] 2. レポートを書く

$ perl todo.pl rm 1
Deleted: [1] 牛乳を買う

$ perl todo.pl list
[ ] 2. レポートを書く
```

`add`、`list`、`done`、`rm`の4つのサブコマンドでタスクを管理できるシンプルなツールです。コマンドライン引数でサクサク操作できるのが特徴です。

この連載では、最初は対話形式のメニューUIから始めて、最終回でこのサブコマンド形式に進化させます。

## 設計方針：TodoAppクラスの骨格

Mooシリーズで学んだように、まずはクラスの設計から始めます。TODOアプリに必要なクラスを考えてみましょう。

- **TodoApp**: アプリケーション全体を管理するクラス
- **Task**: 個々のタスクを表すクラス（後の回で作成）

今回は、TodoAppクラスの骨格を設計します。

```perl
# lib/TodoApp.pm
# Perl 5.40+
# 外部依存: Moo

package TodoApp;
use Moo;

# タスクの一覧を保持する属性
has tasks => (
    is      => 'rw',
    default => sub { [] },
);

# アプリケーションを実行するメソッド
sub run {
    my $self = shift;
    # メニューを表示して、ユーザーの入力を待つ
    # （次回以降で実装）
}

1;
```

`has tasks`で、タスクの一覧を配列リファレンスとして保持します。`default => sub { [] }`は、初期値として空の配列を設定するイディオムです。

Mooシリーズで学んだ`has`を使って状態を管理し、`sub`でメソッドを定義する。この基本パターンは掲示板アプリと同じです。

## Commandパターンへの伏線

ここで、設計思考について少しお話しします。

完成形では「add」「list」「done」「rm」という4つのサブコマンドがあります。ユーザーの選択（コマンド）に応じて、異なる処理が実行されます。

このような「コマンドに応じた処理の切り替え」は、デザインパターンの1つである**Commandパターン**で整理できます。

- ユーザーの選択 → コマンドオブジェクト
- 1: add → AddCommand
- 2: list → ListCommand
- 3: done → DoneCommand
- 4: rm → DeleteCommand

この連載では、最初はシンプルなif文で処理を分岐しますが、最終回でこのCommandパターンを適用して、拡張しやすい設計に進化させます。

今は「メニュー選択は、将来コマンドオブジェクトになる」という意識を持っておいてください。

## 次回予告

次回は、ユーザーからの入力を受け取る処理を実装します。`<STDIN>`を使って、対話型のメニューUIを作成しましょう。

## シリーズ一覧

1. **第1回 - 完成イメージとMoo設計**（この記事）
2. 第2回 - ユーザーからの入力を受け取る（予定）
3. 第3回 - タスクをファイルに保存する（予定）
4. 第4回 - ファイルからタスクを読み込む（予定）
5. 第5回 - ファイル版の限界とデータベースへの移行（予定）
6. 第6回 - タスクをデータベースに追加する（予定）
7. 第7回 - タスク一覧を表示する（予定）
8. 第8回 - タスクを完了にする（予定）
9. 第9回 - タスクを削除する（予定）
10. 第10回 - コマンドライン引数でサクサク操作（予定）
