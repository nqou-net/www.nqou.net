---
comments: true
date: 2025-12-14T12:00:00+09:00
description: ドキュメント生成エージェントを活用してAPI仕様書、README、ユーザーガイドを自動生成し、常に最新のドキュメントを維持する方法を学びます
draft: true
hidden: false
image: /favicon.png
iso8601: 2025-12-14T12:00:00+09:00
license: ~
math: ~
tags:
  - github
  - copilot
  - ai
  - agent
  - documentation
  - hands-on
series: "GitHub エージェントパネル実践ガイド"
title: 【第7回】ドキュメント生成エージェントの設定 - 技術文書の自動作成

---

[@nqounet](https://x.com/nqounet)です。

GitHub エージェントパネル実践ガイド第7回です。今回は、ドキュメント生成エージェントを活用して、API仕様書、README、ユーザーガイドなどを自動生成する方法を学びます。

## この記事で学べること

- ドキュメント生成エージェントの設定
- API ドキュメントの自動生成
- README とユーザーガイドの作成
- コードコメントとの同期
- 多言語ドキュメントの管理

## ドキュメント生成エージェントの役割

ドキュメント生成エージェントは、コードから情報を抽出し、読みやすく正確なドキュメントを自動生成します。

### 生成できるドキュメントの種類

```
1. API ドキュメント
   - エンドポイント仕様
   - リクエスト/レスポンス例
   - 認証方法
   - エラーコード

2. README.md
   - プロジェクト概要
   - セットアップ手順
   - 使用方法
   - コントリビューションガイド

3. ユーザーガイド
   - 機能説明
   - チュートリアル
   - トラブルシューティング

4. 開発者向けドキュメント
   - アーキテクチャ設計
   - コーディング規約
   - デプロイ手順
```

## AGENTS.md の設定

```markdown
## documentation-agent

### 役割
技術ドキュメントの生成と更新

### ドキュメント形式

#### API ドキュメント
- フォーマット: OpenAPI 3.0 / Markdown
- 言語: 日本語（英語版も生成）
- 配置場所: `docs/api/`

#### README.md
- セクション構成:
  1. プロジェクト概要（100-200字）
  2. 主な機能
  3. 必要要件
  4. インストール手順
  5. 使用方法
  6. API リファレンスへのリンク
  7. コントリビューション
  8. ライセンス

#### コードドキュメント
- JSDoc / TSDoc 形式
- 各関数に説明、パラメータ、戻り値を記載
- 例を含める

### 品質基準

- 専門用語は初出時に説明
- コード例は実行可能
- スクリーンショットは最新
- リンク切れなし
```

## 実践例1: API ドキュメント生成

### コードからドキュメント生成

**元のコード**:
```javascript
// src/routes/users.js
router.post('/users', validateUser, async (req, res) => {
  const user = await User.create(req.body);
  res.status(201).json({ data: user });
});

router.get('/users/:id', async (req, res) => {
  const user = await User.findById(req.params.id);
  if (!user) {
    return res.status(404).json({ error: 'User not found' });
  }
  res.json({ data: user });
});
```

**ドキュメント生成プロンプト**:
```
以下の API エンドポイントのドキュメントを OpenAPI 3.0 形式で生成してください。

[コードを貼り付け]

要件:
- 各エンドポイントの詳細な説明
- リクエスト/レスポンスの例
- エラーレスポンスの定義
- 認証要件
```

**生成されたドキュメント** (`docs/api/openapi.yaml`):

```yaml
openapi: 3.0.0
info:
  title: User Management API
  description: ユーザー管理のための REST API
  version: 1.0.0
  contact:
    name: API Support
    email: support@example.com

servers:
  - url: https://api.example.com/v1
    description: 本番環境
  - url: https://api-staging.example.com/v1
    description: ステージング環境

paths:
  /users:
    post:
      summary: ユーザーを新規作成
      description: |
        新しいユーザーアカウントを作成します。
        メールアドレスは一意である必要があります。
      tags:
        - Users
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
                - name
              properties:
                email:
                  type: string
                  format: email
                  description: ユーザーのメールアドレス
                  example: user@example.com
                name:
                  type: string
                  minLength: 2
                  maxLength: 100
                  description: ユーザー名
                  example: 山田太郎
                age:
                  type: integer
                  minimum: 0
                  maximum: 150
                  description: 年齢（任意）
                  example: 30
      responses:
        '201':
          description: ユーザー作成成功
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    $ref: '#/components/schemas/User'
              example:
                data:
                  id: 123
                  email: user@example.com
                  name: 山田太郎
                  age: 30
                  createdAt: '2025-12-14T12:00:00Z'
        '400':
          description: バリデーションエラー
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                error:
                  message: Validation failed
                  code: VALIDATION_ERROR
                  details:
                    - field: email
                      message: Invalid email format
        '409':
          description: メールアドレス重複
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                error:
                  message: User already exists
                  code: USER_EXISTS

  /users/{id}:
    get:
      summary: ユーザー詳細を取得
      description: 指定されたIDのユーザー情報を取得します。
      tags:
        - Users
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
          description: ユーザーID
          example: 123
      responses:
        '200':
          description: ユーザー取得成功
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    $ref: '#/components/schemas/User'
        '404':
          description: ユーザーが見つかりません
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                error:
                  message: User not found
                  code: USER_NOT_FOUND

components:
  schemas:
    User:
      type: object
      properties:
        id:
          type: integer
          description: ユーザーID
          example: 123
        email:
          type: string
          format: email
          description: メールアドレス
          example: user@example.com
        name:
          type: string
          description: ユーザー名
          example: 山田太郎
        age:
          type: integer
          nullable: true
          description: 年齢
          example: 30
        createdAt:
          type: string
          format: date-time
          description: 作成日時
          example: '2025-12-14T12:00:00Z'
        updatedAt:
          type: string
          format: date-time
          description: 更新日時
          example: '2025-12-14T12:00:00Z'

    Error:
      type: object
      properties:
        error:
          type: object
          properties:
            message:
              type: string
              description: エラーメッセージ
            code:
              type: string
              description: エラーコード
            details:
              type: array
              description: 詳細なエラー情報（任意）
              items:
                type: object
```

### Markdown版 API ドキュメント

より読みやすい Markdown 形式でも生成できます：

**docs/api/README.md**:

```markdown
# User Management API

ユーザー管理のための REST API ドキュメント

## ベースURL

- 本番: `https://api.example.com/v1`
- ステージング: `https://api-staging.example.com/v1`

## エンドポイント一覧

### ユーザー作成

新しいユーザーアカウントを作成します。

**エンドポイント**: `POST /users`

**リクエスト**:

```json
{
  "email": "user@example.com",
  "name": "山田太郎",
  "age": 30
}
```

**必須フィールド**:
- `email` (string): メールアドレス
- `name` (string): ユーザー名（2-100文字）

**任意フィールド**:
- `age` (integer): 年齢（0-150）

**レスポンス**:

成功時（201 Created）:
```json
{
  "data": {
    "id": 123,
    "email": "user@example.com",
    "name": "山田太郎",
    "age": 30,
    "createdAt": "2025-12-14T12:00:00Z"
  }
}
```

エラー時（400 Bad Request）:
```json
{
  "error": {
    "message": "Validation failed",
    "code": "VALIDATION_ERROR",
    "details": [
      {
        "field": "email",
        "message": "Invalid email format"
      }
    ]
  }
}
```

**cURL 例**:

```bash
curl -X POST https://api.example.com/v1/users \
  -H "Content-Type: application/json" \
  -d '{
    "email": "user@example.com",
    "name": "山田太郎",
    "age": 30
  }'
```

### ユーザー取得

指定されたIDのユーザー情報を取得します。

**エンドポイント**: `GET /users/:id`

**パラメータ**:
- `id` (integer): ユーザーID

**レスポンス**:

成功時（200 OK）:
```json
{
  "data": {
    "id": 123,
    "email": "user@example.com",
    "name": "山田太郎",
    "age": 30,
    "createdAt": "2025-12-14T12:00:00Z",
    "updatedAt": "2025-12-14T12:00:00Z"
  }
}
```

エラー時（404 Not Found）:
```json
{
  "error": {
    "message": "User not found",
    "code": "USER_NOT_FOUND"
  }
}
```

**cURL 例**:

```bash
curl https://api.example.com/v1/users/123
```

## エラーコード一覧

| コード | 説明 |
|--------|------|
| VALIDATION_ERROR | リクエストのバリデーション失敗 |
| USER_NOT_FOUND | ユーザーが存在しない |
| USER_EXISTS | メールアドレスが既に登録されている |
| INTERNAL_SERVER_ERROR | サーバー内部エラー |

## レート制限

- 認証なし: 60リクエスト/時間
- 認証あり: 5000リクエスト/時間

レート制限に達した場合、429 Too Many Requests が返されます。
```

## 実践例2: README.md 生成

### プロンプト

```
プロジェクトの README.md を生成してください。

プロジェクト情報:
- 名前: User Management API
- 説明: Node.js + Express で構築されたユーザー管理 REST API
- 技術スタック: Node.js 18, Express 4, PostgreSQL 15
- 主な機能: ユーザーCRUD、認証、バリデーション

含めるセクション:
- プロジェクト概要
- 機能一覧
- 必要要件
- インストール手順
- 使用方法
- API ドキュメントへのリンク
- テスト方法
- デプロイ
- コントリビューション
- ライセンス
```

### 生成された README.md

```markdown
# User Management API

Node.js + Express で構築されたユーザー管理 REST API

[![Node.js Version](https://img.shields.io/badge/node-%3E%3D18.0.0-brightgreen)](https://nodejs.org/)
[![License: MIT](https://img.shields.io/badge/License-MIT-blue.svg)](LICENSE)

## 概要

User Management API は、ユーザーアカウントの作成・取得・更新・削除（CRUD操作）を提供する RESTful API です。認証機能、入力バリデーション、エラーハンドリングを備え、本番環境での使用に対応しています。

## 主な機能

- ✅ ユーザーの CRUD 操作
- ✅ メールアドレスとパスワードによる認証
- ✅ JWT トークンベースの認証
- ✅ リクエストバリデーション（Joi）
- ✅ エラーハンドリング
- ✅ ログ記録（Winston）
- ✅ ページネーション対応
- ✅ API ドキュメント（OpenAPI 3.0）

## 必要要件

- Node.js 18.x 以降
- PostgreSQL 15.x 以降
- npm 9.x 以降

## インストール

### 1. リポジトリのクローン

```bash
git clone https://github.com/your-org/user-management-api.git
cd user-management-api
```

### 2. 依存関係のインストール

```bash
npm install
```

### 3. 環境変数の設定

`.env.example` をコピーして `.env` を作成：

```bash
cp .env.example .env
```

`.env` ファイルを編集：

```env
# サーバー設定
PORT=3000
NODE_ENV=development

# データベース設定
DB_HOST=localhost
DB_PORT=5432
DB_NAME=user_management
DB_USER=postgres
DB_PASSWORD=your_password

# JWT設定
JWT_SECRET=your_jwt_secret_key
JWT_EXPIRES_IN=24h

# ログ設定
LOG_LEVEL=info
```

### 4. データベースのセットアップ

```bash
# データベース作成
createdb user_management

# マイグレーション実行
npm run migrate
```

## 使用方法

### 開発サーバーの起動

```bash
npm run dev
```

サーバーは `http://localhost:3000` で起動します。

### 本番環境での起動

```bash
npm start
```

### API の使用例

#### ユーザー作成

```bash
curl -X POST http://localhost:3000/api/users \
  -H "Content-Type: application/json" \
  -d '{
    "email": "user@example.com",
    "name": "山田太郎",
    "age": 30
  }'
```

#### ユーザー一覧取得（ページネーション）

```bash
curl "http://localhost:3000/api/users?page=1&limit=10"
```

## API ドキュメント

詳細な API 仕様は以下を参照してください：

- [OpenAPI 仕様](docs/api/openapi.yaml)
- [Markdown版ドキュメント](docs/api/README.md)

## テスト

### ユニットテストの実行

```bash
npm test
```

### カバレッジレポート

```bash
npm run test:coverage
```

### E2Eテスト

```bash
npm run test:e2e
```

## デプロイ

### Docker を使用したデプロイ

```bash
# イメージのビルド
docker build -t user-management-api .

# コンテナの実行
docker run -p 3000:3000 --env-file .env user-management-api
```

### Docker Compose を使用

```bash
docker-compose up -d
```

## プロジェクト構造

```
.
├── src/
│   ├── controllers/    # ビジネスロジック
│   ├── routes/         # ルーティング定義
│   ├── models/         # データモデル
│   ├── middleware/     # ミドルウェア
│   ├── validators/     # バリデーション
│   └── utils/          # ユーティリティ
├── tests/              # テストコード
├── docs/               # ドキュメント
├── migrations/         # DBマイグレーション
└── config/             # 設定ファイル
```

## コントリビューション

コントリビューションを歓迎します！以下の手順に従ってください：

1. このリポジトリをフォーク
2. フィーチャーブランチを作成 (`git checkout -b feature/amazing-feature`)
3. 変更をコミット (`git commit -m 'Add some amazing feature'`)
4. ブランチにプッシュ (`git push origin feature/amazing-feature`)
5. プルリクエストを作成

## ライセンス

このプロジェクトは MIT ライセンスの下で公開されています。
詳細は [LICENSE](LICENSE) ファイルを参照してください。

## サポート

問題が発生した場合は、[Issue](https://github.com/your-org/user-management-api/issues) を作成してください。
```

## 実践例3: コードコメントの自動生成

### JSDoc コメントの生成

**元のコード**:
```javascript
async function processPayment(orderId, amount, paymentMethod) {
  const order = await Order.findById(orderId);
  const payment = await Payment.create({
    orderId,
    amount,
    method: paymentMethod,
    status: 'pending'
  });
  
  try {
    const result = await paymentGateway.charge(payment);
    payment.status = 'completed';
    await payment.save();
    return result;
  } catch (error) {
    payment.status = 'failed';
    await payment.save();
    throw error;
  }
}
```

**生成されたドキュメント付きコード**:
```javascript
/**
 * 注文の決済処理を実行
 * 
 * 指定された注文IDに対して決済を実行します。
 * 決済ゲートウェイを通じて実際の課金処理を行い、
 * 結果に応じて決済ステータスを更新します。
 * 
 * @async
 * @param {number} orderId - 注文ID
 * @param {number} amount - 決済金額（円）
 * @param {string} paymentMethod - 決済方法（'credit_card', 'bank_transfer', 'paypal'）
 * @returns {Promise<Object>} 決済結果オブジェクト
 * @returns {string} return.transactionId - トランザクションID
 * @returns {string} return.status - 決済ステータス
 * @returns {Date} return.processedAt - 処理日時
 * 
 * @throws {OrderNotFoundError} 注文が存在しない場合
 * @throws {PaymentGatewayError} 決済ゲートウェイでエラーが発生した場合
 * @throws {InsufficientFundsError} 残高不足の場合
 * 
 * @example
 * try {
 *   const result = await processPayment(12345, 5000, 'credit_card');
 *   console.log('決済成功:', result.transactionId);
 * } catch (error) {
 *   console.error('決済失敗:', error.message);
 * }
 */
async function processPayment(orderId, amount, paymentMethod) {
  // 注文の存在確認
  const order = await Order.findById(orderId);
  if (!order) {
    throw new OrderNotFoundError(`Order ${orderId} not found`);
  }

  // 決済レコードを作成
  const payment = await Payment.create({
    orderId,
    amount,
    method: paymentMethod,
    status: 'pending'
  });
  
  try {
    // 決済ゲートウェイで課金処理
    const result = await paymentGateway.charge(payment);
    
    // 成功時はステータスを更新
    payment.status = 'completed';
    await payment.save();
    
    return result;
  } catch (error) {
    // 失敗時はステータスを更新してエラーを再スロー
    payment.status = 'failed';
    await payment.save();
    throw error;
  }
}
```

## ドキュメントの自動更新

コードが変更されたときにドキュメントも自動更新するワークフロー：

```markdown
## ドキュメント更新ワークフロー

1. コード変更検知
   └─ Git フックまたは CI/CD で検知

2. 差分分析
   ├─ 変更されたファイルを特定
   └─ 影響範囲を分析

3. ドキュメント更新
   ├─ API 変更 → OpenAPI 更新
   ├─ 関数追加/変更 → JSDoc 更新
   └─ 機能追加 → README 更新

4. レビュー
   ├─ 自動生成ドキュメントを確認
   └─ 必要に応じて手動調整

5. コミット
   └─ ドキュメント変更をコミット
```

## 次回予告

第8回「マルチエージェント連携」では、複数のエージェントを協調動作させて、より複雑なタスクを効率的に実行する方法を学びます。

## チェックリスト

- [ ] API ドキュメントを自動生成できた
- [ ] README.md を作成できた
- [ ] コードコメントを充実させた
- [ ] ドキュメント更新ワークフローを理解した
- [ ] 多言語ドキュメントの管理方法を理解した

---

**シリーズ目次**
1. [エージェントパネル入門](../1764676800/)
2. [エージェントパネルの基本操作](../1764849600/)
3. [最初のエージェント設定](../1765022400/)
4. [タスクプランニングエージェントの活用](../1765195200/)
5. [コード生成エージェントの実践](../1765368000/)
6. [レビューエージェントの構築](../1765540800/)
7. **ドキュメント生成エージェントの設定**（本記事）
8. マルチエージェント連携
9. カスタムツール統合
10. セキュリティとベストプラクティス
11. トラブルシューティング
12. 実践プロジェクト

質問や感想は [@nqounet](https://x.com/nqounet) までお気軽にどうぞ!
