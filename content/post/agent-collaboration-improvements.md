---
title: "GitHub Copilot カスタムエージェント入門｜AGENTS.md実践ガイド"
draft: true
tags:
- github-copilot
- ai-agent
- prompt-engineering
- agents-md
- custom-agent
description: "GitHub Copilotのカスタムエージェント活用を実例で解説。AGENTS.mdの書き方、プロンプト最適化テクニック、エージェント連携のワークフローまで、実践的なノウハウを公開します。"
---

## はじめに

GitHub Copilotを使い始めて、もっと高度な活用法を探している方へ。**カスタムエージェント**という選択肢をご存知でしょうか。

GitHub Copilotのカスタムエージェントとは、Copilotの機能を拡張し、特定のタスクや役割を担当させるために作成する専門家のようなものです。例えば、コードレビュー専門のエージェント、ドキュメント作成専門のエージェント、テスト作成専門のエージェントなど、プロジェクトの特性に合わせて自由に定義できます。

### カスタムエージェントを使う理由

プロジェクトが大きくなるにつれて、単一のAIエージェントですべてをカバーするのは難しくなります。GitHub Copilotのカスタムエージェントを使えば、役割分担を明確にし、各エージェントが専門性を持って作業を行うことで、より高品質な成果物を得ることができます。

### この記事で学べること

この記事では、筆者が実際にAGENTS.mdやカスタムエージェントを作成する中で学んだことを共有します。具体的には以下の内容を扱います。

- カスタムエージェントのガイドラインは「仕様」ではなく「プロンプト」として最適化する必要がある
- AIに書かせて観察するアプローチが有効である
- うまく動いた時に共通する要素がある
- AGENTS.mdの実践例とワークフロー定義を示す
- 今後の展望と課題を考察する

GitHub Copilotを使い始めたばかりの方でも理解できるよう、実例を交えながら丁寧に解説していきます。

## AGENTS.mdはプロンプトエンジニアリングの対象

GitHub Copilotのカスタムエージェントを作成する際、最初に直面する疑問は「何をどう書けばいいのか」ということです。

実は、カスタムエージェント用のガイドラインには、カチッとした仕様が決まっているわけではありません。つまり、「これを書かなければならない」という厳密なルールは存在しないのです。

では、どうすればよいのでしょうか。答えは「**ガイドラインもプロンプトエンジニアリングの対象として考える**」ということです。

### DeNAの勉強会資料から学んだこと

筆者は、DeNAが公開した勉強会資料「AIエンジニアが本気で作ったLLM勉強会資料を大公開」から多くのことを学びました。

{{< linkcard "https://engineering.dena.com/blog/2025/12/llm-study-1201/" >}}

この資料の中で、特にプロンプトエンジニアリング（15〜22ページ、右下の数字だと10〜15）のベストプラクティスが非常に参考になりました。

### AGENTS.mdもプロンプト最適化が必要

ガイドラインファイル（**AGENTS.md**やカスタムエージェント定義ファイル）は、AIに対する「指示書」です。つまり、プロンプトと同じように、最適化を考える必要があるのです。

カチッとした仕様がないからこそ、プロンプトエンジニアリングのベストプラクティスを適用することで、より効果的なAGENTS.mdを作成できます。

## プロンプトエンジニアリングのベストプラクティス

DeNAの勉強会資料から学んだプロンプトエンジニアリングのベストプラクティスを、GitHub Copilotのカスタムエージェント作成に応用しましょう。

### 重要な部分だけ強調する

すべての情報を同じトーンで書くと、AIは何が重要なのか判断しづらくなります。重要な部分は以下のような方法で強調しましょう。

- **太字（Bold）**を使う
- 見出しレベルを上げる
- 箇条書きの最初に配置する
- 「重要」「必須」などのキーワードを使う

例えば、AGENTS.mdに「わからない場合は正直にわからないと答えること」という項目を設ける場合、単に箇条書きの一つとして書くのではなく、「最重要項目」という独立したセクションを作り、太字で強調することで、GitHub Copilotはその重要性を理解しやすくなります。

### 役割付与でエージェントの専門性を引き出す

GitHub Copilotに特定の役割を与えることで、その役割に適した回答を得られる確率が高まります。

カスタムエージェントの定義ファイルでは、冒頭で明確に役割を定義しましょう。

例:
```markdown
# Perl Monger エージェント

あなたは10年以上の経験を持つPerlに深い愛とこだわりを持つ、オタク気質の専門家です。
Perlに関する最新のトレンドやCPANモジュールを常に追い続けています。
```

このように役割を明確にすることで、GitHub Copilotは「Perl専門家」として振る舞い、より専門的で深い知識を引き出すことができます。

### ハルシネーション防止のテクニック

ハルシネーション（AIが事実ではない情報を生成すること）を防ぐためには、以下のテクニックが有効です。

- 「わからない場合は正直にわからないと答えること」を明記する
- 情報源の提示を求める
- 確実な情報のみを扱うよう指示する
- 推測と事実を区別するよう求める

筆者のAGENTS.mdでは、「最重要項目」として以下を明記しています。

```markdown
## 最重要項目

- **わからない場合や確証を持てない場合は、正直に『わからない』と答えること**。常に正確性と透明性を最優先に考え、適切な回答を心がけること
```

これにより、GitHub Copilotは不確実な情報を提供するのではなく、わからない場合は正直にそう伝えるようになります。

## AIに書かせて観察するアプローチ

筆者がGitHub Copilotのカスタムエージェントを活用し始めた当初、「何を書けばいいのかわからない」という問題に直面しました。

そこで採用したアプローチが「**AIに書かせてみる**」というものでした。

### AGENTS.mdをCopilotに書かせてみた

最初は、GitHub CopilotにAGENTS.mdを書いてもらいました。完璧なものは期待せず、まずは叩き台を作ってもらうことが目的でした。

プロンプト例:
```text
このリポジトリのAGENTS.mdを作成してください。
このリポジトリはHugoを使った技術ブログです。
エージェントが記事作成を補助する際のガイドラインを含めてください。
```

すると、Copilotは基本的な構造を持ったAGENTS.mdを生成してくれました。

### 「何を書けばわからないならAIに書かせれば良い」という発想

この発想の利点は、以下の通りです。

- ゼロから書くよりもハードルが低い
- AIが生成した構造をベースに、自分の要件を追加・修正できる
- 複数回生成させることで、異なる視点やアプローチを得られる
- 実際に動かしてみることで、何が必要か、何が不要かが見えてくる

重要なのは、AIが生成したものをそのまま使うのではなく、それを観察し、分析することです。

### うまく動いた時の観察と改善サイクル

AIに書かせたAGENTS.mdやカスタムエージェント定義ファイルをGitHub Copilotで実際に使ってみると、うまく動く時と動かない時があります。

筆者は、うまく動いた時のファイルを注意深く観察し、共通する要素を見つけることに注力しました。

その結果、いくつかのパターンが浮かび上がってきました。

## カスタムエージェントがうまく動く4つの要素

試行錯誤の結果、GitHub Copilotのカスタムエージェントがうまく動く確率が高い要素として、以下の4つが見えてきました。

### エージェント名とファイル名を一致させる

エージェント名とファイル名を一致させることで、GitHub Copilotがエージェントを正しく認識しやすくなります。

例:
- ファイル名: `.github/agents/perl-monger.agent.md`
- エージェント名: `perl-monger`

この一致により、「`perl-monger`エージェントを呼び出す」という指示がファイルと確実に結びつきます。

### エージェント定義の場所を明示する

AGENTS.mdの中で、カスタムエージェントの定義ファイルがどこにあるかを明記しましょう。

```markdown
## エージェント定義

専門家エージェントは `.github/agents/*.agent.md` を参照してください。以下は代表例です。

- Perl / CPAN / ワンライナー: `perl-monger`
- SQL / クエリ最適化 / DB 設計: `sql-otaku`
- Docker / コンテナ運用: `docker-otaku`
```

このように定義場所を明示することで、GitHub Copilotは必要に応じてエージェント定義ファイルを参照し、適切な専門知識を引き出すことができます。

### ワークフローとして定義する

単に「こういうエージェントがいる」というだけでなく、「どのような順でどのエージェントが何をするのか」をワークフローとして定義することが重要です。

筆者のAGENTS.mdでは、単体記事のワークフローを以下のように定義しています。

```markdown
### 単体記事のワークフロー

記事ごとのワークフローは以下の順とする。それぞれ専門家エージェントに割り当てる

1. 調査・情報収集（investigative-researchエージェント）
2. アウトライン作成（search-engine-optimizationエージェント）
3. 記事作成（各専門家エージェント）
4. スタイルと構成の整形（layout-and-content-harmonizationエージェント）
5. 校正（proofreaderエージェント）
6. SEO（search-engine-optimizationエージェント）
7. 公開前の最終チェック（reviewerエージェント）
```

このようなワークフロー定義により、GitHub Copilotは全体の流れを理解し、適切なタイミングで適切なエージェントを呼び出すことができます。

### 正しく情報を与えてあげるだけ

わかってしまうとなんてことはないのですが、GitHub Copilotのカスタムエージェントを効果的に動かすには「正しく情報を与えてあげる」ことが重要です。

- エージェントの定義がどこにあるか
- どのような順でどのエージェントが何をするか
- 各エージェントの専門分野は何か
- どのような成果物を期待するか

これらを明確に記述することで、GitHub Copilotは混乱せず、期待通りの動作をする確率が高まります。

## AGENTS.mdの実践例とワークフロー

ここまでの知識を踏まえて、実際のAGENTS.mdの構造を見てみましょう。

### エージェント定義とワークフローの定義

以下は、筆者のAGENTS.mdから抜粋した例です。

```markdown
## エージェント定義

専門家エージェントは `.github/agents/*.agent.md` を参照してください。以下は代表例です。

- Perl / CPAN / ワンライナー: `perl-monger`
- SQL / クエリ最適化 / DB 設計: `sql-otaku`
- JSON-RPC / API 設計: `json-rpc-otaku`
- Docker / コンテナ運用: `docker-otaku`
- Git / ブランチ運用: `git-otaku`
- カスタムエージェント: `github-copilot-otaku`

## ワークフロー定義

### 単体記事のワークフロー

記事ごとのワークフローは以下の順とする。それぞれ専門家エージェントに割り当てる

1. 調査・情報収集（investigative-researchエージェント）
   → キーワード、および関連トピックの調査

2. アウトライン作成（search-engine-optimizationエージェント）
   → タイトルの最適化、見出し構造の整理

3. 記事作成（各専門家エージェント）
   → アウトラインに基づいた記事作成

4. スタイルと構成の整形（layout-and-content-harmonizationエージェント）
   → 文体やレイアウトの統一

5. 校正（proofreaderエージェント）
   → 誤字脱字、文法のチェック

6. SEO（search-engine-optimizationエージェント）
   → メタデータの最適化

7. 公開前の最終チェック（reviewerエージェント）
   → 総合的な品質確認
```

この構造により、GitHub Copilotはワークフローの各ステップで適切なエージェントを呼び出し、段階的に作業を進めることができます。

### Issueを作成してCopilotにアサイン

実際の運用では、機能を定義したIssueを作成し、GitHub Copilotにアサインすることで、要件分析から実装、レビュー、ドキュメント更新までを、エージェントを呼び出しながら実装してくれます。

例えば、「新しいブログ記事を作成する」というIssueを作成し、その中に以下のような情報を記載します。

```markdown
## 記事作成要件

- テーマ: GitHub Actionsのベストプラクティス
- 想定読者: 初心者〜中級者
- 想定文字数: 3000〜5000文字
- 参考URL: [関連するURLをリストアップ]

## ワークフロー

AGENTS.mdの「単体記事のワークフロー」に従って作成してください。
```

このIssueをGitHub Copilotにアサインすると、自動的にワークフローに従って各エージェントが順次呼び出され、記事が完成します。

## カスタムエージェントワークフローの実際

ワークフローを定義することで、GitHub Copilotの各エージェントがどのタイミングで何をするのかが明確になります。

### 各エージェントの役割分担

ワークフローの各ステップで、エージェントは以下のような役割を担います。

- **調査・情報収集エージェント**: 最新の情報や信頼性の高い情報源を調査し、記事の土台を作る
- **アウトライン作成エージェント**: 調査結果に基づき、記事の構造を設計する
- **記事作成エージェント**: 専門知識を活かして、技術的に正確な記事を執筆する
- **整形エージェント**: 文体やレイアウトを統一し、読みやすさを向上させる
- **校正エージェント**: 誤字脱字や文法ミスをチェックする
- **SEOエージェント**: 検索エンジン最適化の観点でメタデータを調整する
- **レビューエージェント**: 最終的な品質チェックを行う

### エージェント間の連携方法

エージェント間の連携は、ワークフローの順序に従って行われます。

例えば、調査エージェントが調査結果を `agents/research/<slug>.md` に保存すると、アウトライン作成エージェントはそのファイルを参照してアウトラインを作成します。

次に、記事作成エージェントは調査結果とアウトラインの両方を参照して、記事を執筆します。

このように、各エージェントの成果物が次のエージェントの入力となることで、スムーズな連携が実現します。

## GitHub Copilotカスタムエージェントの今後

GitHub Copilotのカスタムエージェント活用は、まだ発展途上の領域です。筆者自身も試行錯誤を続けています。

### エージェントの配置問題（.github/agents/*.md）

現時点での大きな課題の一つが、エージェント定義ファイルの配置です。

筆者は `.github/agents/*.md` という配置を採用していますが、これはまだGitHub公式で標準化されているわけではありません。GitHub公式のドキュメントでも、特定の配置が推奨されているわけではないため、各プロジェクトが独自に決める必要があります。

### コミュニティ主導の標準化に期待

今後、GitHub Copilotのカスタムエージェント機能がより広く使われるようになれば、コミュニティベースでの標準化が進む可能性があります。

例えば、以下のような標準化が考えられます。

- エージェント定義ファイルの配置場所
- AGENTS.mdの基本構造
- ワークフロー定義の記法
- エージェント間の連携方法

### 「正しく情報を与える」ことの本質

これまで見てきたように、カスタムエージェントをうまく動かすための本質は「正しく情報を与えてあげる」ことです。

これは、AIに限らず、人間同士のコミュニケーションでも同じことが言えます。相手が必要とする情報を、適切なタイミングで、わかりやすい形で提供することが重要です。

ファイルの配置がどこであっても、エージェント定義の名前がどうであっても、この本質を押さえていれば、GitHub Copilotのカスタムエージェントは機能するはずです（まだすべての配置パターンを試したわけではありませんが）。

今後も、「どうすればGitHub Copilotに正しく情報を伝えられるか」という視点で、AGENTS.mdやカスタムエージェント定義を改善していくことが重要です。

## まとめ

この記事では、GitHub Copilotのカスタムエージェント活用について、筆者の実践から学んだことを共有しました。

### カスタムエージェント活用のポイント

- **ガイドラインはプロンプトとして最適化する**: 仕様ではなく、プロンプトエンジニアリングのベストプラクティスを適用する
- **重要な部分を強調する**: 太字や見出しを使って、AIが重要性を理解しやすくする
- **役割を明確にする**: 各エージェントの専門性を明示する
- **ハルシネーションを防ぐ**: 「わからない場合は正直に答える」ことを明記する
- **AIに書かせて観察する**: 完璧を求めず、まずは叩き台を作って改善する
- **名前を一致させる**: エージェント名とファイル名を統一する
- **定義場所を明示する**: どこにエージェント定義があるかを明記する
- **ワークフローを定義する**: どの順でどのエージェントが何をするかを明確にする
- **正しく情報を与える**: AIが必要とする情報を適切に提供する

### 次のステップ

カスタムエージェントの活用は、試行錯誤の連続です。以下のステップで、あなたのプロジェクトにも導入してみましょう。

1. **既存のAGENTS.mdを読む**: この記事や他のプロジェクトのAGENTS.mdを参考にする
2. **Copilotにドラフトを書かせる**: まずは叩き台を作成してもらう
3. **動作を確認し、観察する**: うまく動く時、動かない時を記録する
4. **パターンを見つけて最適化する**: 共通する要素を見つけ、改善する
5. **ワークフローを定義する**: 各エージェントの役割と連携を明確にする
6. **継続的に改善する**: フィードバックを得ながら、少しずつ改善していく

カスタムエージェントは、あなたのプロジェクトをより効率的に、より高品質にするための強力なツールです。ぜひ、この記事をきっかけに、試してみてください。

最後に、DeNAの勉強会資料をはじめ、公開されている知見から学ぶことの重要性を強調したいと思います。コミュニティの知恵を活用しながら、一緒にカスタムエージェント活用の最前線を切り開いていきましょう。

{{< linkcard "https://engineering.dena.com/blog/2025/12/llm-study-1201/" >}}
