---
title: "連載構造案 - PerlでTODOリスト（CLI）を作成する"
description: "シリーズ記事「PerlでTODOリスト（CLI）を作成する」の連載構造案3つ（案A/B/C）"
date: 2025-12-30
draft: true
tags:
  - perl
  - cli
  - todo-list
  - dbi
  - sqlite
  - series-structure
---

# 連載構造案：PerlでTODOリスト（CLI）を作成する

> 調査結果: `content/warehouse/perl-cli-todo-list-research.md` に基づく

## 前提情報

- **技術スタック**: Perl（DBI, SQLite, Getopt::Long）
- **想定読者**: Perl入学式卒業程度（変数、配列、ハッシュ、サブルーチン、正規表現の基本は既知）
- **ゴール**: 
  - データベースを用いたCRUDの実装
  - ファイルの入出力も途中で扱う
- **制約**: 
  - 各回の記事につき「コード例は2つまで」
  - 各回ごとに導入する「新しい概念」は1つまで

### 内部リンク候補

| 記事 | リンク | 参照タイミング |
|------|--------|--------------|
| DBI / DBIx::Class 入門 | [/2025/12/13/000000/](/2025/12/13/000000/) | データベース導入時 |
| Getopt::Long | [/2025/12/21/000000/](/2025/12/21/000000/) | CLI引数処理時 |
| Try::Tiny | [/2025/12/14/000000/](/2025/12/14/000000/) | エラーハンドリング時 |
| CPAN20選 | [/2025/12/03/041603/](/2025/12/03/041603/) | モジュール紹介時 |
| Carton/cpanfile | [/2025/12/10/000000/](/2025/12/10/000000/) | 依存関係管理時 |

---

## 案A: 教科書的アプローチ（ファイル入出力 → データベースへの段階的移行）

### 特徴・アプローチ

「ファイル保存で動くものを作る」→「データベースに移行して機能を拡張する」という、古典的かつ堅実なアプローチです。初学者にとって親しみやすいテキストファイルから始め、その限界を体験した後にデータベースの価値を実感できる構成です。

**メリット**:
- ファイル入出力という馴染みやすいテーマから始められる
- 「なぜデータベースが必要か」という動機付けが自然に発生
- Perl入学式で学んだファイル操作の知識を直接活かせる

**デメリット**:
- ファイル版のコードがデータベース版で「作り直し」になる部分がある
- 連載が長くなりやすい（全10回想定）

### 連載構造表

| 回数 | タイトル | 新しい概念 | ストーリー | コード例1 | コード例2 | 推奨タグ |
|------|---------|-----------|-----------|----------|----------|---------|
| 第1回 | TODOリストアプリを作ろう - 完成イメージと設計 | アプリ設計 | 完成形をデモし、メニュー形式のCLI UIを設計する | 完成形の使用イメージ（実行結果例） | アプリの基本構造（while無限ループ） | perl, cli, todo-app |
| 第2回 | ユーザーからの入力を受け取る | `<STDIN>` | ユーザーにメニューを表示し、選択を受け取る対話型インターフェースを作る | メニュー表示と入力ループ | chomp と入力バリデーション | perl, cli, user-input |
| 第3回 | タスクをファイルに保存する | `open` (書き込み) | 追加したタスクをテキストファイルに1行1タスクで保存する | `open my $fh, '>', $file` で書き込み | `print $fh` でタスク出力 | perl, file-io, utf8 |
| 第4回 | ファイルからタスクを読み込む | `open` (読み込み) | アプリ起動時に保存済みタスクを復元し、一覧表示する | `open my $fh, '<', $file` で読み込み | `while (<$fh>)` で行ごと処理 | perl, file-io, read |
| 第5回 | ファイル版の限界とデータベースへの移行 | DBI接続 | 検索・更新の困難さに直面し、SQLiteデータベースを導入する | DBI接続（`connect`メソッド） | テーブル作成（CREATE TABLE） | perl, dbi, sqlite |
| 第6回 | タスクをデータベースに追加する（Create） | INSERT文 | フォームからのタスクをデータベースに登録する | `$dbh->prepare` と `INSERT INTO` | `last_insert_id` でID取得 | perl, dbi, insert |
| 第7回 | タスク一覧を表示する（Read） | SELECT文 | 全タスクと未完了タスクを条件付きで取得し表示する | `SELECT * FROM tasks` で全件取得 | `WHERE done = 0` で未完了フィルタ | perl, dbi, select |
| 第8回 | タスクを完了にする（Update） | UPDATE文 | タスクIDを指定して完了フラグを更新する | `UPDATE tasks SET done = 1 WHERE id = ?` | 更新結果の確認メッセージ | perl, dbi, update |
| 第9回 | タスクを削除する（Delete） | DELETE文 | 不要になったタスクをIDを指定して削除する | `DELETE FROM tasks WHERE id = ?` | 削除確認プロンプト | perl, dbi, delete |
| 第10回 | コマンドライン引数でサクサク操作 | Getopt::Long | メニュー形式からサブコマンド形式（add/list/done/rm）に進化させる | Getopt::Longでサブコマンド処理 | 完成したtodo.plの全体像 | perl, cli, getopt-long |

### 差別化ポイント

- **「作り直し」を通じた学習**: ファイル版→DB版への移行で「リファクタリング」を自然に体験
- **Perl入学式の延長線上**: ファイル操作は既習のため、すぐに動くものが作れる
- **段階的な複雑さ**: 1つずつ概念を積み上げる丁寧な進行

---

## 案B: 実践的アプローチ（最初からデータベース、ファイル入出力は後から）

### 特徴・アプローチ

「最初から正しい方法で」データベースを使い、コマンドライン引数ですぐに実用的なツールを作ります。ファイル入出力はエクスポート/インポート機能として後から追加。現場で使えるツールを早期に完成させ、後から機能を拡張していく実践的な構成です。

**メリット**:
- 早い段階で「実用的に使えるツール」が完成する
- データベースの強力さを最初から実感できる
- ファイル入出力が「オプション機能」として自然な導入になる

**デメリット**:
- DBI/SQLiteの概念を初回から理解する必要がある
- Perl入学式で学んだファイル操作の活用が後回しになる

### 連載構造表

| 回数 | タイトル | 新しい概念 | ストーリー | コード例1 | コード例2 | 推奨タグ |
|------|---------|-----------|-----------|----------|----------|---------|
| 第1回 | TODOリストCLIを作る - 設計とデータベース準備 | DBI接続 | 完成イメージを見せ、SQLiteデータベースをセットアップする | DBI接続（`connect`） | tasksテーブルのCREATE TABLE | perl, dbi, sqlite |
| 第2回 | タスクを追加する - addサブコマンド | INSERT文 | `todo.pl add "買い物"` でタスクを追加できるようにする | INSERT文でタスク登録 | `last_insert_id` でID取得 | perl, dbi, insert |
| 第3回 | コマンドラインでサブコマンドを扱う | Getopt::Long基礎 | サブコマンド方式（add/list/done/rm）の基本を実装する | Getopt::Longでオプション解析 | サブコマンドのディスパッチ | perl, cli, getopt-long |
| 第4回 | タスク一覧を見る - listサブコマンド | SELECT文 | `todo.pl list` で全タスク、`todo.pl list --pending` で未完了のみ表示 | SELECT文で全件取得 | `--pending` オプションでフィルタ | perl, dbi, select |
| 第5回 | タスクを完了にする - doneサブコマンド | UPDATE文 | `todo.pl done 3` でID=3のタスクを完了マークする | UPDATE文でdoneフラグ更新 | 存在チェックとエラーメッセージ | perl, dbi, update |
| 第6回 | タスクを削除する - rmサブコマンド | DELETE文 | `todo.pl rm 3` でID=3のタスクを削除する | DELETE文でタスク削除 | `--force` オプションで確認スキップ | perl, dbi, delete |
| 第7回 | エラーを優しく処理する | Try::Tiny | DBエラーやファイル不在を適切にハンドリングし、ユーザーフレンドリーなメッセージを表示 | Try::Tinyでtry/catch | エラーメッセージのフォーマット | perl, error-handling, try-tiny |
| 第8回 | タスクをファイルにエクスポートする | `open` (書き込み) | `todo.pl export tasks.txt` でタスクをテキストファイルに出力する | `open` で書き込み | CSV/TSV形式でエクスポート | perl, file-io, export |
| 第9回 | ファイルからタスクをインポートする | `open` (読み込み) | `todo.pl import tasks.txt` で外部ファイルからタスクを一括登録する | `open` で読み込み | バリデーションと重複チェック | perl, file-io, import |
| 第10回 | 完成！実用TODOリストCLI | まとめ・改善 | cpanfileの作成、ヘルプの充実、コードのリファクタリングで完成度を上げる | cpanfile作成例 | 完成したコードの全体構造 | perl, cli, best-practices |

### 差別化ポイント

- **即座に実用可能**: 第5回でCRUD完成、すぐに使えるツールが手に入る
- **サブコマンド方式を最初から**: モダンなCLIツールの作法を身につける
- **ファイル入出力は「機能追加」として自然**: エクスポート/インポートという実用的な文脈

---

## 案C: 機能駆動アプローチ（TODOアプリの機能ごとに学習）

### 特徴・アプローチ

「TODOアプリに必要な機能」を軸に連載を構成します。各回で「機能」と「それを実現する技術」を1対1で対応させ、「何ができるようになるか」を明確にした構成です。技術よりも「ユーザー価値」を重視し、読者が「次に何を作るか」をイメージしやすい構成です。

**メリット**:
- 各回の目標が明確（「〜ができるようになる」）
- 読者が自分のプロジェクトに応用しやすい
- 技術の「使いどころ」がわかりやすい

**デメリット**:
- 技術的な体系性がやや薄れる
- 同じファイル/DBを行ったり来たりする回がある

### 連載構造表

| 回数 | タイトル | 新しい概念 | ストーリー | コード例1 | コード例2 | 推奨タグ |
|------|---------|-----------|-----------|----------|----------|---------|
| 第1回 | TODOアプリの全体像を設計する | アプリ設計 | ユーザーストーリーを洗い出し、必要な機能とデータ構造を決める | 機能一覧表（Markdown） | tasksテーブルのスキーマ設計 | perl, design, todo-app |
| 第2回 | データベースに接続する | DBI接続 | SQLiteデータベースをセットアップし、接続する | DBI接続とエラー処理 | テーブル作成（CREATE TABLE） | perl, dbi, sqlite |
| 第3回 | 「タスクを追加する」機能を作る | INSERT文 | ユーザー入力をタスクとしてデータベースに保存する | INSERTでタスク追加 | `last_insert_id` でID取得 | perl, dbi, create |
| 第4回 | 「タスク一覧を見る」機能を作る | SELECT文 | 保存したタスクを取得し、見やすく一覧表示する | SELECTで全件取得 | ループで一覧表示 | perl, dbi, read |
| 第5回 | 「タスクを完了にする」機能を作る | UPDATE文 | 指定したタスクに完了マークをつける | UPDATEでdoneフラグ更新 | 完了済みタスクの表示変更 | perl, dbi, update |
| 第6回 | 「タスクを削除する」機能を作る | DELETE文 | 不要なタスクをデータベースから削除する | DELETEでタスク削除 | 削除確認のユーザー入力 | perl, dbi, delete |
| 第7回 | 「コマンドラインから操作する」機能を作る | Getopt::Long | 対話メニューではなくコマンド引数で操作できるようにする | Getopt::Longの基本使い方 | サブコマンドの実装 | perl, cli, getopt-long |
| 第8回 | 「タスクをバックアップする」機能を作る | `open` (書き込み) | タスクをテキストファイルにエクスポートしてバックアップする | `open` での書き込み | UTF-8エンコーディング対応 | perl, file-io, backup |
| 第9回 | 「バックアップから復元する」機能を作る | `open` (読み込み) | バックアップファイルからタスクをインポートして復元する | `open` での読み込み | 重複チェックと一括INSERT | perl, file-io, restore |
| 第10回 | 「エラーを適切に処理する」機能を作る | Try::Tiny | ファイル不在、DB接続エラーなどを優雅に処理する | Try::Tinyでtry/catch | 完成コードの全体構造 | perl, error-handling, try-tiny |

### 差別化ポイント

- **ユーザー視点**: 「〜機能を作る」という読者にわかりやすいタイトル
- **機能の独立性**: 各回が「1つの機能」として完結し、スキップ可能
- **応用しやすい**: 読者が自分のプロジェクトで「この機能を追加したい」と応用しやすい

---

## 推薦案：案A「教科書的アプローチ」

### 推薦理由

#### 1. ペルソナとの適合性

想定ペルソナは「Perl入学式卒業程度」の読者です。

- **ファイル入出力は既習範囲**: Perl入学式で `open` は学んでいるため、第3〜4回ですぐに動くものが作れる
- **段階的な難易度上昇**: ファイル→DBという流れで、無理なくステップアップできる
- **「なぜDBが必要か」の実体験**: ファイル版の限界（検索・更新の困難さ）を体験することで、DBI導入の動機が明確になる

#### 2. 検索意図・SEOへの適合性

想定される検索キーワードとの親和性:

| 検索キーワード | 対応する回 | 検索意図 |
|--------------|----------|---------|
| 「Perl ファイル 書き込み」 | 第3回 | ファイル操作を学びたい |
| 「Perl DBI SQLite 入門」 | 第5〜6回 | データベースを使いたい |
| 「Perl TODO アプリ 作成」 | 第1回〜全体 | 実践的なプロジェクトを作りたい |
| 「Perl CLI 引数 Getopt」 | 第10回 | CLIツールの作り方を知りたい |

案Aは「ファイル操作」「データベース操作」「CLI開発」という3つの人気トピックを網羅し、各回が独立した検索エントリーポイントになりえます。

#### 3. 調査結果との整合性

調査ドキュメント（`perl-cli-todo-list-research.md`）の「推奨する連載の流れ」と完全に一致:

> 1. 序章: TODOリストアプリの概要と完成イメージ
> 2. 基礎編（ファイル保存）
> 3. 応用編（データベース保存）
> 4. 発展編

#### 4. 競合との差別化

日本語の競合記事は「単発解説」か「包括的だが分量が多い」のどちらか。案Aは:

- **1記事1概念の原則を厳守**: 消化しやすい分量
- **ストーリー性**: TODOアプリが「成長」していく物語
- **Perl入学式卒業生に最適化**: 既知事項を前提とした解説

#### 5. 内部リンクの自然な活用

- 第5回（DBI導入）: → [DBI/DBIx::Class入門](/2025/12/13/000000/)
- 第10回（Getopt::Long）: → [Perlでのコマンドライン引数処理](/2025/12/21/000000/)
- 随所でエラーハンドリング: → [Try::Tiny](/2025/12/14/000000/)

### 代替案の選択指針

- **案B**: 読者が「すぐに使えるツールを作りたい」場合、またはDBの経験がある場合に推奨
- **案C**: 読者が「特定の機能だけ知りたい」場合、リファレンス的に使いたい場合に推奨

---

## 付記

### 全案共通の設計原則

1. **コード例は各回2つまで**: 集中できる分量を維持
2. **新しい概念は各回1つまで**: 1記事1概念の原則を厳守
3. **推奨タグは3つ程度**: 英語小文字・ハイフン形式
4. **UTF-8対応を徹底**: 日本語環境での動作を保証

### 使用モジュール一覧

| モジュール | 用途 | コアモジュール |
|-----------|------|--------------|
| DBI | データベースアクセス | × |
| DBD::SQLite | SQLiteドライバ | × |
| Getopt::Long | コマンドライン引数 | ○ |
| Try::Tiny | 例外処理 | × |
| Encode | 文字コード変換 | ○ |

### 依存関係管理

cpanfileの例:

```perl
requires 'DBI', '1.643';
requires 'DBD::SQLite', '1.74';
requires 'Try::Tiny', '0.31';
```

関連記事: [Carton/cpanfile - モダンなPerl依存関係管理](/2025/12/10/000000/)

---

**作成日**: 2025年12月30日  
**調査結果参照元**: `content/warehouse/perl-cli-todo-list-research.md`  
**担当**: perl-monger エージェント
