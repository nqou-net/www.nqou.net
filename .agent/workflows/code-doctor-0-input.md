---
description: コードドクターシリーズ：テーマ・患者・症状の多角的検討 (Phase 0)
---

# Code Doctor: Input Design

> **目的**: Phase 1 の前段として、テーマ・患者・症状の3要素に対し
> 王道・革新・逆転の3案を生成し、多角的に評価して最適な組合せを選定する。

## 概要

デザインパターン名のみの入力から、高品質な記事の土台となる「テーマ」「患者像」「症状」を体系的に導き出します。各要素で**3つの異なるアプローチ**を検討し、5軸のスコアリングで最適な組合せを選定することで、Phase 1 への入力品質を保証します。

---

## Step 0: 入力情報の確認

1. **デザインパターン名**: ユーザーから確認（例: Observer, Strategy, Factory Method）
2. **Slug**: パターン名のケバブケース（例: `observer`, `factory-method`）
3. **知見ファイルの読み込み**:

// turbo
```bash
cat agents/knowledge/planning-insights.md 2>/dev/null | head -100
```

- 存在する場合: 過去の成功・失敗パターンを参照
- 存在しない場合: 初回実行として続行

4. **既存シリーズとの重複チェック**:

// turbo
```bash
cat PLANNING_STATUS.md | grep -E "^\|.*\|.*\|" | tail -n +2
```

- 同一パターンが既出の場合は題材・切り口の差別化を意識

---

## Step 1: テーマ3案の生成

**Sub-Agent Context**: `ThemeCurator`
デザインパターンの適用先として、3つの異なるアプローチでテーマを提案してください。

### 生成ルール

| 案 | アプローチ | 方針 |
|----|-----------|------|
| **案A（王道）** | 標準的・教科書的 | 広く認知されている適用例。読者が即座にイメージできる安定感のあるテーマ |
| **案B（革新）** | 新視点・実験的 | あまり取り上げられない斬新な適用領域。「そこにこのパターン？」という驚き |
| **案C（逆転）** | 逆説的・意外 | 一見パターンと無関係に見えるが、深い洞察で繋がるテーマ。記憶に残るインパクト |

### 各案の必須項目

- **テーマ名**: 具体的な題材（例: 気象観測データ、ゲームの状態管理）
- **一行説明**: テーマの概要
- **パターンとの接点**: なぜこのパターンが必要になるか
- **読者像**: このテーマに共感しやすい読者層

### 出力例

```markdown
## テーマ3案

### 案A（王道）: ゲームのキャラクター生成
- 一行説明: RPGで職業ごとに異なるキャラクターを生成する
- パターンとの接点: キャラクター種別ごとの生成ロジックを分離
- 読者像: ゲーム開発経験者、OOP学習中の中級者

### 案B（革新）: IoTセンサーのデータパイプライン
- 一行説明: 異なるセンサー種別に応じたデータ処理の切り替え
- パターンとの接点: センサー追加時に既存コードを変更しない拡張性
- 読者像: 組み込み・IoT開発者、マイクロサービス設計者

### 案C（逆転）: 料理レシピの自動変換
- 一行説明: アレルギー対応で材料を代替品に差し替える
- パターンとの接点: 代替ルールを外部化し、元レシピに触れない設計
- 読者像: 日常的な例で理解したい初学者
```

---

## Step 2: 患者3案の生成

**Sub-Agent Context**: `PatientDesigner`
各テーマ案との相性を考慮しつつ、3タイプの患者像を設計してください。

### 生成ルール

| 案 | アプローチ | 方針 |
|----|-----------|------|
| **案A（王道）** | 共感型 | 経験の浅い若手エンジニア。読者が自分を重ねやすい「あるある」キャラ |
| **案B（革新）** | 意外型 | 一見スキルが高そうなのに特定の盲点がある中堅・ベテラン |
| **案C（逆転）** | ギャップ型 | 技術以外の強みがあるが、コードになると別人になるタイプ |

### 各案の必須項目

- **属性**: 年齢、職種、エンジニア歴
- **性格キーワード**: 3つ程度
- **背景**: なぜそのコードを書いたか（動機・事情）
- **主訴**: 患者自身が感じている悩み（技術用語ではなく感情で）
- **コメディポテンシャル**: この患者像で生まれそうなギャグ・勘違い

---

## Step 3: 症状3案の生成

**Sub-Agent Context**: `SymptomAnalyst`
デザインパターンが解決するアンチパターン・コードスメルを、3つの切り口で症状化してください。

### 生成ルール

| 案 | アプローチ | 方針 |
|----|-----------|------|
| **案A（王道）** | 典型症状 | そのパターンの教科書的ユースケース。明確でわかりやすい |
| **案B（革新）** | 複合症状 | 複数の問題が絡み合った現実的なケース。解きほぐす過程が面白い |
| **案C（逆転）** | 潜伏症状 | 一見問題なさそうに見えるが、拡張時に爆発する時限爆弾型 |

### 各案の必須項目

- **技術的症状**: 具体的なコードの問題（例: switch文が20分岐）
- **医療メタファー**: 技術症状を医療用語に翻訳（例: 「腫瘍の増殖」）
- **重症度**: 軽症 / 中症 / 重症
- **Before/Afterの見込み**: リファクタリング前後でどう変わるか
- **読者の「あっ」ポイント**: 読者が自分のコードを振り返る瞬間

---

## Step 4: 多角的評価

### 4.1 評価軸

以下の5軸で各案をスコアリング（各1〜5点、合計25点満点）：

| # | 評価軸 | 観点 |
|---|--------|------|
| ① | **読者共感度** | ターゲット読者が「あるある」と感じるか。身近さと実用性 |
| ② | **医療メタファー適合度** | コードドクターの世界観（診察・処方・手術）と自然に噛み合うか |
| ③ | **コメディ発展性** | 勘違いシーン、ボケ・ツッコミ、キャラ間の掛け合いに発展できるか |
| ④ | **技術的教育価値** | パターンの本質（なぜ必要か、いつ使うか）を的確に伝えられるか |
| ⑤ | **差別化・独自性** | 既存の解説記事や過去のシリーズ記事と差別化できるか |

### 4.2 評価方法

**Step-Back思考**: まず「この記事で読者に何を持ち帰ってもらいたいか」を再定義してから評価に入る。

各要素（テーマ・患者・症状）ごとに3案を評価し、要素間の**相乗効果**も考慮：

```markdown
## テーマ評価

| 評価軸 | 案A（王道） | 案B（革新） | 案C（逆転） |
|--------|:-----------:|:-----------:|:-----------:|
| ① 読者共感度 | 4 | 3 | 2 |
| ② メタファー適合度 | 3 | 4 | 5 |
| ③ コメディ発展性 | 3 | 3 | 5 |
| ④ 教育価値 | 5 | 4 | 3 |
| ⑤ 差別化 | 2 | 4 | 5 |
| **合計** | **17** | **18** | **20** |
| **推奨理由** | 安定感 | バランス良 | 記憶に残る |
```

> 同様のテーブルを**患者**と**症状**についても作成。

### 4.3 相乗効果の検討

最高スコアの案同士を組み合わせた上で、**組合せとしての整合性**を検証：

- テーマ × 患者: この患者がこのテーマを扱うのは自然か？
- テーマ × 症状: このテーマでこの症状が発生するのはリアルか？
- 患者 × 症状: この患者がこの症状のコードを書くのは説得力があるか？

> [!TIP]
> 最高スコアの組合せに不整合がある場合は、次点の案との組合せも検討する。
> **スコアの絶対値より、3要素の整合性が優先**される。

---

## Step 5: 最適組合せの選定

### 5.1 選定結果の提示

```markdown
## 選定結果

### 採用案
- **テーマ**: 案C「料理レシピの自動変換」（20点）
- **患者**: 案B「10年目の基盤エンジニア」（19点）
- **症状**: 案A「switch文20分岐」（18点）
- **総合スコア**: 57/75

### 選定理由
テーマの意外性（逆転）と患者の深みのある背景（革新）が組み合わさることで、
表面的な面白さと技術的な深さの両立が期待できる。症状は王道を選択し、
読者が技術的内容を確実に理解できるバランスを取った。

### 3要素の整合性
- テーマ × 患者: ✅ 基盤エンジニアが社内ツールとしてレシピ変換を作るシナリオは自然
- テーマ × 症状: ✅ アレルギー種別ごとのswitch分岐は具体的でリアル
- 患者 × 症状: ✅ 経験豊富だが「動いてるから触りたくない」心理で肥大化した症状に説得力あり
```

### 5.2 ユーザー確認

選定結果をユーザーに提示し、以下を確認：
- 採用案で問題ないか
- 調整・変更の希望はあるか
- 別の組合せを試したいか

> ユーザーが承認するまで Phase 1 に進まない。

---

## Step 6: 保存

選定結果を以下のパスに保存：

```
agents/code-doctor-series/<slug>/input-design.md
```

### 保存フォーマット

```markdown
# Input Design: <Design Pattern名>

## 選定結果

| 要素 | 採用案 | スコア |
|------|--------|--------|
| テーマ | <テーマ名>（<王道/革新/逆転>） | XX/25 |
| 患者 | <患者概要>（<王道/革新/逆転>） | XX/25 |
| 症状 | <症状概要>（<王道/革新/逆転>） | XX/25 |

## テーマ詳細
<選定されたテーマの全項目>

## 患者詳細
<選定された患者の全項目>

## 症状詳細
<選定された症状の全項目>

## 評価サマリー
<各要素の評価テーブルと相乗効果の検証結果>

## 不採用案（参考）
<不採用となった案の概要とスコア>
```

> この `input-design.md` が Phase 1 (`/code-doctor-1-profile`) への入力となる。

---

## 注意事項

> [!IMPORTANT]
> **3案は互いに独立であること**: 王道・革新・逆転は異なるベクトルの案であり、
> 「王道の微調整」のような案は生成しない。各案が本質的に異なるアプローチを取ること。

> [!WARNING]
> **スコアだけで判断しない**: 評価スコアはあくまで議論の出発点。
> 3要素の相乗効果と整合性を最優先とし、必要なら次点案との組合せも検討する。

> [!TIP]
> **ユーザーの直感も尊重**: スコアが低くても「この案が面白い」というユーザーの
> 直感は重要なシグナル。評価軸では測れない魅力がある可能性がある。
