---
description: "コードドクターシリーズ記事を作成するワークフロー（Phase 4: 執筆）"
---

# Code Doctor: Narrative Writing

> [!IMPORTANT]
> **このフェーズで初めて完全なキャラクター設定を参照します。**
> Phase 1〜3では情報を絞って「指示の希釈化」を回避しています。

> **キャラクター設定（完全版）**: [code-doctor-characters.md](../../agents/knowledge/code-doctor-characters.md)
> **連載構造案**: `agents/code-doctor-series/<slug>/plot.md` (Phase 2の結果)
> **実装コード**: `agents/code-doctor-series/<slug>/tests/` (Phase 3の結果)

## 概要

Phase 1~3の素材を統合し、実際に記事本文（Markdown）を執筆します。
※ `<slug>` はデザインパターン名のケバブケース（例: `factory-method`）です。Phase 1~3 で生成されたものと一致させてください。

## Step 1: 執筆エージェントのセットアップ

**Sub-Agent Context**: `Ghostwriter`
あなたは熟練の小説家兼テクニカルライターです。

> [!CAUTION]
> 執筆前に必ず `code-doctor-characters.md` を読み込むこと。

### 厳守ルール

| ルール | 説明 | 違反例（NG） | 正解例（OK） |
|--------|------|-------------|-------------|
| **患者ナレーション** | 地の文は患者の一人称のみ | 「ドクターは〜と思った」 | 「僕には〜に見えた」 |
| **助手の呼称** | 「助手」または「ナナコ」 | 「女性が〜」「彼女は〜」 | 「助手のナナコが〜」 |
| **助手の敬語** | 患者への発言は敬語必須 | 「〜だよ」「〜なの」 | 「〜ですよ」「〜ですね」 |
| **ドクターの発話** | 1文以内、技術用語のみ | 「つまり、これは〜」 | 「結合度。高すぎる」 |

- **Voice**: 患者の一人称（Phase 1で設定）。
- **Rule**: ドクターの内面は描写しない。あくまで「見えたまま」を書く。
- **Tone**: 技術的な解説の正確さと、物語としての面白さを両立させる。

## Step 2: タイトル生成

### フォーマット
```
コードドクター: {PatternName} - {MedicalMetaphor}と{ThemeMetaphor}
```

### 3要素の定義

| 要素 | 説明 | 例 |
|------|------|-----|
| **PatternName** | デザインパターン英語名 | Singleton, Factory Method, Adapter |
| **MedicalMetaphor** | 症状・病名・処置の比喩（Phase 1/2で確定） | 多重人格症候群、癒着分離手術、適合不全 |
| **ThemeMetaphor** | 技術的課題・解決の比喩表現 | 唯一の真実、疎結合の誕生 |

### 例
- `コードドクター: Singleton - 多重人格症候群と唯一の真実`
- `コードドクター: Factory Method - 癒着分離手術と疎結合の誕生`
- `コードドクター: Adapter - 適合不全症候群とレガシー血管の変換`
- `コードドクター: Flyweight - 肥満症と1万体の分身ダイエット`

### Checklist
- [ ] 「コードドクター:」で始まっているか？
- [ ] パターン名が英語で含まれているか？
- [ ] 医療メタファーが含まれているか？
- [ ] テーマの比喩表現が含まれているか？

## Step 3: 章ごとの執筆

Phase 2のプロットに従って書き進めます。

### II. 検査 & III. 処置 の執筆ポイント
コードブロックを挿入する際は、前後に**会話**を挟んでください。
- **Before Code**: 患者が自信なさげに提示する、またはドクターが無言で指差す。
- **After Code**: 助手がその仕組みを解説する、またはドクターが短く本質を突く。

## Step 4: 医療メタファーの徹底

**Checklist**:
- [ ] 「リファクタリング」 → 「手術」「治療」と言い換えているか？
- [ ] 「バグ」「スパゲッティコード」 → 「患部」「癒着」「腫瘍」などと言い換えているか？
- [ ] 見出しが「第1章」などになっていないか？（「診断」「処方」などのメタファー見出しにする）

## Step 5: 処方箋まとめ（Prescription Summary）の追加

記事の末尾に、必ず以下のフォーマットで「処方箋まとめ」を追加してください。

### フォーマット

1. **水平線**: `---`（本文との区切り）
2. **見出し**: `## 処方箋まとめ`
3. **適用基準テーブル**: `| 症状 | 適用すべき | 経過観察 |`（✓で判定）
4. **治療のステップ**: `### 治療のステップ` + 番号付きリスト
5. **助手メッセージ**: 以下のルールに従うこと
   - 見出し: `### 助手より`
   - 内容: 技術的な励ましや、ドクターの厳しさへのフォロー、あるいは患者の今後の活躍を祈る**温かい一言**
   - 口調: **ですます調**必須
   - 署名: メッセージの最終行に **`——ナナコ`** を必ず付ける（全角ダッシュ2つ + ナナコ）


## Output Notations

ファイルパス: `content/post/YYYY/MM/DD/NNNNNN.md`
Markdown形式。
**Categories & Tags Rule**:
- MUST be in English.
- MUST be in kebab-case (e.g., `design-pattern`, `factory-method`).

