---
description: コードドクターシリーズ記事を作成するワークフロー（パターン名のみで自動生成対応）
---

# コードドクターシリーズ作成ワークフロー

> キャラクター設定: [code-doctor-characters.md](../../agents/knowledge/code-doctor-characters.md)
> シリーズ管理: PLANNING_STATUS.md § コードドクターシリーズ

---

## 概要

このワークフローは「コードドクター」シリーズ記事を作成します。
3人の登場人物（コードドクター・助手・患者）による会話劇形式で、
デザインパターンを医療メタファーで解説する記事形式です。

---

## Step 0: キャラクター設定の確認

// turbo
```bash
cat agents/knowledge/code-doctor-characters.md | head -100
```

**必ず確認すべき設定**:
- コードドクター: 体言止め、モノローグ担当、勘違いシーン
- 助手: 翻訳・説明役、情に絆されやすい、恋愛感情なし
- 元ネイルサロン設定

---

## Step 1: 入力判定とGenerator呼び出し

### 入力形式の自動判定

ユーザー入力を確認し、以下のいずれかを判定:

| 入力形式 | 判定条件 | 処理 |
|----------|----------|------|
| **最小入力** | `デザインパターン` のみ指定 | → Generator 自動実行 |
| **詳細入力** | `テーマ` や `症状` も指定 | → ユーザー指定値を使用 |
| **構造案指定** | `構造案` ファイルを指定 | → 指定ファイルを読み込み |

### 最小入力の場合: Generator 実行

// turbo
```bash
cat agents/prompts/pattern-dna-generator-prompt.md
```

**Generator に渡す情報**:
- デザインパターン名

**Generator が生成する情報**:
- 症状リスト（3つ）
- 推奨テーマ
- 患者プロファイル

**生成指示**:
入力されたパターン名に対して、`pattern-dna-generator-prompt.md` の「症状カタログ」セクションから該当する症状を抽出し、最適なテーマと患者プロファイルを決定する。

### 生成結果の確認

生成された症状・テーマ・患者プロファイルをユーザーに提示し、確認を得る。
問題なければ Step 2 に進む。

---

## Step 2: 構造案の作成

`/planning-v3`（パターンDNA解析）で構造案を作成。

**コードドクター向け設定**:
- テーマ: 医療メタファー（診断・手術・退院）
- 各章: 症状→診断→処方→手術の流れ

---

## Step 3: Phase実行

通常の統合版ワークフローに沿って実行:

1. `/series-unified-prepare` - 準備
2. `/series-unified-code` - コード実装
3. `/series-unified-write` - 原稿作成（**キャラクター設定を反映**）
4. `/series-unified-review` - レビュー

---

## Step 4: 原稿作成時の注意

### ストーリー構成

1. **冒頭**: 緊急搬送シーン「先生、患者さんです！」
2. **診断**: 問診→症状特定→処方箋
3. **手術**: ドクター指示→コード→助手の解説→患者の反応
4. **退院**: 最終成績表→注意事項→次回予告
5. **エピローグ**: コーヒーを差し出す助手、次の患者

### 勘違いシーンの入れ方

- コーヒーを差し出す → 「彼女なりの愛情表現だろう」
- 心配そうな表情 → 「私のことを…」（実際は患者への心配）
- 遅くまで残る → 「私と一緒にいたいのか」

### セリフの書き方

| キャラ | 特徴 |
|--------|------|
| ドクター | 「重症」「次」「心配ない」（短文・体言止め） |
| 助手 | 「つまりですね…」「患者さん、大丈夫ですよ」 |
| 患者 | 「こ、これだけ？」「せ、先生…」（怯えながら） |

---

## Step 5: タグ設定

必須タグ:
- `code-doctor`
- `design-patterns`
- パターン名（例: `strategy-pattern`）

---

## Step 6: PLANNING_STATUS.md 更新

「コードドクターシリーズ」セクションに追加。

---

## プロンプト例

### 最小入力（パターン名のみ）★推奨

```
@[/code-doctor-series]

- デザインパターン: Singleton
```

→ 症状・テーマ・患者プロファイルは Generator が自動生成

### 基本形（テーマ指定）

```
@[/code-doctor-series]

- デザインパターン: State
- テーマ: ゲームキャラクターの状態管理
```

→ 症状は自動生成、テーマはユーザー指定を使用

### 詳細版（症状も具体的に記述）

```
@[/code-doctor-series]

- デザインパターン: Observer
- テーマ: イベント通知システム
- 症状:
  - イベント発生時に全オブジェクトをループで通知
  - 新しい通知先を追加するたびに既存コードを修正
  - 通知の順序が制御できない
- 患者の背景: ソーシャルゲームのプッシュ通知システム担当
- 公開日時: 2026-02-23T00:00:00+09:00
- 挿絵: あり
```

### 複数パターン治療

```
@[/code-doctor-series]

- デザインパターン: Command + Memento
- テーマ: Undo/Redoシステム
- 症状:
  - 操作履歴が配列に直接保存されている
  - 元に戻すロジックが各操作に散在
  - 履歴の上限管理ができない
- 患者の背景: お絵かきアプリの開発者
- 公開日時: 2026-03-02T00:00:00+09:00
- 挿絵: なし
```

### パターンDNA解析から派生

```
@[/code-doctor-series]

- 構造案: agents/structure/pattern-dna-factory-method.md
- 採用案: 案A
- 公開日時: 2026-03-09T00:00:00+09:00
- 挿絵: なし
```
