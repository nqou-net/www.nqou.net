---
description: コードドクターシリーズ：レビューと仕上げ (Phase 5)
---

# Code Doctor: Medical Board Review

## 概要

書き上がった原稿が「コードドクターシリーズ」の品質基準を満たしているか、厳格な基準で査読します。
**1つでも不合格項目があれば差し戻し対象**です。

参照ファイル: `agents/code-doctor-series/<slug>/`（`<slug>`はデザインパターン名のケバブケース）

---

## Step 0: フロントマター検証

**Sub-Agent Context**: `Reviewer_Frontmatter`

### タイトル規約

- [ ] 形式: `コードドクター【<パターン名>】<医療メタファー>〜<テーマ>〜`
- [ ] パターン名は正式名称（英語）
- [ ] 医療メタファーと記事内容の整合性がある

**NG例**:
- `コードドクター：Singletonパターン` → 【】で囲んでいない、メタファーなし
- `コードドクター【Singleton】孤独なインスタンス` → `〜テーマ〜`形式でない

### タグ規約

- [ ] 英語・ケバブケース（例: `design-pattern`, `perl`）
- [ ] 必須タグ: `design-pattern`, `perl`, `code-doctor`
- [ ] パターン名タグ: パターン名のケバブケース（例: `singleton`, `factory-method`）
- [ ] 禁止: 日本語タグ、キャメルケース、スネークケース

### カテゴリ規約

- [ ] 英語・ケバブケース
- [ ] `tech` カテゴリに所属

### 日付・slug

- [ ] 日付形式: ISO 8601（`YYYY-MM-DDTHH:MM:SS+09:00`）
- [ ] slugは未設定（Hugoが自動生成）

---

## Step 1: キャラクター一貫性チェック

**Sub-Agent Context**: `Reviewer_Character`

### ドクター検証（最厳格）

- [ ] **発言スタイル**: **体言止め・名詞句中心**（長い文章は禁止）
- [ ] **用語制限**: 技術用語・医療用語**のみ**使用可（比喩・例え話・日常会話は禁止）
- [ ] **口調**: ぶっきらぼう、無愛想、技術的/医学的な事実のみを告げる
- [ ] **推奨パターン**:
  - 「……不整脈（Arrhythmia）」
  - 「……野蛮（Barbaric）だ」
  - 「カプセル化（Encapsulation）の欠如」
- [ ] **禁止パターン**:
  - 「〜ですね」「〜でしょう」などの丁寧語
  - 「例えば」「つまり」「〜ということです」などの説明的表現
  - 患者への共感表現（「大変でしたね」等）
  - 「〜しましょう」（勧誘表現）
  - 接続助詞でつなげた長い文

### 助手（ナナコ）検証

- [ ] **呼称ルール**: 地の文で「助手」または「ナナコ」と呼ばれている（「女性が〜」「彼女は〜」は**禁止**）
- [ ] **役割**: ドクターの技術的/医学的発言を、患者に分かるように「翻訳・代弁」する
- [ ] **タイミング**: ドクターの発言**直後**に必ずフォローを入れる
- [ ] **表現力豊かに**:
  - 単なる「〜と言っています」の繰り返しを避ける
  - 「〜と嘆いています」「〜と激怒しています」「〜という美学ですね」など、感情やニュアンスを込める
  - 医療メタファーを強調して説明する
- [ ] **敬語必須**: 患者への発言は「〜ですね」「〜ですよ」「〜ましょう」（タメ口は禁止）

### 患者（語り手）検証（最重要）

- [ ] **全文が患者の一人称視点**（私/僕/自分）
- [ ] **三人称ナレーションなし**（神の視点禁止）
- [ ] 他キャラクターの心理描写なし
- [ ] 禁止表現チェック:
  - ×「ドクターは〜と思った」
  - ×「助手は〜を考えていた」
  - ×「ドクターには〜が分かっていた」（他人の認識を断定）
  - ○「ドクターが〜と言った」（発言の引用はOK）
  - ○「〜のように見えた」「〜気がした」（推測はOK）

---

## Step 2: メタファー強度チェック

**Sub-Agent Context**: `Reviewer_Metaphor`

### 見出し検証

- [ ] **全見出し**が医療メタファー
- [ ] **禁止用語リスト**:
  - `実装`, `コード`, `解説`, `説明`, `まとめ`, `おわりに`, `はじめに`
  - `クラス`, `メソッド`, `関数`, `モジュール`
  - `サンプル`, `例`, `デモ`

### 見出し例（推奨 / 禁止）

| 禁止 | 推奨 |
|------|------|
| `## 実装` | `## 処方箋の調合` |
| `## まとめ` | `## 退院のご案内` |
| `## サンプルコード` | `## 投薬記録` |

### 世界観一貫性

- [ ] 来院/往診の設定が記事全体で統一
- [ ] **クリニック設定**: 雑居ビル2階、看板なし、ドアプレートに「コード診療所」のみ
- [ ] 医療用語の一貫性（「処方」と「治療」の混在注意）
- [ ] 技術用語が裸で出現していない（メタファーで包む）

### 舞台設定と行動の整合性

来院/往診の設定に応じて、**誰が去り、誰が留まるか**が逆転する。全シーンで以下をチェック：

- [ ] **「帰り支度」の主語**: 来院→患者、往診→ドクター（逆は不合格）
- [ ] **退場シーンの主語**: ドアを開けるのは「去る側」の人物か
- [ ] **患者の所有物**: 来院時に「患者のデスク」「自席」等は存在し得ない（持込品のみ）
- [ ] **ドクターの行動**: 来院時にドクターが「鞄を持ち上げる」「帰り支度」は矛盾
- [ ] **退場後の描写**: 来院→患者が廊下へ出る、往診→ドクターが去り患者は自席に残る
- [ ] **扉の開閉動詞**: クリニックの鉄扉は**外開き**。入室=「引く」/退室=「押す」（逆は不合格）

---

## Step 3: 技術的正確性チェック

**Sub-Agent Context**: `Reviewer_Tech`

### コード検証

- [ ] `use v5.36;` または `use feature` による最新機能有効化
- [ ] `use warnings;` / `use strict;` 相当が有効
- [ ] シグネチャ構文（`sub foo($bar, $baz)`）使用時は`use feature 'signatures'`
- [ ] コード内コメントとストーリーの整合性
- [ ] Before/Afterコードの差分が明確

### パターン適用検証

- [ ] GoFパターン定義との整合性
- [ ] パターンの適用理由がストーリーで説明されている
- [ ] アンチパターン（過剰適用/誤用）になっていないか

### 実行可能性

- [ ] 提示コードが**そのまま実行可能**（コピペ動作）
- [ ] 依存モジュールがある場合は明記

### 処方箋まとめ検証

- [ ] `---`（水平線）の後に `## 処方箋まとめ` がある
- [ ] 適用基準テーブル（`| 症状 | 適用すべき | 経過観察 |`）がある
- [ ] `### 治療のステップ` に番号付きリストがある
- [ ] `### 助手より` ブロックがある
- [ ] 助手メッセージが**ですます調**で書かれている
- [ ] 助手メッセージの**最終行**に `——ナナコ` の署名がある（全角ダッシュ2つ + ナナコ）

**処方箋まとめフォーマット例**:

```markdown
---

## 処方箋まとめ

| 症状 | 適用すべき | 経過観察 |
|-----|:--------:|:------:|
| 〜の場合 | ✓ | |
| 〜の場合 | | ✓ |

### 治療のステップ

1. **ステップ名** — 説明
2. ...

### 助手より

温かいメッセージ。ですます調。

——ナナコ
```

---

## Step 4: 最終判定と修正

### 判定基準

- **合格**: 全チェック項目がパス
- **差し戻し**: 1項目以上の不合格

### 修正フロー

1. 不合格項目を一覧化
2. 各項目に対する**具体的修正案**を提示
3. 軽微な修正 → このステップで直接修正
4. 構造的な問題 → Phase 4（Writing）へ差し戻し

### 修正報告フォーマット

```markdown
## レビュー結果

### 不合格項目
- [ ] Step X: 項目名 - 問題の詳細

### 修正内容
1. 修正箇所の説明
2. Before → After の差分
```
