---
description: パターンDNA解析アプローチによる連載構造案作成ワークフロー
---

# パターンDNA解析 プランニング v3

> 参照: [WORKFLOWS.md](../../WORKFLOWS.md), [AGENTS.md](../../AGENTS.md)
> 知見ベース: [planning-insights.md](../../agents/knowledge/planning-insights.md)

---

## コンセプト

従来の「動く→破綻→パターン導入→完成」ではなく、**「問診→DNA解析→処方→投薬→経過観察」**というコードドクターのメタファーで連載を構成します。

読者は「コードドクター」として、問題のあるコードの「症状」を診察し、適切な「処方箋（パターン）」を選ぶ体験をします。

| 従来アプローチ | パターンDNA解析 |
|---------------|----------------|
| パターン名から始まる | **症状**から始まる |
| パターンを「教える」 | パターンを「診断・処方する」 |
| 1記事1概念 | 1記事1症状（→1処方） |
| 「なぜ使うか」を後付け | 「なぜ使うか」が**先**にある |

---

## Step 0: 知見の読み込み

// turbo
1. 知見ファイルの確認:
   ```bash
   cat agents/knowledge/planning-insights.md 2>/dev/null | head -100
   ```
2. 存在する場合:
   - 今回のコンテキストに関連する知見を抽出
   - 特に「症状→処方」の成功・失敗パターンに注目
3. 存在しない場合:
   - 初回実行として続行

---

## Step 1: 症状カタログ作成

### 1.1 問診票の設計

読者（患者）のコードが抱える「症状」をリスト化します。

#### 症状カテゴリ

| カテゴリ | 症状例 | 典型的な処方 |
|----------|--------|-------------|
| **複雑性の病** | if文が10個以上連なる | Strategy, State |
| **硬直性の病** | 新機能追加で既存を修正 | Open/Closed原則, Decorator |
| **重複の病** | 同じ処理が3箇所以上 | Template Method, Factory |
| **依存性の病** | クラス間が密結合 | Mediator, Observer |
| **拡張性の病** | 機能追加が困難 | Composite, Visitor |
| **状態管理の病** | 状態遷移が複雑 | State, Memento |

### 1.2 症状の具体化

ユーザーから提供された「使用パターン」に対して:

1. **逆引き**: そのパターンが解決する「症状」を3つ以上列挙
2. **重症度**: 症状の深刻さをランク付け（軽症/中症/重症）
3. **合併症**: 複数の症状が同時に現れるケース

### 1.3 出力

```markdown
## 症状カタログ

| # | 症状名 | 説明 | 重症度 | 処方候補 |
|---|--------|------|--------|---------|
| 1 | 条件分岐過多症候群 | if/switch文が10個以上 | 重症 | Strategy |
| 2 | ... | ... | ... | ... |
```

---

## Step 2: DNA解析マップ構築

### 2.1 症状と処方の対応表

各症状に対して、どのパターンが「処方」として有効かをマッピングします。

```markdown
## DNA解析マップ

### パターン: Strategy
- **適応症状**: 条件分岐過多症候群、アルゴリズム切り替え困難症
- **禁忌**: 分岐が2-3個程度の軽症例（過剰投薬）
- **副作用**: クラス数の増加

### パターン: Observer
- **適応症状**: 状態変化の伝達不全、密結合依存症
- **禁忌**: 単一方向の単純な通知（simpleなコールバックで十分）
- **副作用**: デバッグ時の追跡困難
```

### 2.2 遺伝子型（症状の組み合わせ）

複数の症状が同時に現れる「遺伝子型」を定義:

| 遺伝子型 | 構成症状 | 複合処方 |
|----------|---------|---------|
| Type-A | 条件分岐過多 + 拡張困難 | Strategy + Factory |
| Type-B | 状態複雑 + 履歴不在 | State + Memento |

---

## Step 3: 競合・内部リンク分析

### 3.1 既存シリーズとの重複チェック

// turbo
```bash
cat PLANNING_STATUS.md | grep -E "^\|.*\|.*\|" | tail -n +2
```

同じ症状×同じ処方の組み合わせは**重複**として回避。

### 3.2 差別化ポイント

- 従来の「手で覚える」シリーズとの違いを明確化
- 「診断・処方」というメタファーによる独自性

---

## Step 4: 処方箋設計（連載構造案）

### 4.1 治療計画の3案作成

| 案 | 治療方針 | 特徴 |
|----|----------|------|
| **案A（標準治療）** | 1症状1回で段階的に | 安定、初心者向け |
| **案B（集中治療）** | 重症例から着手 | インパクト大、中級者向け |
| **案C（予防医学）** | 軽症→重症の順 | 教育的、予防意識を醸成 |

### 4.2 連載構造表（各案）

```markdown
### 案A: 標準治療プラン

| 回 | 症状名 | 診断 | 処方 | Before/After |
|----|--------|------|------|--------------|
| 1 | 導入: コードドクターになろう | - | - | - |
| 2 | 条件分岐過多症候群 | if文10個以上 | Strategy | 行数-30%, 複雑度-50% |
| 3 | ... | ... | ... | ... |
| N | 退院: 健康なコードとは | 総括 | - | 全体メトリクス |
```

### 4.3 メトリクス設計（必須）

各回で以下のBefore/After比較を含める:

- **行数**: コード行数の変化
- **複雑度**: 循環的複雑度（McCabe）
- **結合度**: クラス間依存の数
- **テスト容易性**: モック可能な箇所の数

### 4.4 各案の必須項目

- 治療テーマ（題材）
- USP（独自の価値提案）
- 推奨タグ（5個まで）
- meta description（120文字以内）
- 想定される批判と回答

---

## Step 4.5: ステータス登録

構造案を PLANNING_STATUS.md に登録:

```markdown
| [<slug>.md](agents/structure/<slug>.md) | <タイトル> | 📝 計画中 | - | YYYY-MM-DD | YYYY-MM-DD |
```

---

## Step 5: レビューサイクル

### 5.1 3段階レビュー

| 回 | 焦点 | チェック項目 |
|----|------|-------------|
| 1回目 | **診断精度** | 症状→処方の対応は適切か、過剰/過少処方はないか |
| 2回目 | **治療効果** | Before/Afterメトリクスは現実的か、効果は測定可能か |
| 3回目 | **患者体験** | 読者（患者）視点で理解しやすいか、メタファーは一貫しているか |

### 5.2 レビューチェックリスト

#### 診断精度レビュー
- [ ] 各症状に対する処方が適切か
- [ ] 過剰な処方（シンプルな問題に複雑なパターン）がないか
- [ ] 禁忌事項が明記されているか

#### 治療効果レビュー
- [ ] Before/Afterの数値が現実的か
- [ ] 改善効果が測定可能か
- [ ] 副作用（トレードオフ）が説明されているか

#### 患者体験レビュー
- [ ] 「コードドクター」メタファーが一貫しているか
- [ ] 用語が統一されているか（症状、処方、投薬など）
- [ ] 読者が自分のコードに適用できるか

---

## Step 6: 知見の記録

### 6.1 振り返り

| カテゴリ | 内容 |
|----------|------|
| 成功パターン | 効果的だった症状→処方の対応 |
| 失敗パターン | 避けるべき過剰処方例 |
| 新しい発見 | 予想外に効果的だった診断アプローチ |

### 6.2 知見の記録

`agents/knowledge/planning-insights.md` に追記

---

## 次のワークフロー

| タイプ | 次のワークフロー |
|--------|------------------|
| シリーズ記事（統合版） | `/series-unified-write` |
| シリーズ記事（連載版） | `/series-article-writing` |

---

## 注意事項

> [!WARNING]
> **過剰処方に注意**: 「この症状には必ずこのパターン」という単純化を避ける。
> 軽症例には「経過観察」（パターン未使用）も選択肢として提示する。

> [!TIP]
> **メタファーの一貫性**: 「症状」「処方」「投薬」「副作用」などの医療用語を
> 記事全体で統一して使用することで、読者の記憶に残りやすくなる。
