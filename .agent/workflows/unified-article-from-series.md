---
description: 連載構造案から1つの統合記事を作成するワークフロー（複数回の連載を1記事に統合）
---

# 連載構造案から1つの記事を作成するワークフロー

> 参照: [WORKFLOWS.md](../../WORKFLOWS.md), [AGENTS.md](../../AGENTS.md), [SERIES.md](../../SERIES.md)

---

## 概要

連載構造案（全N回）の内容を、1つの長編記事として統合するワークフロー。

- 連載の各回は「章」として構成
- 1章あたり1つの概念を導入（1記事1概念の原則を継承）
- ストーリー構成: 動く→破綻→パターン導入→完成

---

## フェーズ構成

| Phase | 内容 |
|---|---|
| 1 | 構造確認: 連載構造案の読み込み・確認 |
| 2 | 統合設計: 章構成の決定、全体アウトラインの作成 |
| 3 | 原稿作成: 各章の執筆、コード例の統合 |
| 4 | 挿絵・図の追加: アイキャッチ、Mermaid図 |
| 5 | レビュー: 3回の品質レビュー・改善サイクル |
| 6 | コード検証: 動作確認、警告なしの確認 |
| 7 | 最終確認: 校正、公開準備 |

---

## Phase 1: 構造確認

### 入力

- 連載構造案ファイル: `agents/structure/<slug>.md`
- 調査ドキュメント: `content/warehouse/<slug>.md`

### 確認項目

1. 連載構造案の読み込み
2. 推薦案の確認（案A/B/Cのいずれか）
3. 連載構造表の確認:
   - 回数、タイトル、新概念、ストーリー、コード例
4. 調査ドキュメントとの整合性確認

---

## Phase 2: 統合設計

### 章構成の決定

連載の各回を章に変換:

| 元の回 | 章 | 役割 |
|---|---|---|
| 第1回 | 第1章: 基礎編 | 最小限の動くコードを作成 |
| 第2回 | 第2章: 問題発見編 | 破綻の認識、問題点の整理 |
| 第3回 | 第3章: パターン1導入 | 最初のパターンで部分解決 |
| 第4回 | 第4章: パターン2導入 | 2つ目のパターンで補完 |
| 第5回 | 第5章: 統合編 | パターン間の協調、完成 |
| 第6回 | 第6章: 応用編 | 実用的な拡張、おまけ機能 |

### 全体アウトライン作成

1. 導入部:
   - 記事の目的、対象読者、学習目標
   - 使用技術（Perl v5.36, Moo）
   - 完成イメージ
2. 各章の概要
3. まとめ: 学んだこと、応用例

---

## Phase 3: 原稿作成

### 各章の執筆ルール

1. 章タイトル: `## 第N章: タイトル`
2. 章内セクション: `### セクション名`
3. 新概念の導入: 章の冒頭で明示
4. コード例:
   - 各章に最大2つ
   - 言語タグ、バージョン、依存明記
   - 章の最後に完成コードを提示（原則1ファイル）

### 文体規則

- 本文: 書き言葉、です・ます調
- 箇条書き: だ・である調、末尾句点なし
- 強調表現（**太字**）は使用しない
- 遊び心ある表現（括弧書き補足、軽いツッコミ）

### ストーリー構成

- 第1章: 動くコードを作る（成功体験）
- 第2章: 機能追加で破綻（問題認識）
- 第3章: パターン1で部分解決
- 第4章: パターン2で補完
- 第5章: パターン間協調で完全解決
- 第6章: 実用的な拡張

---

## Phase 4: 挿絵・図の追加

### アイキャッチ画像

1. 記事のテーマを視覚化した画像を生成
2. 保存先: `static/public_images/%Y/<slug>.png`
3. frontmatterに `image:` で指定

### Mermaid図

各章に適切な図を挿入:

| 章 | 推奨図 |
|---|---|
| 第1章 | クラス図（基本構造） |
| 第3章 | クラス図（パターン1導入後） |
| 第4章 | クラス図（パターン2導入後） |
| 第5章 | シーケンス図（パターン間協調） |

---

## Phase 5: レビュー（3回繰り返し）

### 第1回レビュー: 調査結果・構造案との整合性

- 調査ドキュメントの内容が反映されているか
- 連載構造案のストーリーに沿っているか
- 各章が1概念を守っているか

### 第2回レビュー: 品質基準確認

- SOLID原則（SRP/OCP）違反の指摘が適切か
- 破綻パターンの「なぜダメか」が具体的か
- 表現スタイル: 遊び心ある表現があるか
- Mermaid図が適切に配置されているか

### 第3回レビュー: 最終仕上げ

- 誤字脱字がないか
- 強調表現（**太字**）が使用されていないか
- コード例が正しく動作するか
- 全体の流れが自然か

---

## Phase 6: コード検証

### 検証手順

1. 検証用ディレクトリを作成: `agents/tests/<slug>/`
2. 各章のコードを抽出し、保存:
   - `lib/` - Perlモジュール
   - `t/` - テストコード
3. テスト実行: `prove -l t/`
4. 警告なしを確認

---

## Phase 7: 最終確認

1. frontmatter確認:
   - `title`, `draft`, `tags`, `description`, `image`
2. `draft: true` 維持（PR提出前）
3. 完成

---

## 出力ファイル

- 記事: `content/post/%Y/%m/%d/%H%M%S.md`
- テストコード: `agents/tests/<slug>/`
- アイキャッチ画像: `static/public_images/%Y/<slug>.png`

---

## チェックリスト

- [ ] 連載構造案を読み込んだ
- [ ] 章構成を決定した
- [ ] 各章を執筆した（1章1概念）
- [ ] ストーリー構成: 動く→破綻→パターン導入→完成
- [ ] SOLID原則（SRP/OCP）違反を具体的に指摘
- [ ] Mermaid図を追加した
- [ ] アイキャッチ画像を設定した
- [ ] レビュー3回実施した
- [ ] コード検証を実施した
- [ ] 警告なしを確認した
