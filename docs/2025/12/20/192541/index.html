<!doctype html><html lang=ja dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="GitHub Copilotのエージェント連携の成功パターンを実体験から解説。AGENTS.mdのワークフロー定義とエージェントのname/descriptionの整合性が鍵。試行錯誤から見えた3つのポイントをDeNA LLM勉強会の知見も交えて紹介する、初心者から中級者まで役立つ実践ガイド。"><title>なぜエージェント連携がうまくいくようになったのか - 観察から見えた3つの成功パターン</title><link rel=canonical href=https://www.nqou.net/2025/12/20/192541/><link rel=stylesheet href=/scss/style.min.6a692fd055deae459f2a9767f57f3855ba80cafd5041317f24f7360f6ca47cdf.css><meta property='og:title' content="なぜエージェント連携がうまくいくようになったのか - 観察から見えた3つの成功パターン"><meta property='og:description' content="GitHub Copilotのエージェント連携の成功パターンを実体験から解説。AGENTS.mdのワークフロー定義とエージェントのname/descriptionの整合性が鍵。試行錯誤から見えた3つのポイントをDeNA LLM勉強会の知見も交えて紹介する、初心者から中級者まで役立つ実践ガイド。"><meta property='og:url' content='https://www.nqou.net/2025/12/20/192541/'><meta property='og:site_name' content='nqou.net'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='ai'><meta property='article:tag' content='github-copilot'><meta property='article:tag' content='custom-agents'><meta property='article:tag' content='agents-md'><meta property='article:tag' content='prompt-engineering'><meta property='article:tag' content='workflow'><meta property='article:published_time' content='2025-12-20T19:25:41+09:00'><meta property='article:modified_time' content='2025-12-20T19:25:41+09:00'><meta property='og:image' content='https://www.nqou.net/public_images/2025/1766226341-image.jpg'><meta name=twitter:title content="なぜエージェント連携がうまくいくようになったのか - 観察から見えた3つの成功パターン"><meta name=twitter:description content="GitHub Copilotのエージェント連携の成功パターンを実体験から解説。AGENTS.mdのワークフロー定義とエージェントのname/descriptionの整合性が鍵。試行錯誤から見えた3つのポイントをDeNA LLM勉強会の知見も交えて紹介する、初心者から中級者まで役立つ実践ガイド。"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://www.nqou.net/public_images/2025/1766226341-image.jpg'><link rel="shortcut icon" href=/favicon.png><style>@import 'https://fonts.googleapis.com/css2?family=Noto+Sans+JP&display=swap';:root{--base-font-family:Arial, "Noto Sans JP", sans-serif}</style><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3923446804785015" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js defer></script><script defer>document.addEventListener("DOMContentLoaded",function(){try{typeof mermaid!="undefined"&&document.querySelector(".mermaid")&&mermaid.initialize({startOnLoad:!0,securityLevel:"strict"})}catch(e){console.warn("Mermaid failed to initialize:",e)}})</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-E50H9ESN7E"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-E50H9ESN7E")</script></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=メニューを開く・閉じる>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/images/nqounet201703_hu_138ef4f6e1904465.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>🥃</span></figure><div class=site-meta><h1 class=site-name><a href=/>nqou.net</a></h1><h2 class=site-description>Whisky, Perl, Kansai.pm</h2></div></header><ol class=menu-social><li><a href=https://github.com/nqounet target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://x.com/nqounet target=_blank title=X rel=me><svg class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/about/><svg class="icon icon-tabler icon-tabler-user" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#bababa" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>About</span></a></li><li><a href=/advent-calendar-2025/><svg class="icon icon-tabler icon-tabler-calendar" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#bababa" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><rect x="4" y="5" width="16" height="16" rx="2"/><line x1="16" y1="3" x2="16" y2="7"/><line x1="8" y1="3" x2="8" y2="7"/><line x1="4" y1="11" x2="20" y2="11"/><path d="M8 15h.01"/><path d="M12 15h.01"/><path d="M16 15h.01"/><path d="M8 19h.01"/><path d="M12 19h.01"/><path d="M16 19h.01"/></svg>
<span>Perl Advent Calendar 2025 - AI Edition</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Links</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>ダークモード</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">目次</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#はじめに---試行錯誤の先に見えたもの>はじめに - 試行錯誤の先に見えたもの</a><ol><li><a href=#最初はわからなかった>最初はわからなかった</a></li><li><a href=#転機dena-llm勉強会の資料>転機：DeNA LLM勉強会の資料</a></li><li><a href=#この記事で共有すること>この記事で共有すること</a></li></ol></li><li><a href=#観察してわかった3つの成功パターン>観察してわかった3つの成功パターン</a><ol><li><a href=#パターン1-名前と説明を明確にする>パターン1: 名前と説明を明確にする</a></li><li><a href=#パターン2-エージェント定義の場所を示す>パターン2: エージェント定義の場所を示す</a></li><li><a href=#パターン3-agentsmdにワークフローを定義する>パターン3: AGENTS.mdにワークフローを定義する</a></li></ol></li><li><a href=#dena勉強会資料から学んだプロンプト技術>DeNA勉強会資料から学んだプロンプト技術</a><ol><li><a href=#ベストプラクティスの重要性>ベストプラクティスの重要性</a></li><li><a href=#重要な部分を強調する方法>重要な部分を強調する方法</a><ol><li><a href=#優先順位の明示>優先順位の明示</a></li><li><a href=#出力形式の指定>出力形式の指定</a></li><li><a href=#太字や箇条書きの効果的な使い方>太字や箇条書きの効果的な使い方</a></li></ol></li><li><a href=#役割付与の効果>役割付与の効果</a></li><li><a href=#ハルシネーション防止>ハルシネーション防止</a><ol><li><a href=#出典を明示させる>出典を明示させる</a></li><li><a href=#不明点はわからないと答えさせる>不明点は「わからない」と答えさせる</a></li><li><a href=#エージェント定義での実践例>エージェント定義での実践例</a></li></ol></li></ol></li><li><a href=#ドメイン特化型aiという選択>ドメイン特化型AIという選択</a><ol><li><a href=#なぜ専門性を高めるのか>なぜ専門性を高めるのか</a></li><li><a href=#less-is-more---定義の粒度>Less is More - 定義の粒度</a></li><li><a href=#カスタムエージェントの実例>カスタムエージェントの実例</a></li></ol></li><li><a href=#実践このリポジトリでのワークフロー>実践：このリポジトリでのワークフロー</a><ol><li><a href=#記事作成フローの全体像>記事作成フローの全体像</a></li><li><a href=#定義ファイルを見てみる>定義ファイルを見てみる</a></li><li><a href=#運用してわかったこと>運用してわかったこと</a><ol><li><a href=#完璧を目指さない>完璧を目指さない</a></li><li><a href=#小さく始めて観察する>小さく始めて観察する</a></li><li><a href=#改善は段階的に>改善は段階的に</a></li></ol></li></ol></li><li><a href=#今後の課題と展望>今後の課題と展望</a><ol><li><a href=#まだ標準化とは言えない>まだ標準化とは言えない</a></li><li><a href=#a2aプロトコルの可能性>A2Aプロトコルの可能性</a></li><li><a href=#継続的な観察と改善>継続的な観察と改善</a></li></ol></li><li><a href=#まとめ---正しく情報を与えてあげるだけ>まとめ - 正しく情報を与えてあげるだけ</a><ol><li><a href=#成功の3つのパターン再確認>成功の3つのパターン再確認</a></li><li><a href=#プロンプトエンジニアリングの基礎>プロンプトエンジニアリングの基礎</a></li><li><a href=#あなたも今日から始められる>あなたも今日から始められる</a></li></ol></li><li><a href=#参考リンク>参考リンク</a></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/2025/12/20/192541/><img src=/public_images/2025/1766226341-image.jpg loading=lazy alt="Featured image of post なぜエージェント連携がうまくいくようになったのか - 観察から見えた3つの成功パターン"></a></div><div class=article-details><div class=article-title-wrapper><h2 class=article-title><a href=/2025/12/20/192541/>なぜエージェント連携がうまくいくようになったのか - 観察から見えた3つの成功パターン</a></h2><h3 class=article-subtitle>GitHub Copilotのエージェント連携の成功パターンを実体験から解説。AGENTS.mdのワークフロー定義とエージェントのname/descriptionの整合性が鍵。試行錯誤から見えた3つのポイントをDeNA LLM勉強会の知見も交えて紹介する、初心者から中級者まで役立つ実践ガイド。</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>12月 20, 2025</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>読了時間: 19分</time></div></footer></div></header><section class=article-content><h2 id=はじめに---試行錯誤の先に見えたもの>はじめに - 試行錯誤の先に見えたもの</h2><h3 id=最初はわからなかった>最初はわからなかった</h3><p>GitHub Copilotを使い始めて、AGENTS.mdという仕組みを知りました。「AIエージェント向けのREADME」という説明を読んで、とりあえずAIに書かせてみたのです。</p><p>最初のうちは、うまく動くこともあれば、動かないこともありました。なぜうまくいくのか、なぜ失敗するのか、理由がまったくわかりませんでした。しかし、使い続けているうちに、少しずつパターンが見えてきました。</p><p>「あ、ここを直すと動いた」「この書き方では連携がスムーズだ」——そんな小さな発見を積み重ねていくうち、3つの成功パターンが浮かび上がってきました。</p><h3 id=転機dena-llm勉強会の資料>転機：DeNA LLM勉強会の資料</h3><p>試行錯誤を続けていたある日、LLM勉強会の資料を見つけました。</p><link rel=stylesheet href=/css/linkcard.css><div class=linkcard><a class=linkcard-a href=https://engineering.dena.com/blog/2025/12/llm-study-1201/ target=_blank rel="noopener noreferrer"><div class=linkcard-image><img src=https://engineering.dena.com/blog/2025/12/llm-study-1201/cover.png alt="AIエンジニアが本気で作ったLLM勉強会資料を大公開 〜そのまま使えるハンズオン用コード付き〜 | BLOG - DeNA Engineering" loading=lazy></div><div class=linkcard-content><div class=linkcard-title>AIエンジニアが本気で作ったLLM勉強会資料を大公開 〜そのまま使えるハンズオン用コード付き〜 | BLOG - DeNA Engineering</div><div class=linkcard-description>はじめに
こんにちは、2020年に新卒入社してからDeNAでAIエンジニアをしている吉田（
@birdwatcherYT
）です。
いつもは
Qiita
に技術記事を発信しているのですが、今回は …</div><div class=linkcard-meta><img class=linkcard-favicon src=https://engineering.dena.com/favicon.ico alt onerror='this.style.display="none"'>
<span class=linkcard-domain>DeNA Engineering</span></div></div></a></div><p>特に15〜22ページの「プロンプトエンジニアリングの基礎」のセクションは目から鱗が落ちました。重要な部分の強調方法、役割付与の効果、ハルシネーション防止のテクニック——これまで感覚的にやっていたことが、理論として体系化されていたのです。</p><p>この資料を読んで、自分の試行錯誤が間違っていなかったこと、そして、もっと良い方向に進める余地があることに気づきました。</p><h3 id=この記事で共有すること>この記事で共有すること</h3><p>この記事では、私が観察から学んだ3つの成功パターンと、DeNA勉強会資料から学んだプロンプト技術を共有します。</p><ul><li>観察からわかった3つの成功パターン</li><li>勉強会資料から学んだプロンプト技術</li><li>実際のワークフロー例</li><li>今後の課題と展望</li></ul><p>あなたも、AGENTS.mdやカスタムエージェントを使ってAIエージェントを活用できるようになりましょう。</p><h2 id=観察してわかった3つの成功パターン>観察してわかった3つの成功パターン</h2><p>試行錯誤を繰り返す中で、エージェント連携を成功させるための3つのシンプルなパターンが見えてきました。</p><h3 id=パターン1-名前と説明を明確にする>パターン1: 名前と説明を明確にする</h3><p>一番最初に気づいたのは、エージェント定義における<strong>name と description の重要性</strong>です。</p><p>カスタムエージェントの定義ファイルには、YAMLフロントマターで <code>name</code> と <code>description</code> を設定します。この2つが、エージェント連携において最も重要な要素なのです。</p><p><strong>良い例</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># investigative-research.agent.md</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>investigative-research</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>調査・情報収集に深い愛とこだわりを持つ、オタク気質の専門家エージェント</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nn>---</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># proofreader.agent.md</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>proofreader</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>校正にこだわる、文章を丁寧に磨き上げることを好む専門家</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nn>---</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>悪い例</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># research.agent.md</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>research </span><span class=w> </span><span class=c># ← ワークフローで指定する名前と一致しない</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>エージェント </span><span class=w> </span><span class=c># ← 何をするのか不明確</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nn>---</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>最初のうちは、短縮名でも通じるだろうと思っていました。でも、AGENTS.mdのワークフローで指定する役割名（例: <code>investigative-research</code>）と、エージェント定義の <code>name</code> が完全に一致していないと、Copilotがうまく紐付けられないことがわかりました。</p><p>また、<code>description</code> が具体的であればあるほど、Copilotがそのエージェントの役割を正しく理解し、適切なタイミングで呼び出してくれます。</p><h3 id=パターン2-エージェント定義の場所を示す>パターン2: エージェント定義の場所を示す</h3><p>2つ目のパターンは、<strong>エージェント定義ファイルの配置場所の統一</strong>です。</p><p>カスタムエージェント定義ファイルは、<code>.github/agents/</code> ディレクトリに <code>{role}.agent.md</code> という形式で配置します。この配置ルールを一貫させることで、エージェント間の連携が安定するのです。</p><p><strong>推奨配置</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>.github/
</span></span><span class=line><span class=cl>  agents/
</span></span><span class=line><span class=cl>    investigative-research.agent.md
</span></span><span class=line><span class=cl>    search-engine-optimization.agent.md
</span></span><span class=line><span class=cl>    proofreader.agent.md
</span></span><span class=line><span class=cl>    reviewer.agent.md
</span></span></code></pre></td></tr></table></div></div><p><strong>命名規則</strong>:</p><ul><li><code>{役割名}.agent.md</code> の形式</li><li>役割がわかりやすい名前をつける</li><li>ハイフン区切り（kebab-case）を推奨</li></ul><p>この配置ルールを守ることで、「このエージェントはどこに定義されているのか」が明確になり、AIが自律的にエージェントを見つけられるようになります。</p><p>発見したのは、場所を明示するだけで連携が安定するということです。AIは思った以上に「構造」や「規則性」を理解してくれます。とはいえ、主要なエージェントについては例示するのが良さそうです。</p><h3 id=パターン3-agentsmdにワークフローを定義する>パターン3: AGENTS.mdにワークフローを定義する</h3><p>3つ目のパターンは、<strong>AGENTS.mdにワークフローとして連携フローを明記する</strong>ことです。</p><p>これが最も重要な発見でした。エージェント定義ファイル（<code>.github/agents/*.md</code>）に <code>name</code> と <code>description</code> を書くだけでなく、AGENTS.mdにワークフローとして「どのエージェントがどの順番で何をするのか」を明記することで、Copilotが自律的にエージェントを呼び出してくれるようになります。</p><p><strong>AGENTS.mdに記載するワークフロー例</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl><span class=gu>### 単体記事のワークフロー
</span></span></span><span class=line><span class=cl><span class=gu></span>
</span></span><span class=line><span class=cl>記事ごとのワークフローは以下の順とする。それぞれ専門家エージェントに割り当てる
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>1.</span> 調査・情報収集（investigative-researchエージェント）
</span></span><span class=line><span class=cl>   <span class=k>-</span> キーワード、および関連トピックの調査
</span></span><span class=line><span class=cl>   <span class=k>-</span> 参考URLの収集
</span></span><span class=line><span class=cl>   <span class=k>-</span> 内部リンク（関連記事など）の調査
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>2.</span> アウトライン作成（search-engine-optimizationエージェント）
</span></span><span class=line><span class=cl>   <span class=k>-</span> タイトルの最適化
</span></span><span class=line><span class=cl>   <span class=k>-</span> meta descriptionの作成
</span></span><span class=line><span class=cl>   <span class=k>-</span> 見出し構造の整理
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>3.</span> 記事作成（各専門家エージェント）
</span></span><span class=line><span class=cl>   <span class=k>-</span> アウトラインに基づいた記事作成
</span></span><span class=line><span class=cl>   <span class=k>-</span> コード例、図表の配置
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>4.</span> スタイルと構成の整形（layout-and-content-harmonizationエージェント）
</span></span><span class=line><span class=cl><span class=k>5.</span> 校正（proofreaderエージェント）
</span></span><span class=line><span class=cl><span class=k>6.</span> SEO（search-engine-optimizationエージェント）
</span></span><span class=line><span class=cl><span class=k>7.</span> 公開前の最終チェック（reviewerエージェント）
</span></span></code></pre></td></tr></table></div></div><p>このワークフローの中で、役割名（例: <code>investigative-research</code>）とエージェント定義の <code>name</code> が一致していること、そして各エージェントの <code>description</code> がワークフロー内の指示内容と整合していることが重要です。</p><p>Copilotは、AGENTS.mdに書かれたワークフローを読み、ここではinvestigative-researchという名前のエージェントを呼べばよいと判断します。そのエージェントのdescriptionを参照すると、調査・情報収集を専門としているため、このタスクに適していると判断します。</p><p>このワークフローを定義することで気づいたのは、「正しく情報を与えるだけ」でAIが自律的に動作するという点です。複雑な制御ロジックは不要で、シンプルな定義だけで連携できるようになっていました。</p><p>Issueなどからアサインする時に、最後にダメ押しで <code>AGENTS.mdの「単体記事のワークフロー」に従って作成してください。</code> のように指定すると、ほぼワークフローを守ってくれるようです。</p><p>Copilotが作業する時、ガイドラインやエージェントの定義、Issueの内容、アサイン時の指示など、すべての情報の中に存在している「キーワード」をうまく紐づけることを意識するのが良いと思います。</p><h2 id=dena勉強会資料から学んだプロンプト技術>DeNA勉強会資料から学んだプロンプト技術</h2><p>試行錯誤を続けていた私にとって、DeNAの社内勉強会の資料は大きな転機になりました。</p><link rel=stylesheet href=/css/linkcard.css><div class=linkcard><a class=linkcard-a href=https://engineering.dena.com/blog/2025/12/llm-study-1201/ target=_blank rel="noopener noreferrer"><div class=linkcard-image><img src=https://engineering.dena.com/blog/2025/12/llm-study-1201/cover.png alt="AIエンジニアが本気で作ったLLM勉強会資料を大公開 〜そのまま使えるハンズオン用コード付き〜 | BLOG - DeNA Engineering" loading=lazy></div><div class=linkcard-content><div class=linkcard-title>AIエンジニアが本気で作ったLLM勉強会資料を大公開 〜そのまま使えるハンズオン用コード付き〜 | BLOG - DeNA Engineering</div><div class=linkcard-description>はじめに
こんにちは、2020年に新卒入社してからDeNAでAIエンジニアをしている吉田（
@birdwatcherYT
）です。
いつもは
Qiita
に技術記事を発信しているのですが、今回は …</div><div class=linkcard-meta><img class=linkcard-favicon src=https://engineering.dena.com/favicon.ico alt onerror='this.style.display="none"'>
<span class=linkcard-domain>DeNA Engineering</span></div></div></a></div><h3 id=ベストプラクティスの重要性>ベストプラクティスの重要性</h3><p>勉強会資料を読んで最初に感じたのは、「基礎を押さえることの大切さ」でした。</p><p>私はこれまで、感覚的にプロンプトを書いていました。「こう書いたらうまくいった」という経験則だけが頼りだったのです。でも、資料を読むことで、なぜうまくいったのか、どうすればもっと良くなるのかが理論的に理解できるようになりました。</p><p>基礎を押さえれば、応用はその先にあります。エージェント定義にも、プロンプトエンジニアリングの知見を活かせることがわかりました。</p><h3 id=重要な部分を強調する方法>重要な部分を強調する方法</h3><p>プロンプトでは、重要な部分を明示的に強調することが大切です。勉強会資料で学んだテクニックをいくつか紹介します。</p><h4 id=優先順位の明示>優先順位の明示</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>【優先順位】
</span></span><span class=line><span class=cl><span class=k>1.</span> 正確性
</span></span><span class=line><span class=cl><span class=k>2.</span> 簡潔性
</span></span><span class=line><span class=cl><span class=k>3.</span> 応答速度
</span></span></code></pre></td></tr></table></div></div><p>AIに「何を最優先すべきか」を明確に伝えることで、期待する出力に近づきます。</p><h4 id=出力形式の指定>出力形式の指定</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>【出力形式】
</span></span><span class=line><span class=cl><span class=k>-</span> Markdown形式で出力
</span></span><span class=line><span class=cl><span class=k>-</span> コードブロックには言語タグを付与
</span></span><span class=line><span class=cl><span class=k>-</span> 見出しはH2/H3のみ使用
</span></span></code></pre></td></tr></table></div></div><p>形式を明示することで、出力のばらつきを抑え、一貫性のある結果を得られます。</p><h4 id=太字や箇条書きの効果的な使い方>太字や箇条書きの効果的な使い方</h4><p>AGENTS.mdでも、<strong>重要な制約</strong>や<strong>絶対にしてはいけないこと</strong>を太字で強調したり、箇条書きで整理したりすることで、AIが重要なポイントを見逃しにくくなります。</p><h3 id=役割付与の効果>役割付与の効果</h3><p>勉強会資料で特に印象的だったのは、「あなたは専門家です」という一文の効果です。</p><p>AIに明確な役割や専門性を付与することで、回答の質が大きく変わります。これを「役割付与（Role Prompting）」と呼びます。</p><p><strong>基本形</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>あなたは10年以上の経験を持つ[専門分野]の専門家です。
</span></span><span class=line><span class=cl>[専門分野]に深い愛とこだわりを持っています。
</span></span></code></pre></td></tr></table></div></div><p>私はこのリポジトリで <code>perl-monger</code> というカスタムエージェントを定義しています（詳しくは<a class=link href=/2025/12/07/012345/>perl-mongerをカスタムエージェントとして定義した</a>をご覧ください）。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>You are &#34;perl-monger&#34;, a Perl-obsessed specialist. 
</span></span><span class=line><span class=cl>Be enthusiastic and geeky but helpful.
</span></span></code></pre></td></tr></table></div></div><p>試しに、この <code>perl-monger</code> にRubyについて尋ねてみました。すると、「Perl好きから見て一言」という独自の視点で回答しました。単なる技術比較ではなく、「魔術性」「アプローチの違い」といった本質的な特徴を指摘しつつ、どちらも支持する立場を示しました。</p><p>ペルソナが回答の質を変える——この発見は、カスタムエージェント設計において非常に重要でした。</p><h3 id=ハルシネーション防止>ハルシネーション防止</h3><p>AIの「ハルシネーション（もっともらしい嘘）」を防ぐためのテクニックも学びました。</p><h4 id=出典を明示させる>出典を明示させる</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>必ず公式ソースのURLを併記してください。
</span></span><span class=line><span class=cl>引用する場合は出典を明記してください。
</span></span></code></pre></td></tr></table></div></div><p>これにより、AIが推測で回答することを防ぎ、根拠のある情報だけを提供させることができます。</p><h4 id=不明点はわからないと答えさせる>不明点は「わからない」と答えさせる</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>根拠がない場合は「わからない」と答えてください。
</span></span><span class=line><span class=cl>推測で回答しないでください。
</span></span></code></pre></td></tr></table></div></div><p>AIは質問に答えようとするあまり、知らないことでも推測で答えてしまうことがあります。この指示を加えることで、AIが正直に「わからない」と答えるようにしています。</p><h4 id=エージェント定義での実践例>エージェント定義での実践例</h4><p>実際にカスタムエージェントを定義する際、以下のような指示を含めています。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>name: investigative-research
</span></span><span class=line><span class=cl>description: 調査専門のエージェント。情報の正確性を最優先する。
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=gu>## 行動指針
</span></span></span><span class=line><span class=cl><span class=gu></span><span class=k>-</span> 根拠が不明な情報は推測しない
</span></span><span class=line><span class=cl><span class=k>-</span> 不明点は必ず質問して明確化
</span></span><span class=line><span class=cl><span class=k>-</span> 出典はMarkdown形式で明記
</span></span><span class=line><span class=cl><span class=k>-</span> わからない場合は「わからない」と答える
</span></span></code></pre></td></tr></table></div></div><p>このように、ハルシネーション防止のテクニックをエージェント定義に組み込むことで、信頼性の高い出力を得られるようになりました。</p><h2 id=ドメイン特化型aiという選択>ドメイン特化型AIという選択</h2><p>エージェント連携を設計する際、重要なのは「専門性」です。</p><h3 id=なぜ専門性を高めるのか>なぜ専門性を高めるのか</h3><p>汎用的なAIは便利ですが、特定の分野では限界があります。ドメイン特化型AIには、研究で裏付けられた5つのメリットがあります。</p><ol><li><strong>ドメイン内性能の向上</strong> - 特定領域に特化することで、より正確で詳細な回答が可能</li><li><strong>ハルシネーションとリスク低減</strong> - 専門知識に絞ることで、誤情報生成の確率が低下</li><li><strong>専門知識・語彙のキャプチャ</strong> - ドメイン固有の用語や概念を適切に理解</li><li><strong>少量データでの有効性</strong> - 微調整手法により、少ないデータでも高性能</li><li><strong>コストと効率のトレードオフ</strong> - 必要な機能に絞ることで効率的に動作</li></ol><link rel=stylesheet href=/css/linkcard.css><div class=linkcard><a class=linkcard-a href=https://www.getguru.com/reference/domain-specific-ai target=_blank rel="noopener noreferrer"><div class=linkcard-image><img src=https://cdn.prod.website-files.com/5d8d029013ffd80bbb91320d/65d7b077575d03cfff72e787_opengraph.webp alt="Domain Specific AI: A Complete Guide to Specialized Artificial Intelligence Solutions" loading=lazy></div><div class=linkcard-content><div class=linkcard-title>Domain Specific AI: A Complete Guide to Specialized Artificial Intelligence Solutions</div><div class=linkcard-description>Discover how domain-specific AI delivers specialized, high-precision solutions tailored to your industry. Learn its …</div><div class=linkcard-meta><img class=linkcard-favicon src=https://www.getguru.com/favicon.ico alt onerror='this.style.display="none"'>
<span class=linkcard-domain>www.getguru.com</span></div></div></a></div><p><a class=link href=/2025/12/06/212332/>GitHub Copilot の awesome-copilot で開発体験を向上させる</a>の記事でも詳しく解説しています。</p><h3 id=less-is-more---定義の粒度>Less is More - 定義の粒度</h3><p>エージェントを定義する際、最初は「細かく定義した方が良い」と思っていました。でも、実際に運用してみると、<strong>定義しすぎると柔軟性が失われる</strong>ことがわかりました。</p><p><strong>失敗例（定義しすぎ）</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>name: perl-expert
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>推奨フレームワーク: Catalyst, Mojolicious, Dancer
</span></span><span class=line><span class=cl>推奨モジュール: Plack, DBIx::Class, Moo
</span></span><span class=line><span class=cl>推奨スタイル: PBP（Perl Best Practices）
</span></span><span class=line><span class=cl>テストツール: Test::More, Test::Deep
</span></span></code></pre></td></tr></table></div></div><p>この場合、定義にないフレームワークやモジュールについて聞かれると、対応が硬直化してしまいます。</p><p><strong>成功例（シンプル）</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>name: perl-monger
</span></span><span class=line><span class=cl>description: Perl愛好家。熱狂的でオタク的だが役に立つ
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>イディオマティックなPerlを優先
</span></span><span class=line><span class=cl>必要に応じてバージョンやCPANモジュールに言及
</span></span></code></pre></td></tr></table></div></div><p>シンプルな性格設定だけで、AIの基礎知識と推論能力が適切な回答を導いてくれます。</p><p><strong>教訓</strong>: 定義を過度に詳細化しない方が良い。</p><h3 id=カスタムエージェントの実例>カスタムエージェントの実例</h3><p>実際に <code>perl-monger</code> を使ってみると、シンプルな定義でも効果的に動くことがわかります。</p><p>ペルソナが生む独自の視点は、単なる技術解説を超えた深い洞察を提供してくれます。Rubyについて聞いたときの「Perl好きとして一言」という切り口は、まさにペルソナの力です。</p><h2 id=実践このリポジトリでのワークフロー>実践：このリポジトリでのワークフロー</h2><p>ここまでで理論を説明しました。以下に実際のワークフローを示します。</p><h3 id=記事作成フローの全体像>記事作成フローの全体像</h3><p>このリポジトリでは、記事作成に6つのエージェントが連携しています。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>1. investigative-research（調査エージェント）
</span></span><span class=line><span class=cl>   ↓ 調査結果をまとめる
</span></span><span class=line><span class=cl>2. search-engine-optimization（アウトライン作成エージェント）
</span></span><span class=line><span class=cl>   ↓ アウトラインを作成
</span></span><span class=line><span class=cl>3. 専門家エージェント（記事執筆）
</span></span><span class=line><span class=cl>   ↓ 記事本文を執筆
</span></span><span class=line><span class=cl>4. layout-and-content-harmonization（整形エージェント）
</span></span><span class=line><span class=cl>   ↓ レイアウトと内容を調整
</span></span><span class=line><span class=cl>5. proofreader（校正エージェント）
</span></span><span class=line><span class=cl>   ↓ 誤字脱字や表現をチェック
</span></span><span class=line><span class=cl>6. reviewer（最終確認エージェント）
</span></span><span class=line><span class=cl>   ↓ 最終確認して完了
</span></span></code></pre></td></tr></table></div></div><p>Copilotは、AGENTS.mdに記載されたこのワークフローを参照し、各ステップで適切なエージェント（name と description が一致するもの）を呼び出します。まるでベルトコンベアのように、タスクがスムーズに流れていくのです。</p><p>search-engine-optimization はSEOの専門家ですが、SEO視点から見たアウトラインを考えるようにフローの中で指示しています。</p><h3 id=定義ファイルを見てみる>定義ファイルを見てみる</h3><p>実際のエージェント定義ファイルはシンプルです。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>name: proofreader
</span></span><span class=line><span class=cl>description: 校正専門のエージェント。誤字脱字や表現をチェックする。
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>あなたは10年以上の経験を持つ校正者です。
</span></span><span class=line><span class=cl>誤字脱字、表記ゆれ、不自然な表現を見つけることに情熱を注いでいます。
</span></span></code></pre></td></tr></table></div></div><p>最初は、AIに指示（調査エージェントを作りたいので定義を書いて、みたいな指示です）して細かい内容についてびっしりと書いていましたが、一歩引いて考えれば、AIに書かせた内容は、その「指示」を書いておけば「びっしりと書いた内容」を指示しているのとほぼ変わらないのです。AIが書いたのですからAIはすでに知っているのです。むしろ新たに学習された内容も含まれることを考えると、細かく指示を出すよりも有効だと考えることもできます。なので、私は、役割付与以外は本当に指定したい事柄だけを追加で指定する、という定義方法を採用しています。</p><p>例えば、最近、調査結果を保存しておくような指示を追加しました。調査用のエージェントは調査した結果をそのままCopilotに渡すようで、セッションが終わると調査結果はログにしか残りません。せっかくの調査がもったいないなと。「調査とは何か」のような定義は一切していませんが「専門性」を発揮して、素晴らしいレポートを作成してくれます。今回のレポートも圧巻です。</p><link rel=stylesheet href=/css/linkcard.css><div class=linkcard><a class=linkcard-a href=https://raw.githubusercontent.com/nqou-net/www.nqou.net/fe3a4529dbe1f0355bfaeb2e184b9d332cc7c39a/agents/research/agent-coordination-best-practices.md target=_blank rel="noopener noreferrer"><div class=linkcard-content><div class=linkcard-title>https://raw.githubusercontent.com/nqou-net/www.nqou.net/fe3a4529dbe1f0355bfaeb2e184b9d332cc7c39a/agents/research/agent-coordination-best-practices.md</div><div class=linkcard-meta><img class=linkcard-favicon src=https://raw.githubusercontent.com/favicon.ico alt onerror='this.style.display="none"'>
<span class=linkcard-domain>raw.githubusercontent.com</span></div></div></a></div><p>エージェント連携で重要なのは <code>name</code> と <code>description</code> です。これらがAGENTS.mdのワークフローと整合していれば、Copilotが適切にエージェントを呼び出してくれます。</p><p><strong>補足: handoffs について</strong></p><p>エージェント定義に <code>handoffs</code> というフィールドを見かけることがあるかもしれません。これは次のエージェントへの引き継ぎを定義する仕組みですが、すべてのAIモデルで共通して利用できるわけではありません。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># handoffs の例（参考）</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>handoffs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>label</span><span class=p>:</span><span class=w> </span><span class=l>最終確認へ</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>agent</span><span class=p>:</span><span class=w> </span><span class=l>reviewer</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>prompt</span><span class=p>:</span><span class=w> </span><span class=l>最終確認をお願いします</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><code>handoffs</code> を定義することで、エージェント間の連携をより明示的にできる場合もありますが、<strong>必須ではありません</strong>。少なくとも私は書いていませんが、ワークフローによって複数エージェントによる記事作成は実現できています。現時点で確実に機能するのは、AGENTS.mdのワークフロー定義と、各エージェントの <code>name</code> および <code>description</code> の整合性です。</p><p><code>handoffs</code> は書いておいて差し支えありませんが、あくまで参考程度と考えてください。エージェント連携の本質は、少なくとも現時点ではAGENTS.mdのワークフロー定義にあります。</p><h3 id=運用してわかったこと>運用してわかったこと</h3><p>実際に運用してみて、いくつかの重要なことがわかりました。</p><h4 id=完璧を目指さない>完璧を目指さない</h4><p>最初から完璧なエージェントを作ろうとすると、定義が複雑になりすぎて逆効果になります。まずはシンプルに始め、必要に応じて段階的に調整してください。</p><h4 id=小さく始めて観察する>小さく始めて観察する</h4><p>1つのエージェントから始めて、動作を観察しながら少しずつ改善していくアプローチが有効です。観察することで、どこを改善すればいいかが見えてきます。</p><h4 id=改善は段階的に>改善は段階的に</h4><p>一度にたくさんの変更をすると、何が効果的だったのかがわからなくなります。1つずつ変更して、その効果を確認する——この繰り返しが大切です。</p><h2 id=今後の課題と展望>今後の課題と展望</h2><p>エージェント連携はまだ発展途上の分野です。今後の課題と展望について考えてみます。</p><h3 id=まだ標準化とは言えない>まだ標準化とは言えない</h3><p>エージェント配置（<code>.github/agents/*.md</code>）については、60,000以上のリポジトリで採用される業界標準「AGENTS.md」として確立されつつあります。</p><link rel=stylesheet href=/css/linkcard.css><div class=linkcard><a class=linkcard-a href=https://agents.md/ target=_blank rel="noopener noreferrer"><div class=linkcard-image><img src=https://agents.md/og.png alt=AGENTS.md loading=lazy></div><div class=linkcard-content><div class=linkcard-title>AGENTS.md</div><div class=linkcard-description>AGENTS.md is a simple, open format for guiding coding agents. Think of it as a README for agents.</div><div class=linkcard-meta><img class=linkcard-favicon src=https://agents.md/favicon.ico alt onerror='this.style.display="none"'>
<span class=linkcard-domain>agents.md</span></div></div></a></div><p>しかし、エージェント間の連携パターンについては、まだ模索中の段階です。コミュニティでベストプラクティスを共有し、標準化を進めていく必要があります。</p><p>AGENTS.mdについて最初に試したときの記事は、<a class=link href=/2025/11/27/233234/>エージェントガイドラインを作成するプロンプトを試してみた</a>で詳しく書いています。また、<a class=link href=/2025/11/29/010643/>エージェントパネルから記事を生成してみた</a>では、エージェントパネルを使った実践例を紹介しています。</p><h3 id=a2aプロトコルの可能性>A2Aプロトコルの可能性</h3><p>将来的には、「A2A（Agent to Agent）プロトコル」のような標準化された通信プロトコルが重要になるかもしれません。</p><link rel=stylesheet href=/css/linkcard.css><div class=linkcard><a class=linkcard-a href=https://a2a-protocol.org/latest/ target=_blank rel="noopener noreferrer"><div class=linkcard-content><div class=linkcard-title>A2A Protocol</div><div class=linkcard-description>The official documentation for the Agent2Agent (A2A) protocol. The A2A protocol is an open standard that allows …</div><div class=linkcard-meta><img class=linkcard-favicon src=https://a2a-protocol.org/favicon.ico alt onerror='this.style.display="none"'>
<span class=linkcard-domain>a2a-protocol.org</span></div></div></a></div><p>A2Aプロトコルは、異なるベンダーや実装のAIエージェント同士が標準化された方法で連携するための仕様です。主な特徴は以下の通りです。</p><ul><li><strong>Agent Card</strong> - エージェントの能力を公開</li><li><strong>Task</strong> - 作業単位の定義</li><li><strong>Message/Parts</strong> - 多モーダルなやり取り</li><li><strong>Artifact</strong> - 成果物の受け渡し</li></ul><p>これにより、マイクロサービスのようにエージェントを組み合わせることが可能になります。将来的には、異なるAIサービスのエージェントを自由に組み合わせて使える時代が来るかもしれません。</p><h3 id=継続的な観察と改善>継続的な観察と改善</h3><p>エージェント連携は、使いながら学んでいくものです。</p><ul><li>フィードバックループを回す</li><li>うまくいったパターンを記録する</li><li>失敗から学ぶ</li><li>知見を共有する文化を作る</li></ul><p>この記事も、私の観察結果を共有する試みの1つです。あなたも、自分の経験を共有してみてください。コミュニティ全体で知見が蓄積されれば、エージェント連携はもっと使いやすくなるはずです。</p><h2 id=まとめ---正しく情報を与えてあげるだけ>まとめ - 正しく情報を与えてあげるだけ</h2><p>長い記事になりましたが、最後にポイントを整理します。</p><h3 id=成功の3つのパターン再確認>成功の3つのパターン再確認</h3><p>エージェント間連携を成功させるための3つのシンプルなパターン。</p><ol><li><strong>name と description を明確にする</strong> - エージェントの名前と役割を具体的に定義</li><li><strong>定義の場所を示す</strong> - <code>.github/agents/{role}.agent.md</code> に統一配置し、AGENTS.mdにパスを記載する</li><li><strong>AGENTS.mdにワークフローを定義する</strong> - ワークフローの中で役割とエージェント名を明確に紐付ける</li></ol><p>これらの要素が整合していれば、Copilotが自律的にエージェントを呼び出し、連携させてくれます。</p><h3 id=プロンプトエンジニアリングの基礎>プロンプトエンジニアリングの基礎</h3><p>DeNA勉強会資料から学んだ重要なポイント。</p><ul><li><strong>役割付与</strong> - 「あなたは専門家です」でペルソナを与える</li><li><strong>ハルシネーション防止</strong> - 出典の明示、答えがないときは「わからない」と答えさせる</li><li><strong>強調方法</strong> - 優先順位、出力形式、良例・悪例の提示</li></ul><h3 id=あなたも今日から始められる>あなたも今日から始められる</h3><p>エージェント連携は難しくありません。以下のステップで始めてみてください。</p><ol><li><strong>AGENTS.mdを作成してみる</strong><ul><li>リポジトリのルートに <code>AGENTS.md</code> を配置</li><li>プロジェクトの概要、技術スタック、制約を記述</li><li>GitHub Copilot公式ドキュメントも参考に</li></ul></li></ol><link rel=stylesheet href=/css/linkcard.css><div class=linkcard><a class=linkcard-a href=https://docs.github.com/ja/copilot/concepts/agents/coding-agent/about-custom-agents target=_blank rel="noopener noreferrer"><div class=linkcard-image><img src=https://docs.github.com/assets/cb-345/images/social-cards/copilot.png alt="カスタム エージェントについて - GitHub ドキュメント" loading=lazy></div><div class=linkcard-content><div class=linkcard-title>カスタム エージェントについて - GitHub ドキュメント</div><div class=linkcard-description>カスタム エージェント は、 Copilot コーディング エージェント を、ニーズに合わせて調整された特殊な支援で強化します。</div><div class=linkcard-meta><img class=linkcard-favicon src=https://docs.github.com/favicon.ico alt onerror='this.style.display="none"'>
<span class=linkcard-domain>GitHub Docs</span></div></div></a></div><ol start=2><li><p><strong>シンプルなカスタムエージェントを定義する</strong></p><ul><li><code>.github/agents/</code> ディレクトリを作成</li><li>1つの専門性に絞ったエージェントから始める</li><li>細かく定義しすぎない（Less is More）</li></ul></li><li><p><strong>観察しながら改善していく</strong></p><ul><li>実際に使ってみる</li><li>うまくいったこと、いかなかったことを記録する</li><li>少しずつ改善を重ねる</li></ul></li></ol><p><strong>重要なのは、正しく情報を与えてあげるだけです。複雑な制御ロジックは不要で、シンプルな定義だけでAIは自律的に動作します。</strong></p><p>あなたの試行錯誤が、新しい発見につながることを願っています。</p><h2 id=参考リンク>参考リンク</h2><ul><li><link rel=stylesheet href=/css/linkcard.css><div class=linkcard><a class=linkcard-a href=https://engineering.dena.com/blog/2025/12/llm-study-1201/ target=_blank rel="noopener noreferrer"><div class=linkcard-image><img src=https://engineering.dena.com/blog/2025/12/llm-study-1201/cover.png alt="AIエンジニアが本気で作ったLLM勉強会資料を大公開 〜そのまま使えるハンズオン用コード付き〜 | BLOG - DeNA Engineering" loading=lazy></div><div class=linkcard-content><div class=linkcard-title>AIエンジニアが本気で作ったLLM勉強会資料を大公開 〜そのまま使えるハンズオン用コード付き〜 | BLOG - DeNA Engineering</div><div class=linkcard-description>はじめに
こんにちは、2020年に新卒入社してからDeNAでAIエンジニアをしている吉田（
@birdwatcherYT
）です。
いつもは
Qiita
に技術記事を発信しているのですが、今回は …</div><div class=linkcard-meta><img class=linkcard-favicon src=https://engineering.dena.com/favicon.ico alt onerror='this.style.display="none"'>
<span class=linkcard-domain>DeNA Engineering</span></div></div></a></div></li><li><link rel=stylesheet href=/css/linkcard.css><div class=linkcard><a class=linkcard-a href=https://docs.github.com/ja/copilot target=_blank rel="noopener noreferrer"><div class=linkcard-image><img src=https://docs.github.com/assets/cb-345/images/social-cards/copilot.png alt="GitHub Copilot のドキュメント - GitHub ドキュメント" loading=lazy></div><div class=linkcard-content><div class=linkcard-title>GitHub Copilot のドキュメント - GitHub ドキュメント</div><div class=linkcard-description>GitHub Copilot を使うと、生産性を向上させ、コードの作業を支援できます。</div><div class=linkcard-meta><img class=linkcard-favicon src=https://docs.github.com/favicon.ico alt onerror='this.style.display="none"'>
<span class=linkcard-domain>GitHub Docs</span></div></div></a></div></li><li><link rel=stylesheet href=/css/linkcard.css><div class=linkcard><a class=linkcard-a href=https://agents.md/ target=_blank rel="noopener noreferrer"><div class=linkcard-image><img src=https://agents.md/og.png alt=AGENTS.md loading=lazy></div><div class=linkcard-content><div class=linkcard-title>AGENTS.md</div><div class=linkcard-description>AGENTS.md is a simple, open format for guiding coding agents. Think of it as a README for agents.</div><div class=linkcard-meta><img class=linkcard-favicon src=https://agents.md/favicon.ico alt onerror='this.style.display="none"'>
<span class=linkcard-domain>agents.md</span></div></div></a></div></li></ul></section><footer class=article-footer><section class=article-tags><a href=/tags/ai/>Ai</a>
<a href=/tags/github-copilot/>Github-Copilot</a>
<a href=/tags/custom-agents/>Custom-Agents</a>
<a href=/tags/agents-md/>Agents-Md</a>
<a href=/tags/prompt-engineering/>Prompt-Engineering</a>
<a href=/tags/workflow/>Workflow</a></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>関連するコンテンツ</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/2025/12/03/210018/><div class=article-image><img src=/public_images/20251203210018-image.jpg loading=lazy data-key data-hash=/public_images/20251203210018-image.jpg></div><div class=article-details><h2 class=article-title>GitHub Copilot Premium Requests：11月の振り返りと12月の抱負</h2></div></a></article><article class=has-image><a href=/2025/12/07/012345/><div class=article-image><img src=/public_images/2025/1765038225-image.jpg loading=lazy data-key data-hash=/public_images/2025/1765038225-image.jpg></div><div class=article-details><h2 class=article-title>perl-mongerをカスタムエージェントとして定義した</h2></div></a></article><article class=has-image><a href=/2025/12/06/212332/><div class=article-image><img src=/public_images/2025/1765023812-image.jpg loading=lazy data-key data-hash=/public_images/2025/1765023812-image.jpg></div><div class=article-details><h2 class=article-title>GitHub Copilot の awesome-copilot で開発体験を向上させる</h2></div></a></article><article class=has-image><a href=/2025/12/04/233146/><div class=article-image><img src=/public_images/2025/20251204233146-image.jpg loading=lazy data-key data-hash=/public_images/2025/20251204233146-image.jpg></div><div class=article-details><h2 class=article-title>AIガイドラインの矛盾：DosとDon'tsが衝突したらどうなる？</h2></div></a></article><article class=has-image><a href=/2025/12/08/003413/><div class=article-image><img src=/public_images/2025/1765121653-image.jpg loading=lazy data-key data-hash=/public_images/2025/1765121653-image.jpg></div><div class=article-details><h2 class=article-title>エージェントにアサインする時の指示が要だった</h2></div></a></article></div></div></aside><div class=disqus-container><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//nqounet.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener("onColorSchemeChange",e=>{typeof DISQUS=="object"&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
2000 -
2025 nqou.net</section><section class=powerby><a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> で構築されています。<br>テーマ <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.29.0>Stack</a></b> は <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> によって設計されています。</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>