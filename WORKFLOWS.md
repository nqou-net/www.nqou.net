# WORKFLOWS.md — 記事作成ワークフローガイド（圧縮版）

> 補助文書: [AGENTS.md](AGENTS.md)（プロジェクト概要、コンテンツ作成ルール、エージェントマッピング、調査ドキュメント運用）を事前確認

---

## ワークフロー基本方針

- プロンプトテンプレートに厳密に従う
- **公開前は必ず reviewer エージェントで最終チェック**

---

## シリーズ記事

### プランニング

> テンプレート: `agents/templates/warehouse.md`, `structure.md` | 重複チェック: [SERIES.md](SERIES.md)

| ステップ | 担当エージェント | 内容 |
|---|---|---|
| 1 | investigative-research | 情報収集・競合分析・内部リンク調査 → `content/warehouse/<slug>.md` に保存。**テーマ提案は禁止** |
| 2 | 専門家 | 連載構造案3案（A/B/C）作成 → `agents/structure/<slug>.md` に保存。インパクト・独自性優先、既存シリーズと差別化 |
| 3 | search-engine-optimization | SEO視点レビュー（キーワード配置、検索意図）。最終稿のみ出力 |
| 4 | reviewer | 品質視点レビュー（構造一貫性、段階的難易度）。最終稿のみ出力 |
| 5 | ユーザー/reviewer | 最適案選定、選定理由文書化 |

### ライティング

> テンプレート: `agents/templates/post.md`

| ステップ | 担当 | 内容 |
|---|---|---|
| 1 | 専門家 | 連載構造案に基づき原稿作成。初回は前提知識・対象読者明示。文体・トーン統一。最終稿のみ出力 |
| 2 | illustration-craftsperson | 挿絵追加（Mermaid図）。推奨: クラス図/シーケンス図/フローチャート/構成図。挿入位置:「パターンで解決する」冒頭 |

### レビュー

| ステップ | 担当 | 内容 |
|---|---|---|
| 1 | — | 公開日時決定: 第1回=レビューの24h後、第2回以降=前回の17秒後。ファイル名: `content/post/%Y/%m/%d/%H%M%S.md` |
| 2 | — | シリーズ記事間リンク追加（前回振り返り、次回予告） |
| 3 | — | 目次記事作成: 最終回の17秒後公開、タイトル「【目次】シリーズ名（全N回）」、linkcard形式でリンク |
| 4 | proofreader | 校正 |
| 5 | reviewer | 品質レビュー3回: ①構造案整合性 ②表現スタイル改善 ③最終仕上げ（SRP/OCP言及、一貫性） |
| 6 | — | 公開: `draft: false`に変更 |

---

## 単体記事

### プランニング

| ステップ | 担当 | 内容 |
|---|---|---|
| 1 | investigative-research | 情報収集・競合分析・内部リンク調査 → `content/warehouse/<slug>.md` |
| 2 | search-engine-optimization | アウトライン作成: タイトル最適化、meta description、見出し構造（H1/H2/H3）、構造化データ |

### ライティング・レビュー

| ステップ | 担当 | 内容 |
|---|---|---|
| 1 | 専門家 | 原稿作成: 技術的正確性、コード例配置、引用URL明記 |
| 2 | illustration-craftsperson | 挿絵追加（Mermaid） |
| 3 | proofreader | 校正 |
| 4 | reviewer | 最終チェック |

---

## プロンプトテンプレート

### 調査・情報収集依頼

```
キーワード・関連トピックの調査:
- 最新かつ信頼性の高い情報を収集
- 各項目に**要点**、**根拠**、**仮定**、**出典**（URL/ASIN/ISBN）、**信頼度**（1-10）を付記
- 競合記事分析、内部リンク調査（`/content/post`配下をgrep）
- 出力: `content/warehouse/<slug>.md`
- 内部リンク変換例: `/content/post/2025/12/24/000000.md` → `/2025/12/24/000000/`
```

### 連載構造案作成依頼

```
調査結果（content/warehouse/<slug>.md）に基づき連載構造案3案（A/B/C）作成:
- 常識的枠組みを排除、極端だが革新的なアプローチ
- インパクト・独自性優先
- 生成後レビュー3回繰り返し

各案の必須項目:
- 特徴・アプローチ（メリット/デメリット）
- 連載構造表: 回数|タイトル|新概念（1記事1概念）|ストーリー|コード例1/2|推奨タグ（5個まで、英小文字ハイフン）
- 差別化ポイント、推薦案と理由

出力: agents/structure/<slug>.md（YAMLフロントマター、調査参照元明記）
```

### 連載構造案レビュー依頼

```
agents/structure/<slug>.md をSEO+品質の両面でレビュー

SEO視点:
- キーワード配置、検索意図合致、タグ適切性、メタ情報最適化

品質視点:
- 構造一貫性、1記事1概念、案の差別化、ペルソナ適合、技術的正確性

レビューサイクル（最大3回）:
- 1→2版: 構造一貫性、段階的難易度、1記事1概念
- 2→3版: SEO最適化、品質基準全項目
- 早期合格可

出力: 改善版を同一ファイルに追記、レビュー履歴セクション追加
```

### アウトライン依頼

```
調査結果に基づきアウトライン案3つ（A/B/C）作成:
- 異なる視点・アプローチ
- 生成後レビュー3回

各案の必須項目:
- 要約（1行）
- H2/H3見出し階層
- 推奨タグ（5個まで）
```

### 原稿作成依頼

```
調査結果・アウトラインに基づき記事作成:
- 技術的正確性、最新情報
- コード例: 言語タグ、バージョン、外部依存を明記
- 引用: `{{< linkcard "URL" >}}`形式
- 書籍: `{{< amazon asin="ASIN" title="タイトル" >}}`形式
- 生成後レビュー3回

文体規則:
- 本文: 書き言葉、です・ます調
- 箇条書き: だ・である調、末尾句点なし

出力: 新規ファイル、YAMLフロントマター
```

---

## 品質基準

### 単体記事

- H2/H3見出しの適切な分割
- 各セクション説明が具体的（曖昧な語句は再要求）
- コード例に言語・バージョン・外部依存明記
- タグ規約遵守（英小文字・ハイフン）

### 連載構造案

- 構造一貫性: ストーリーの論理的流れ
- 段階的難易度上昇: 初回→最終回
- 1記事1概念: 複数概念詰め込み禁止
- 3案の明確な差別化
- 連載構造表完全性: 全回分の回数・タイトル・新概念・ストーリー・コード例・タグ

### シリーズ記事

- ストーリー構成: 動く→破綻→パターン導入→完成コード
- SOLID原則言及: 破綻でSRP/OCP違反を具体的指摘
- 表現スタイル: 遊び心ある表現
- 挿絵完備: Mermaid図（クラス図、シーケンス図等）
- リンク構造: シリーズ間リンク、目次リンク
- コード例完全性: 破綻例+解決例、言語・バージョン・依存明記
