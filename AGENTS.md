# ブログ記事作成用 AGENTS

この `AGENTS.md` は、この Hugo サイト（`www.nqou.net`）向けにブログ記事を執筆・編集・公開準備するための AI エージェントの振る舞い、プロンプト、ワークフロー、制約を定義します。詳しくは https://agents.md/ を参照してください。記事作成を効率的かつ安全に再現可能にするために最適化しています。

## 目的

- 人間が高品質なブログ記事を作るのを補助する：下書き作成、編集、SEO、翻訳/ローカライズ、Hugo 向けの公開準備まで。

## 主な対象

- `www.nqou.net` の技術記事やエッセイを書く執筆者・保守者。

## 機能と制約

### 機能

- Hugo 互換の front matter（TOML/YAML）やショートコードを含む Markdown を生成します。
- タイトル、スラッグ、タグ、カテゴリ、メタ記述を提案します。
- 画像の alt テキストや簡潔なキャプションを作成します。
- RSS や SNS 用の要約文を作成します。

### 制約

- 事実を捏造しないこと。不確かな場合は `TODO` を付けて出典を求めること。
- 長文の著作物を転載せず、要約と出典で対応すること。
- サイトの文体（簡潔、必要時は技術的、エッセイでは軽い個人トーン）に従うこと。
- 既存の front matter はユーザーの同意なく上書きしないこと。

### エージェント
エージェントについては、 `.github/agents/*.agent.md` を参照してください

## 推奨ワークフロー

1. ブリーフ：人が一段落のブリーフ、対象読者、希望文字数、トーン、参照元を提供します。
2. 下書き：ライターが front matter の骨格を含む下書きを生成します。
3. 編集パス：編集者が明確さと構成を改善し、差分またはインライン提案を出します。
4. SEO パス：SEO アシスタントが最終タイトル、スラッグ、メタ記述、キーワードを提案します。
5. フォーマット整備：フォーマッターがショートコード、コードフェンス、画像、front matter を整えます。
6. チェックリスト：パブリッシュチェックが公開準備を検証し、`ready`/`issues` を報告します。

## Hugo 固有の注意事項

- 投稿ファイルは `content/post/` に配置します。既存リポジトリの慣習（タイムスタンプ命名例 `1764687600.md` または `YYYY/MM/DD-title.md`）に従ってください。
- フロントマターに使用するキーの例：`title`, `date`, `draft`, `tags`, `categories`, `description`, `slug`, `featuredImage`。公開準備ができるまでは `draft: true` を維持してください。
- front matter の例（TOML）:

~~~toml
title = "Your Draft Title"
date = 2025-12-02T12:00:00+09:00
draft = true
tags = ["example","notes"]
categories = ["blog"]
description = "Short summary for RSS and social shares."
slug = "short-slug"
~~~

- ローカルでドラフトをプレビューするコマンド:

~~~zsh
hugo server -D
~~~

## プロンプトテンプレート

エージェントに指示を出す際は以下テンプレートを置き換えて使用してください。

### 下書き生成（短いブリーフ → 完全下書き）

"あなたは熟練した技術系ライターです。以下のブリーフから `www.nqou.net` 向けに約 {word_count} 語の日本語のブログ記事を作成してください：{brief}。対象読者：{audience}。トーン：{tone}。リードを2–3文、見出しを3–6個、関連する場合は少なくとも1つのコードブロックを含め、短い結論で締めてください。出力は有効な Markdown とし、`draft: true` を含む Hugo 互換の front matter と 120 文字以内の `description` を含めてください。事実確認が必要なら出典を求めてください。"

### 編集パス（簡潔化・語調修正）

"あなたは編集者です。以下の Markdown の明快さ、流れ、文法を改善してください。意味と技術的正確性は保持してください。コードブロックはそのままにし、修正点の要約を付けてください。"

### SEO パス（タイトル/説明/スラッグ/タグ）

"クリック率の高そうな代替タイトルを最大5件、推奨タイトル1件を順位付けして提案してください。120 文字以内のメタ記述、URL 用のスラッグ、関連するタグを5つ（カンマ区切り）提示してください。結果は JSON で `title_candidates`, `recommended_title`, `meta_description`, `slug`, `tags` のキーを持つ形式にしてください。"

### 翻訳/ローカライズ

"以下の Markdown を {target_language} に翻訳してください。コードブロック、ショートコード、front matter のキーは変更せず、翻訳品質の要約と文化的注意事項を付けてください。"

### 公開チェックリスト

"この Markdown に対して公開チェックを実行してください：front matter（title, date, description, tags, draft フラグ）の有無、画像の alt テキスト、コードフェンスの言語指定、内部リンクが相対パスであること、`TODO` が残っていないことを確認してください。結果は JSON で `ready`: true/false と `issues`: list を返してください。"

## 例

- 最小ブリーフ → 下書きの例（人間 → エージェント）:

  ブリーフ："Hugo サイトの画像最適化について 800 語の日本語ガイドを書いてください。`resources` の処理例と `image` ショートコードの使用例を含めてください。"

  エージェントの出力：front matter、段落、コード例、SEO 候補リストを含む完全な Markdown。

## 評価基準

- 可読性：平均文長や段落構成。
- 技術的正確性：コード例はコピーして動くこと（架空のコマンドを含めない）。
- SEO 適合：推奨タイトル、説明、スラッグ、メタキーワードが存在すること。
- アクセシビリティ：画像に alt テキストがあること、見出しが階層化されていること。

## 安全性とコンテンツ規則

- 個人情報や機微なデータを生成しないこと。
- 引用や研究結果を捏造しないこと。必要なら front matter に `sources` を追加すること。
- 著作権は尊重すること。長文転載は避け、要約と出典で対応すること。

## 運用担当者向けの実務メモ

- 公開前は `draft: true` を維持してください。公開時に `draft: false` にしてプレビューで確認した上でマージしてください。
- 公開ワークフローに CI を導入する場合、パブリッシュチェックを CI ステップに組み込んで `ready` が false の場合は失敗させると確実です。
- エージェントが生成したメタデータは提案扱いとし、最終的なスラッグやタグは人間が確認してください。

## 保守と拡張

- このファイルは定期的にレビューしてください。繰り返し発生する作業（例：ニュースレター文案、ツイート文）用のテンプレートを追加すると効率化できます。
- 自動画像生成やリンクチェッカーなどの統合を追加する場合は、どのエージェントがどの API を呼ぶか、必要な鍵の管理方法を明記してください（秘密はリポジトリに含めないこと）。
